{% extends "groups_networks/persongroups/details_base.html" %}
{% load i18n base_tags auth_extended navigation_tags groups_networks image_mods_tags %}

{% block extrahead %}
    {{ block.super }}
    <script type="text/javascript" src="{{ STATIC_URL }}site/js/website/group_members.js"></script>
{% endblock %}

{% block content %}
    <div class="details">
        {% include "groups_networks/persongroups/profile/identity.html" %}
        {% block tabs %}
            <div id="tabs">
                {% children_of "group" using "navigation/children_in_tabs.html" %}
            </div>
        {% endblock %}
        {% include "utils/sorting_view_pagination_header.html" %}
        <div class="breadcrumbs">
            {% children_of "group_members" using "navigation/children_horizontally.html" %}
        </div>
        {% if object_list %}
            <div class="memberlist">
                {% for person in object_list %}
                    <div class="list-item {% cycle odd,even %}">
                        <a class="person-icon" href="{{ person.get_url_path }}">
                            {% if person.image %}
                                <img alt="{{ person.get_title|escape }}"
                                     src="{{ UPLOADS_URL }}{{ person.image|modified_path:"at" }}"/>
                            {% else %}
                                <img alt="{{ person.get_title|escape }}" src="{{ DEFAULT_SMALL_LOGO_4_PERSON }}"/>
                            {% endif %}
                            <img alt="{{ person.get_title|escape }}" src="{{ person.image|modified_path:"at" }}"/>
                        </a>
                        <div>
                            <h5>
                                <a href="{{ person.get_url_path }}">{{ person.get_title|escape }}</a>
                            </h5>
                            <div class="txt">
                                {% for institution in person.get_institutions %}
                                    {{ institution.get_title|escape }}{% if not forloop.last %}, {% endif %}
                                {% endfor %}
                            </div>

                            <ul class="toolbar">
                                {% if request.user.is_authenticated %}
                                    {% if object|is_member_request_acceptable:person %}
                                        <li class="accept_member_request">
                                            <a href="#Accept-Request"
                                               title="{% trans "Accept Request" %}"
                                               onclick="GroupMembershipManager.accept_user('{{ object.slug }}', '{{ person.user.username }}'); window.cancelEvent(event);"
                                               id="group_accept_user_{{ object.slug }}_{{ person.user.username }}">
                                                <span>{% blocktrans %}Accept membership request{% endblocktrans %}</span>
                                            </a>
                                        </li>
                                    {% endif %}
                                    {% if object|is_member_request_denyable:person %}
                                        <li class="deny_member_request">
                                            <a href="#Deny-Request"
                                               title="{% trans "Deny Request" %}"
                                               onclick="GroupMembershipManager.deny_user('{{ object.slug }}', '{{ person.user.username }}'); window.cancelEvent(event);"
                                               id="group_deny_user_{{ object.slug }}_{{ person.user.username }}"><span>{% blocktrans %}Deny membership request{% endblocktrans %}</span>
                                            </a>
                                        </li>
                                    {% endif %}
                                    {% if object|is_member_invitation_cancelable:person %}
                                        <li class="cancel_member_invitation">
                                            <a href="#Cancel-Invitation"
                                               title="{% trans "Cancel Invitation" %}"
                                               onclick="GroupMembershipManager.cancel_user('{{ object.slug }}', '{{ person.user.username }}'); window.cancelEvent(event);"
                                               id="group_cancel_user_{{ object.slug }}_{{ person.user.username }}">
                                                <span>{% blocktrans %}Cancel invitation{% endblocktrans %}</span></a>
                                        </li>
                                    {% endif %}
                                    {% if object|is_member_removable:person %}
                                        <li class="remove_membership">
                                            <a href="#Remove-Member"
                                               title="{% trans "Remove Member" %}"
                                               onclick="GroupMembershipManager.remove_user('{{ object.slug }}', '{{ person.user.username }}'); window.cancelEvent(event);"
                                               id="group_remove_user_{{ object.slug }}_{{ person.user.username }}">
                                                <span>{% blocktrans %}Remove member{% endblocktrans %}</span></a>
                                        </li>
                                    {% endif %}
                                    {% if person.is_contactable %}
                                        <li class="mail">
                                            <a href="{{ person.get_url_path }}message/"
                                               title="{% trans "Send a mail" %}"><span>{% trans "Send a mail" %}</span>
                                            </a>
                                        </li>
                                    {% endif %}
                                    </li>
                                {% endif %}
                            </ul>
                        </div>
                        <div>
                            {% if_has_perm "groups_networks.can_change_members" object %}
                                {% ifnotequal request.user person.user %}
                                    <div id="editMember_{{ person.user.id }}" class="editMember">
                                        <a href="#">{% trans "edit permissions" %}</a>
                                    </div>
                                {% endifnotequal %}
                            {% end_if_has_perm %}
                        </div>
                    </div>
                {% endfor %}
                {% include "utils/pagination_footer.html" %}
            </div>
        {% else %}
            <p class="nothing">{% trans "No people in this section." %}</p>
        {% endif %}
    </div>
{% endblock %}

