{% extends "utils/lists/base_context_item.html" %}
{% load i18n base_tags image_mods_tags %}

{% block object_image %}
    <a href="{{ institution.get_url_path }}">
        {% if institution.image %}
            <img alt="{{ institution.get_title|escape }}" src="{{ UPLOADS_URL }}{{ institution.image|modified_path:"al" }}" />
        {% else %}
            <img alt="{{ institution.get_title|escape }}" src="{{ STATIC_URL }}site/img/website/placeholder/institution_m.png" />
        {% endif %}
    </a>
{% endblock %}

{% block object_title %}
    <a class="org fn"  href="{{ institution.get_url_path }}">
        {{ institution.title|escape }} 
    </a><br/>
    {% if institution.title2|escape %}
        <span class="sub_titel">
            {{ institution.title2|escape }}
        </span>
    {% endif %}
{% endblock %}

{% block object_absolute_url %}{{ institution.get_url_path }}{% endblock %}

{% block object_col1 %}
    {% with institution.get_primary_contact as contact %}
        {% if contact %}
            {% if contact.street_address or contact.country_name %}
            <address class="adr">
                {% if contact.street_address %}
                    <span class="street-address">
                    {{ contact.street_address|escape }}
                    </span><br />
                {% endif %}								
                {% if contact.street_address2 %}
                    <span class="street-address">
                    {{ contact.street_address2|escape }}
                    </span><br />
                {% endif %}								
                {% if contact.street_address3 %}
                    <span class="street-address">
                    {{ contact.street_address3|escape }}
                    </span><br />
                {% endif %}								
                {% if contact.postal_code %}	
                     <span class="postal-code">
                     {{ contact.postal_code|escape }} {{ contact.city|escape }}
                     </span><br />
                {% endif %}
                {% if contact.country_name %}
                    <span class="country-name">
                    {{ contact.country_name }}
                    </span><br />
                {% endif %}
            </address>
            {% endif %}
        {% endif %}
    {% endwith %}
{% endblock %}

{% block object_col2 %}
    {% if institution.get_institution_types %}
        <div class="object-type">{% for institution_type in institution.get_institution_types %}{% if not forloop.first %}, {% endif %}{{ institution_type.get_title|escape }}{% endfor %}</div>
    {% endif %}
    
    {% if institution.get_contacts %}
        {% for phone in institution.get_contacts.0.get_phones %}
            <span class="tel">
                {% if phone.type %}
                <abbr title="{{ phone.type.vcard_name }}" class="type">
                {{ phone.type }}
                </abbr>: {% endif %}
                <span class="value">+{{ phone.country }}-{{ phone.area }}-{{ phone.number }}</span><br />
            </span>
        {% endfor %}
        {% for url in institution.get_contacts.0.get_urls %}
            <span class="url">{% if url.type %}{{ url.type }}: {% endif %}<a href="{{ url.link|escape }}" onclick="open_new_window(event)">{% with url.link|slice:"0:27"|escape as sliced %}{{ sliced }}{% with url.link|escape as not_sliced %}{% ifnotequal sliced url.link|escape %}...{% endifnotequal %}{% endwith %}{% endwith %}</a><br /></span>
       {% endfor %}
    {% endif %}	
        
    {% if institution.get_description %}
        {% with institution.get_description|striptags|truncatewords:"60" as filtered_desc %}{% with filtered_desc|truncatewords:"40" as shortened_desc %}
        <span class="hidable description">{{ shortened_desc }}
            {% ifnotequal shortened_desc filtered_desc %}
            <a href="{{ institution.get_url_path }}">{% trans "read more" %}</a>
            {% endifnotequal %}
        </span>
        {% endwith %}{% endwith %}
    {% endif %}
{% endblock %}

{% block object_controls %}
    {% include "institutions/controls.html" %}
{% endblock %}

