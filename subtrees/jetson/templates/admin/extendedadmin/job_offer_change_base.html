{% extends "admin/change_form.html" %}

<!-- LOADING -->
{% load base_tags i18n auth_extended extended_admin compressed_jetson %}

<!-- STYLES -->
{% block extrastyle %}
    {{ block.super }}
    <style type="text/css">
    /*<![CDATA[*/
        #break_start_row, #break_end_row {
            display: none;
        }
    /*]]>*/
    </style>
{% endblock %}

<!-- JAVASCRIPTS -->
{% block javascripts %}
    {{ block.super }}
    <script type="text/javascript" src="{{ STATIC_URL }}admin/js/admin/RelatedObjectLookups.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}admin/js/SelectBox.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}admin/js/SelectFilter2.js"></script>

    <script type="text/javascript" src="{{ jetson_media_url }}js/jquery/autocomplete_1.0/jquery.dimensions.js"></script>
    <script type="text/javascript" src="{{ jetson_media_url }}js/jquery/autocomplete_1.0/jquery.bgiframe.min.js"></script>
    <script type="text/javascript" src="{{ jetson_media_url }}js/jquery/autocomplete_1.0/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="{{ jetson_media_url }}js/admin/autocomplete.js"></script>
    
    <script type="text/javascript" src="{{ STATIC_URL }}admin/js/urlify.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}filebrowser/js/AddFileBrowser.js"></script>
    {% compressed_jetson_js "admin_job_offer_change" %}
    
    <script type="text/javascript" src="{{ STATIC_URL }}admin/js/collapse.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}admin/js/inlines.min.js"></script>
    <!--
    <script type="text/javascript" charset="utf-8">
        (function($) {
            $(document).ready(function() {
                grappelli.initDateAndTimePicker();
                $("div.container-flexible div.group").grp_collapsible_group();
                $("div#content .collapse").grp_collapsible({
                    on_init: function(elem, options) {
                        // open collapse (and all collapse parents) in case of errors
                        if (elem.find("ul.errorlist").length > 0) {
                            elem.removeClass("closed")
                                .addClass("open");
                            elem.parents(".collapse")
                                .removeClass("closed")
                                .addClass("open");
                        }
                    }
                });
            });
        })(django.jQuery);
    </script>
    -->
{% endblock %}

<!-- COLTYPE/BODYCLASS -->
{% block bodyclass %}grp-change-form job-offer{% endblock %}
{% block content-class %}grp-content-flexible{% endblock %}

<!-- BREADCRUMBS -->
{% block breadcrumbs %}
    {% if not is_popup %}
        <ul id="breadcrumbs">
            <li><a href="../../../">{% trans "Home" %}</a></li>
            <li><a href="../../">{{ "Marketplace"|app_verbose_name }}</a></li>
            <li><a href="../">{% trans "Job Offers" %}</a></li>
            <li>{% if original %}{{ original|truncatewords:"18" }}{% else %}{% trans "Add" %} {% trans "Job Offer" %}{% endif %}</li>
        </ul>
    {% endif %}
{% endblock %}

<!-- OBJECT TOOLS -->
{% block object-tools %}
    {% if change and not is_popup %}
        <ul class="grp-object-tools">
            <li><a href="history/" class="historylink">{% trans "History" %}</a></li>
            {% if original.row_level_permissions %}
                {% if_has_perm "auth.change_rowlevelpermission" original %}
                    <li><a href="permissions/" class="rowlevelpermissions">{% trans "Permissions" %}</a></li>
                {% end_if_has_perm %}
            {% endif %}
            {% if original.get_url_path %}
                <li><a href="{{ original.get_url_path }}" class="viewsitelink">{% trans "View on site" %}</a></li>
            {% endif%}
        </ul>
    {% endif %}
{% endblock %}

<!-- CONTENT -->
{% block content %}
    <form action="" method="post" id="job_offer_form">{% csrf_token %}
        <div>
            <!-- Popup Hidden Field -->
            {% if is_popup %}<input type="hidden" name="_popup" value="1" />{% endif %}

            <!-- Errors -->
            {% if form.errors %}
                <p class="errornote">
                {% blocktrans count form.errors.items|length as counter %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktrans %}
                </p>
                {{ form.non_field_errors }}
            {% endif %}

            <!-- Fieldsets -->
            {% block fieldset_job_offer %}
                <fieldset class="grp-module grp-aligned grp-collapse grp-open">
                    <h2>{% trans "Job Offer" %}</h2>
                    {{ form.user_id }}
                    <div class="grp-row grp-cells-1{% if form.position.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.position.field.required %} class="required"{% endif %}>{{ form.position.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.position }}
                                {% if form.position.errors %}
                                    <ul class="errorlist"><li>{{ form.position.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.position.help_text %}<p class="grp-help">{{ form.position.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="grp-row grp-cells-1{% if form.job_type.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.job_type.field.required %} class="required"{% endif %}>{{ form.job_type.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.job_type }}
                                {% if form.job_type.errors %}
                                    <ul class="errorlist"><li>{{ form.job_type.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.job_type.help_text %}<p class="grp-help">{{ form.job_type.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="grp-row grp-cells-1{% if form.qualifications.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.qualifications.field.required %} class="required"{% endif %}>{{ form.qualifications.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.qualifications }}
                                {% if form.qualifications.errors %}
                                    <ul class="errorlist"><li>{{ form.qualifications.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.qualifications.help_text %}<p class="grp-help">{{ form.qualifications.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    <script type="text/javascript">
                        addEvent(window, "load", function(e) { SelectFilter.init("id_qualifications", "{% trans "Qualifications" %}", 0, "{{ STATIC_URL }}admin/"); });
                    </script>

                    <div class="grp-row grp-cells-1{% if form.job_sectors.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.job_sectors.field.required %} class="required"{% endif %}>{{ form.job_sectors.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.job_sectors }}
                                {% if form.job_sectors.errors %}
                                    <ul class="errorlist"><li>{{ form.job_sectors.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.job_sectors.help_text %}<p class="grp-help">{{ form.job_sectors.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="grp-row grp-cells-1{% if form.categories.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.categories.field.required %} class="required"{% endif %}>{{ form.categories.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.categories }}
                                {% if form.categories.errors %}
                                    <ul class="errorlist"><li>{{ form.categories.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.categories.help_text %}<p class="grp-help">{{ form.categories.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    <script type="text/javascript">
                        addEvent(window, "load", function(e) { SelectFilter.init("id_job_sectors", "{% trans "Job sectors" %}", 0, "{{ STATIC_URL }}admin/"); });
                    </script>

                    <div class="grp-row">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                &nbsp;
                            </div>
                            <div class="c-2">
                                {{ form.is_commercial }}<label class="vCheckboxLabel" for="id_is_commercial">{{ form.is_commercial.label }}</label>
                            </div>
                        </div>
                    </div>
                </fieldset>
            {% endblock %}

            {% block fieldset_job_offer_details %}
                <fieldset class="grp-module grp-aligned grp-collapse grp-closed">
                    <h2 class="grp-collapse-handler">{% trans "Details" %}</h2>
                    {% if form.description %}
                        <div class="grp-row grp-cells-1{% if form.description.errors %} grp-errors{% endif %}">
                            <div class="l-2c-fluid l-d-4">
                                <div class="c-1">
                                    <label{% if form.description.field.required %} class="required"{% endif %}>{{ form.description.label }}</label>
                                </div>
                                <div class="c-2">
                                    {{ form.description }}
                                    {% if form.description.errors %}
                                        <ul class="errorlist"><li>{{ form.description.errors|join:", "}}</li></ul>
                                    {% endif %}

                                    {% if form.description.help_text %}<p class="grp-help">{{ form.description.help_text }}</p>{% endif %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </fieldset>
            {% endblock %}

            {% block fieldset_organizer %}
                <fieldset class="grp-module grp-aligned grp-collapse grp-closed">
                    <h2 class="grp-collapse-handler">{% trans "Offerer" %}</h2>
                    {% if form.offering_institution %}
                        <div class="grp-row grp-cells-1{% if form.offering_institution.errors %} grp-errors{% endif %}">
                            <div class="l-2c-fluid l-d-4">
                                <div class="c-1">
                                    <label{% if form.offering_institution.field.required %} class="required"{% endif %}>{{ form.offering_institution.label }}</label>
                                </div>
                                <div class="c-2">
                                    {{ form.offering_institution }}
                                    {% if form.offering_institution.errors %}
                                        <ul class="errorlist"><li>{{ form.offering_institution.errors|join:", "}}</li></ul>
                                    {% endif %}

                                    {% if form.offering_institution.help_text %}<p class="grp-help">{{ form.offering_institution.help_text }}</p>{% endif %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    <div class="grp-row grp-cells-1{% if form.offering_institution_title.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.offering_institution_title.field.required %} class="required"{% endif %}>{{ form.offering_institution_title.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.offering_institution_title }}
                                {% if form.offering_institution_title.errors %}
                                    <ul class="errorlist"><li>{{ form.offering_institution_title.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.offering_institution_title.help_text %}<p class="grp-help">{{ form.offering_institution_title.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    {% if form.contact_person %}
                        <div class="grp-row grp-cells-1{% if form.contact_person.errors %} grp-errors{% endif %}">
                            <div class="l-2c-fluid l-d-4">
                                <div class="c-1">
                                    <label{% if form.contact_person.field.required %} class="required"{% endif %}>{{ form.contact_person.label }}</label>
                                </div>
                                <div class="c-2">
                                    {{ form.contact_person }}
                                    {% if form.contact_person.errors %}
                                        <ul class="errorlist"><li>{{ form.contact_person.errors|join:", "}}</li></ul>
                                    {% endif %}

                                    {% if form.contact_person.help_text %}<p class="grp-help">{{ form.contact_person.help_text }}</p>{% endif %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    <div class="grp-row grp-cells-1{% if form.contact_person_name.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.contact_person_name.field.required %} class="required"{% endif %}>{{ form.contact_person_name.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.contact_person_name }}
                                {% if form.contact_person_name.errors %}
                                    <ul class="errorlist"><li>{{ form.contact_person_name.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.contact_person_name.help_text %}<p class="grp-help">{{ form.contact_person_name.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                </fieldset>
            {% endblock %}


            {% block fieldset_location %}
                <fieldset class="grp-module grp-aligned grp-collapse grp-open">
                    <h2 class="grp-collapse-handler">{% trans "Contact Info" %}</h2>

                    {% with contact_form=form make_nested=1 %}
                        {% include "extendedadmin/includes/fieldset_contact_form.html" %}

                        {% include "extendedadmin/includes/fieldset_phones.html" %}
                        {% include "extendedadmin/includes/fieldset_emails.html" %}
                        {% include "extendedadmin/includes/fieldset_websites.html" %}
                        {% include "extendedadmin/includes/fieldset_ims.html" %}
                    {% endwith %}
                </fieldset>
            {% endblock %}

            {% block fieldset_additional_info %}
                <fieldset class="grp-module aligned collapse closed">
                    <h2 class="collapse-handler">{% trans "Additional Info" %}</h2>
                    <div class="grp-row grp-cells-1{% if form.additional_info.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.additional_info.field.required %} class="required"{% endif %}>{{ form.additional_info.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.additional_info }}
                                {% if form.additional_info.errors %}
                                    <ul class="errorlist"><li>{{ form.additional_info.errors|join:", "}}</li></ul>
                                {% endif %}
            
                                {% if form.additional_info.help_text %}<p class="grp-help">{{ form.additional_info.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="grp-row grp-cells-1{% if form.tags.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.tags.field.required %} class="required"{% endif %}>{{ form.tags.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.tags }}
                                {% if form.tags.errors %}
                                    <ul class="errorlist"><li>{{ form.tags.errors|join:", "}}</li></ul>
                                {% endif %}
            
                                {% if form.tags.help_text %}<p class="grp-help">{{ form.tags.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                </fieldset>
            {% endblock %}

            {% block fieldset_status %}
                <fieldset class="grp-module grp-aligned grp-collapse grp-closed">
                    <h2 class="grp-collapse-handler">{% trans "Publish Status" %}</h2>
                    <div class="grp-row grp-cells-1{% if form.author.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.author.field.required %} class="required"{% endif %}>{{ form.author.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.author }}
                                {% if form.author.errors %}
                                    <ul class="errorlist"><li>{{ form.author.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.author.help_text %}<p class="grp-help">{{ form.author.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="grp-row grp-cells-1{% if form.status.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.status.field.required %} class="required"{% endif %}>{{ form.status.label }}</label>
                            </div>
                            <div class="c-2">
                                {{ form.status }}
                                {% if form.status.errors %}
                                    <ul class="errorlist"><li>{{ form.status.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.status.help_text %}<p class="grp-help">{{ form.status.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="grp-row grp-cells-1{% if form.published_from.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.published_from.field.required %} class="required"{% endif %}>{% trans "Publishing date" %}</label>
                            </div>
                            <div class="c-2">
                                {{ form.published_from }}
                                {% if form.published_from.errors %}
                                    <ul class="errorlist"><li>{{ form.published_from.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.published_from.help_text %}<p class="grp-help">{{ form.published_from.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="grp-row grp-cells-1{% if form.published_till.errors %} grp-errors{% endif %}">
                        <div class="l-2c-fluid l-d-4">
                            <div class="c-1">
                                <label{% if form.published_till.field.required %} class="required"{% endif %}>{% trans "Published until" %}</label>
                            </div>
                            <div class="c-2">
                                {{ form.published_till }}
                                {% if form.published_till.errors %}
                                    <ul class="errorlist"><li>{{ form.published_till.errors|join:", "}}</li></ul>
                                {% endif %}

                                {% if form.published_till.help_text %}<p class="grp-help">{{ form.published_till.help_text }}</p>{% endif %}
                            </div>
                        </div>
                    </div>
                </fieldset>
            {% endblock %}

            <!-- Submit-Row -->
            <footer class="grp-module grp-submit-row grp-fixed-footer">
                <header style="display: none">
                    <h1>Submit options</h1>
                </header>
                <ul>
                    <li class="grp-float-left"><a class="grp-button grp-delete-link" href="delete/">Delete</a></li>
                    <li><input type="submit" value="{% trans 'Save' %}" class="grp-button grp-default" name="_save" /></li>
                    <li><input type="submit" value="{% trans 'Save and add another' %}" class="grp-button" name="_addanother" /></li>
                    <li><input type="submit" value="{% trans 'Save and continue editing' %}" class="grp-button" name="_continue" /></li>
                </ul>
            </footer>
        </div>
    </form>

    <script type="text/javascript" src="//maps.google.com/maps/api/js?language=de&amp;region=DE&amp;key={{ GOOGLE_API_KEY }}"></script>
    <script type="text/javascript" src="{{ JETSON_MEDIA_URL }}js/admin/gmaps_for_address.js"></script>

{% endblock %}
