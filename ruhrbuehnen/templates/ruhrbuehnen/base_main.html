{% extends "base.html" %}

{% load base_tags cms_tags menu_tags sekizai_tags i18n image_modifications infobanners_tags staticfiles %}

{% block meta_tags %}
    {{ block.super }}

    {% block open_graph %}
        {% with open_graph_settings=request.current_page.open_graph_settings %}
            {% if open_graph_settings %}
                {# Open Graph settings from CMS page #}
                <meta property="og:title" content="{{ open_graph_settings.og_title }}"/>
                <meta property="og:type" content="{{ open_graph_settings.og_type }}"/>
                {% if open_graph_settings.og_image %}
                    <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ MEDIA_URL }}{{ open_graph_settings.og_image|modified_path:"og" }}"/>
                {% else %}
                    <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ STATIC_URL }}site/img/ruhrbuehnen_opengraph.png"/>
                    {#                <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ MEDIA_URL }}logo_ruhrbuehnen_fb_v3.png" />#}
                {% endif %}
                <meta property="og:description" content="{{ open_graph_settings.og_description|escape }}"/>
            {% else %}
                {# Default Open Graph settings #}
                {% page_attribute "title" as title %}
                {% page_attribute "meta_description" as meta_description %}
                <meta property="og:title" content="{{ title|default:"Berlin Bühnen" }}"/>
                <meta property="og:type" content="{{ title|yesno:"article,website" }}"/>
                <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ STATIC_URL }}site/img/ruhrbuehnen_opengraph.png"/>
                {#            <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ MEDIA_URL }}logo_ruhrbuehnen_fb_v3.png" />#}
                <meta property="og:description" content="{{ meta_description|default:site_settings.meta_description|escape }}"/>
            {% endif %}
            <meta property="og:image:type" content="image/jpeg"/>
            <meta property="og:image:width" content="600"/>
            <meta property="og:image:height" content="600"/>
        {% endwith %}
    {% endblock %}
    <meta property="og:url" content="{{ request.scheme }}://{{ request.get_host }}{{ request.path }}"/>
    <meta property="og:site_name" content="Ruhrbühnen"/>
    <meta property="og:locale" content="{{ OPEN_GRAPH_LOCALE }}"/>
    {# <meta property="fb:app_id" content="" /> #}

{% endblock %}

{% block stylesheet %}
    {{ block.super }}

    <link href="{{ STATIC_URL }}site/css/style.min.css" rel="stylesheet" media="screen, print" type="text/css"/>
    <link href="{{ STATIC_URL }}site/css/print.min.css" rel="stylesheet" media="print" type="text/css"/>
{% endblock %}

{% block script %}
    {{ block.super }}

    {% now "uuuu" as microseconds %}
    <script nonce="{{ microseconds|to_base64 }}">
        var preload_images = [];

        function preload() {
            for (i = 0; i < preload.arguments.length; i++) {
                preload_images[i] = new Image();
                preload_images[i].src = preload.arguments[i];
            }
        }

        preload(
            //"{{ STATIC_URL }}site/img/placeholder_event.png",
            //"{{ STATIC_URL }}site/img/placeholder_location_grid.png"
        );
    </script>
    {% add_data "script_nonces" microseconds|to_base64 %}

    {% now "uuuu" as microseconds %}
    <script nonce="{{ microseconds|to_base64 }}">
        // forcing django CMS to use the already included version of jQuery
        //var django = {jQuery: jQuery};
        var django = {};
        //var language = {};
        //language.Photo = '{% trans "Photo" %}';
    </script>
    {% add_data "script_nonces" microseconds|to_base64 %}

{% endblock %}


{% block body %}
    <!--
        {% if request.is_phone %}This is phone.{% endif %}
        {% if request.is_tablet %}This is tablet.{% endif %}
        {% if request.is_mobile %}This is a mobile device.{% endif %}
        {% if not request.is_mobile %}This is a desktop.{% endif %}
    -->

    <div id="social_menu" data-add-class="social-menu" data-add-class-target="200">
        {% if request.user.is_authenticated %}
            <a href="/{{ LANGUAGE_CODE }}/my-profile/favorites/" class="h5 demi">
                <span class="icon user">{% include 'svg/icons/user.svg' %}</span>
                <span class="text">{% trans "My Favorites" %}</span>
            </a>
            <div></div>
        {% else %}
            <a href="/{{ LANGUAGE_CODE }}/login/" class="h5 demi">
                <span class="icon user">{% include 'svg/icons/user.svg' %}</span><span class="text">{% trans "Login" %}</span>
            </a>
            <div></div>
        {% endif %}
        <a href="" target="_blank" class="h5 demi">
            <span class="icon twitter">{% include 'svg/icons/twitter.svg' %}</span><span class="text">{% trans "Follow us on Twitter" %}</span>
        </a>
        <div></div>
        <a href="https://www.facebook.com/ruhrkultur.jetzt/" target="_blank" class="h5 demi">
            <span class="icon facebook">{% include 'svg/icons/facebook.svg' %}</span><span class="text">{% trans "Follow us on Facebook" %}</span>
        </a>
        <div></div>
        <a href="https://www.instagram.com/ruhrkultur.jetzt/" target="_blank" class="h5 demi">
            <span class="icon instagram">{% include 'svg/icons/instagram.svg' %}</span><span class="text">{% trans "Follow us on Instagram" %}</span>
        </a>
        <div></div>
        {% language_chooser %}
    </div>

    <div id="page">
        {% block header %}
            {% include 'utils/header.html' %}
        {% endblock %}

        <div id="body">
            {% block content %}
            {% endblock %}
        </div>

        <a href="#top" id="to-top">
            <span class="sr-only">{% trans 'Back to top' %}</span>
        </a>

        {% block footer %}
            {% include 'utils/footer.html' %}
        {% endblock %}
    </div>

    <span class="width-sniffer visible-xs"></span>
    <span class="width-sniffer visible-sm"></span>
    <span class="width-sniffer visible-md"></span>
    <span class="width-sniffer visible-lg"></span>
    <span class="width-sniffer visible-xl"></span>
{% endblock body %}
