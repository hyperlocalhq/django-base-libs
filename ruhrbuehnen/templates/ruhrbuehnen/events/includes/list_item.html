{% load i18n image_modifications base_tags tagging_tags production_tags favorites_tags auth_extended fb_tags %}

<a class="grid-item col-xs-12 col-sm-12 col-md-6 col-lg-6" href="{{ event.get_url_path }}">

    <span class="img">
        {% if event.first_image %}
            <img class="responsive-xl responsive-sm responsive-xs" data-responsive-src="{{ MEDIA_URL }}{{ event.first_image.path|modified_path:"grid_xl_xs" }}{% if event.production.is_editable %}?now={% now "YmdHis" %}{% endif %}" src="about:blank" style="display:none;" alt="{{ event.production.title|escape }}" />
            <img class="responsive-lg responsive-md" data-responsive-src="{{ MEDIA_URL }}{{ event.first_image.path|modified_path:"grid_locations_lg_md_sm" }}{% if event.production.is_editable %}?now={% now "YmdHis" %}{% endif %}" src="about:blank" style="display:none;" alt="{{ event.production.title|escape }}" />
            {% with event.first_image.path|file_description as file_desc %}
                {% if file_desc.author %}<span class="photo-credits-over">{% trans "Photo" %}: {{ file_desc.author }}</span>{% endif %}
            {% endwith %}
        {% elif event.ev_or_prod_images %}
            {% with event.ev_or_prod_images|first as image %}
                <img class="responsive-xl responsive-sm responsive-xs" data-responsive-src="{{ MEDIA_URL }}{{ image.path|modified_path:"grid_xl_xs" }}{% if event.production.is_editable %}?now={% now "YmdHis" %}{% endif %}" src="about:blank" style="display:none;" alt="{{ event.production.title|escape }}" />
                <img class="responsive-lg responsive-md" data-responsive-src="{{ MEDIA_URL }}{{ image.path|modified_path:"grid_locations_lg_md_sm" }}{% if event.production.is_editable %}?now={% now "YmdHis" %}{% endif %}" src="about:blank" style="display:none;" alt="{{ event.production.title|escape }}" />
                {% with image.path|file_description as file_desc %}
                    {% if file_desc.author %}<span class="photo-credits-over">{% trans "Photo" %}: {{ file_desc.author }}</span>{% endif %}
                {% endwith %}
            {% endwith %}
        {% else %}
            <img src="{{ STATIC_URL }}site/img/placeholder.png" />
        {% endif %}

        {% comment %}
        <div class="hidden-xs">
            {% if request.user.is_authenticated %}
                {% adding2favorites for event using "favorites/includes/favorite_button.html" %}
            {% else %}
                {% login2favorites using "favorites/includes/favorite_button_login.html" %}
            {% endif %}
        </div>
        {% endcomment %}

        <div class="button-bar-wrapper visible-xs">
            <div class="button-bar">
                {% if request.user.is_authenticated %}
                    {% adding2favorites for event using "favorites/includes/favorite_button.html" %}
                {% else %}
                    {% login2favorites using "favorites/includes/favorite_button_login.html" %}
                {% endif %}
                {% if event.tickets_website %}<button class="tickets" data-href="{{ event.tickets_website }}" data-target="_blank" title="{% trans 'Get tickets' %}"><span class="icon">{% include 'svg/icons/tickets.svg' %}</span></button>{% endif %}
            </div>
        </div>
    </span>

    <h4 class="alt-font light">{{ event.start_date|date:"d.m." }} | {{ event.start_time|time:"H:i" }}</h4>
    {% if event.production.title %}<h4 class="alt-font">{{ event.production.title }}</h4>{% elif event.production.original %}<h4 class="alt-font">{{ event.production.original }}</h4>{% endif %}
</a>

{% comment %}
<div class="list-item col-xs-12">
    <div class="row">

        <!-- list item head (date and image) -->
        <div class="list-item-head col-xs-12 col-sm-5 col-md-4 col-lg-3">
            <div class="row">

                <!-- date -->
                <div class="list-item-head-date col-xs-12 col-sm-4">
                    <div class="row">
                        <div class="list-item-head-date-day col-xs-3 col-sm-12">
                            {{ event.start_date|date:"D" }}
                        </div>
                        <div class="list-item-head-date-month col-xs-3 col-sm-12">
                            <span class="hidden-xs">{{ event.start_date|date:"j. F" }}</span>
                            <span class="visible-xs">{{ event.start_date|date:"j. M" }}</span>
                        </div>
                        <div class="list-item-head-date-type col-xs-3 col-sm-12">
                            {% if event.production.get_categories %}
                                {{ event.production.get_categories.0.title }}
                            {% endif %}
                        </div>
                        <div class="list-item-head-date-time col-xs-3 col-sm-12">
                            {{ event.start_time|time:"H:i" }}
                        </div>
                        <div class="list-item-head-date-icons col-xs-3 col-sm-12">
                            {% if request.user.is_authenticated %}
                                {% adding2favorites for event using "favorites/includes/favorite_detail.html" %}
                            {% else %}
                                {% login2favorites using "favorites/includes/favorite_detail_login.html" %}
                            {% endif %}
                            {% add_to_calender event=event %}
                            {% if event.ev_or_prod_tickets_website %}
                                <a class="fawesome tickets" href="{{ event.ev_or_prod_tickets_website }}" target="_blank" data-toggle="tooltip" data-placement="top" title="{% trans "Tickets" %}" data-tooltip-left="-10,.is-xs"><span class="sr-only">{% trans "Tickets" %}</span></a>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- image -->
                <div class="list-item-head-image img hidden-xs col-sm-8">
                    {% if event.first_image %}
                        <img src="{{ MEDIA_URL }}{{ event.first_image.path|modified_path:"list_image" }}{% if event.production.is_editable %}?now={% now "YmdHis" %}{% endif %}" alt="{{ event.production.title|escape }}" />
                        {% with event.first_image.path|file_description as file_desc %}
                            {% if file_desc.author %}<span class="photo-credits-over">{% trans "Photo" %}: {{ file_desc.author }}</span>{% endif %}
                        {% endwith %}
                    {% elif event.ev_or_prod_images %}
                        {% with event.ev_or_prod_images|first as image %}
                            <img src="{{ MEDIA_URL }}{{ image.path|modified_path:"list_image" }}{% if event.production.is_editable %}?now={% now "YmdHis" %}{% endif %}" alt="{{ event.production.title|escape }}" />
                            {% with image.path|file_description as file_desc %}
                                {% if file_desc.author %}<span class="photo-credits-over">{% trans "Photo" %}: {{ file_desc.author }}</span>{% endif %}
                            {% endwith %}
                        {% endwith %}
                    {% else %}
                        <img src="{{ STATIC_URL }}site/img/placeholder_event.png" />
                    {% endif %}
                </div>

            </div>
        </div>

        <!-- list item body -->
        <div class="list-item-body col-xs-12 col-sm-7 col-md-8 col-lg-9">
            <a class="list-item-link" href="{{ event.get_url_path }}{% remove_from_query "page" %}">
                {% if event.production.in_program_of.exists or event.location_title or event.production.location_title or event.ev_or_prod_play_locations|length > 0 or event.ev_or_prod_play_stages|length > 0 %}
                    <dl {% if event.get_special_text or event.is_canceled %} class="short" {% endif %}>
                        {% with event.get_festivals as festivals %}
                            {% if festivals %}
                                <dd class="festivals">
                                    {% for festival in festivals %}
                                        <span class="festival" data-url="{{ festival.get_url_path }}">{% if forloop.counter == 1 %}{% trans "Festival" %}: {% endif %}{{ festival.title }}</span>
                                    {% endfor %}
                                </dd>
                            {% endif %}
                        {% endwith %}
                        {% if event.production.in_program_of.exists %}
                            {% for location in event.production.in_program_of.all %}
                                <dd>
                                    {{ location.title }}
                                </dd>
                            {% endfor %}
                        {% endif %}
                        {% if event.location_title %}
                            <dd>
                                {{ event.location_title }}
                            </dd>
                        {% elif event.production.location_title %}
                            <dd>
                                {{ event.production.location_title }}
                            </dd>
                        {% endif %}
                        {% for location in event.ev_or_prod_play_locations %}
                            <dd>
                                {{ location.title }}
                            </dd>
                        {% endfor %}
                        {% for stage in event.ev_or_prod_play_stages %}
                            <dd>
                                {{ stage.title }}
                            </dd>
                        {% endfor %}
                    </dl>
                {% endif %}
                {% if event.production.ensembles %}<h3 {% if event.get_special_text or event.is_canceled %} class="short" {% endif %}>{{ event.production.ensembles }}</h3>{% endif %}
                {% if event.production.title %}<h2 {% if event.get_special_text or event.is_canceled %} class="short" {% endif %}>{% if event.production.prefix %}{{ event.production.prefix }} {% endif %}{{ event.production.title }}</h2>{% endif %}
                {% if event.production.subtitle %}<h3>{{ event.production.subtitle }}</h3>
                {% elif event.ev_or_prod_subtitles_text %}<h3>{{ event.ev_or_prod_subtitles_text|striptags }}</h3>{% endif %}
                {% if event.production.original %}<h3>{{ event.production.original }}</h3>{% endif %}
                {% if event.language_and_subtitles or event.production.language_and_subtitles %}<h3>{{ event.language_and_subtitles|default:event.production.language_and_subtitles }}</h3>{% endif %}
                {% if event.ev_or_prod_teaser %}<div class="copy">{{ event.ev_or_prod_teaser|striptags }}</div>{% endif %}
                {% if event.get_special_text and not event.is_canceled %}<div class="extra"><span>{{ event.get_special_text }}</span></div>{% endif %}
                {% if event.is_canceled %}<div class="extra canceled"><span>{% trans 'canceled' %}</span></div>{% endif %}
            </a>
        </div>

    </div>
</div>
{% endcomment %}
