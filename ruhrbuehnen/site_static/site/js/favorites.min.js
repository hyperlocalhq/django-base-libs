u.ready(function(){function a(c){var b=this;b.u_element=c;b.u_span=u(b.u_element.children("span.sr-only").first());b.content_type_id=b.u_element.attr("data-content-type-id");b.object_id=b.u_element.attr("data-object-id");b.sInnerTextToAdd=favorite_tooltip_text.Add_to_My_Favorites;b.sTitleToAdd=favorite_tooltip_text.Add_to_My_Favorites;b.sInnerTextToRemove=favorite_tooltip_text.Remove_from_My_Favorites;b.sTitleToRemove=favorite_tooltip_text.Remove_from_My_Favorites;if(b.content_type_id&&b.object_id){c.click(function(d){return b.toggle(d)})}}a.prototype.toggle=function(c){c.preventDefault();var b=this;b.u_element.addClass("progress").css("cursor","wait");u.ajax("/"+window.settings.LANGUAGE_CODE+"/helper/favorite/"+b.content_type_id+"/"+b.object_id+"/",function(e,d){if(d){b.showResults(e)}});return false};a.prototype.showResults=function(c){var b=this;if(c){c=JSON.parse(c);if(c.action==="added"){b.u_element.attr("title",b.sTitleToRemove).addClass("active");b.u_span.html(b.sInnerTextToRemove)}else{b.u_element.attr("title",b.sTitleToAdd).removeClass("active");b.u_span.html(b.sInnerTextToAdd)}if(c.count!==undefined){b.u_element.children(".favorites_count").text(c.count)}}b.u_element.removeClass("progress").css("cursor","")};u("button.favorite, a.favorite, .toggle.favorite").each(function(b){new a(u(b))})});