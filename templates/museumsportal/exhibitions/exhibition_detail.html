{% extends "base.html" %}
{% load base_tags i18n image_modifications tagging_tags %}
{% block bodyclass %}exhibition-detail{% endblock %}

{% block js %}
    <link href="{{ STATIC_URL }}site/shadowbox/shadowbox.css" rel="stylesheet" media="screen" type="text/css" />
    <script type="text/javascript" src="{{ STATIC_URL }}site/shadowbox/shadowbox.js"></script>
    
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&amp;language={{ LANGUAGE_CODE }}"></script>
    
    {% with object as exhibition %}
        <script type="text/javascript">
        function openGoogleMaps() {
            Shadowbox.open({
                player:     "html",
                content:    "",
                height:     $(window).height(),
                width:      $(window).width(),
                options:    {
                    onFinish: function(item) {
                        /*var body = document.getElementById();*/
                        var latlng = new google.maps.LatLng({{ exhibition.museum.latitude|default:52.519171 }}, {{ exhibition.museum.longitude|default:13.4060912 }});
                        var myOptions = {
                        mapTypeControl: true,
                        zoomControl: true,
                        streetViewControl: true,
                        zoom: 16,
                        center: latlng,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                        };
                        var map = new google.maps.Map(
                            document.getElementById(Shadowbox.playerId),
                            myOptions
                        );
                        var oImage = new google.maps.MarkerImage(
                            "{{ STATIC_URL }}site/img/gmap/markers_1-10.png",
                            // This marker is 20 pixels wide by 32 pixels tall.
                            new google.maps.Size(20, 34),
                            // The origin for this image is 0,0.
                            new google.maps.Point(0, 0),
                            // The anchor for this image is the base of the flagpole at 0,32.
                            new google.maps.Point(10, 34)
                        );                                
                        var oShadow = new google.maps.MarkerImage(
                            "{{ STATIC_URL }}site/img/gmap/marker_shadow.png",
                            // The shadow image is larger in the horizontal dimension
                            // while the position and offset are the same as for the main image.
                            new google.maps.Size(37, 34),
                            new google.maps.Point(0, 0),
                            new google.maps.Point(8, 25)
                        );
                        var marker = new google.maps.Marker({
                            map: map, 
                            position: latlng,
                            shadow: oShadow,
                            icon: oImage
                        });
                        /*var map = new GMap2(body);
                        map.setCenter(new GLatLng(37.4419, -122.1419), 13);
        
                        // add 10 markers to the map at random locations
                        var bounds = map.getBounds();
                        var southWest = bounds.getSouthWest();
                        var northEast = bounds.getNorthEast();
                        var lngSpan = northEast.lng() - southWest.lng();
                        var latSpan = northEast.lat() - southWest.lat();
                        for (var i = 0; i < 10; i++) {
                            var point = new GLatLng(southWest.lat() + latSpan * Math.random(),
                                southWest.lng() + lngSpan * Math.random());
                            map.addOverlay(new GMarker(point));
                        }
        
                        // add some simple controls
                        map.addControl(new GSmallMapControl());
                        map.addControl(new GMapTypeControl());*/
                    }
                }
            });
        }
        
        Shadowbox.init({
            overlayColor:   "#f8f6f2",
            overlayOpacity: 0.9,
            continuous:     true,
            animate:        true
        });
        
        $(document).ready(function(){
            $(".toggle_bvg").click(function () {
                $("#bvg_widget").toggleClass("on");
                return false
            });
        });
        </script>
    {% endwith %}
{% endblock %}


{% block content %}
<div class="content clearfix">
  <div class="inner">
    {% with object as exhibition %}

        <header>
            {% if exhibition.image %}
            <ul id="slide">
                <li>
                    <a class="img" href="{{ exhibition.get_url_path }}" style="background-image: url({{ MEDIA_URL }}{{ exhibition.image }})"></a>
                    <span class="overlay">
                        <time>{% if exhibition.permanent %}{% trans "Permanent exhibition" %}{% else %}
                            <span class="from_date">{{ exhibition.start|date:"j. F Y" }}</span> {% trans "till" %} {{ exhibition.end|date:"j. F Y" }}{% endif %}</time>
                    </span>
                </li>
            </ul>

            <nav class="actions bottom">
                <button id="fullscreen" rel="tooltip" data-placement="bottom" data-original-title="Fullscreen" class="fullscreen"></button>
            </nav>
            {% endif %}
        </header>

        <section class="sidebar">
            <ul class="accordion" id="accordion2">  
                <li class="accordion-group">  
                    <h4 class="accordion-heading">  
                        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse-location">  
                            {% trans "Location" %}
                        </a>
                    </h4>
                    <ul id="collapse-location" class="accordion-body collapse">  
                        <li class="accordion-inner">
                            {% if exhibition.street_address %}
                                <dl class="address">
                                    <dt>{% trans "Address" %}</dt>
                                    <dd>{{ exhibition.location_name }}</dd>
                                    <dd>{{ exhibition.street_address }}</dd>
                                    {% if exhibition.street_address2 %}<dd>{{ exhibition.street_address2 }}</dd>{% endif %} 
                                    <dd>{{ exhibition.postal_code }} {{ exhibition.city }}</dd>
                                </dl>
                            {% else %}
                                {% with exhibition.museum as museum %}
                                    <dl class="address">
                                        <dt>{% trans "Address" %}</dt>
                                        <dd>{{ museum.title }}</dd>
                                        <dd>{{ museum.street_address }}</dd>
                                        {% if museum.street_address2 %}<dd>{{ museum.street_address2 }}</dd>{% endif %} 
                                        <dd>{{ museum.postal_code }} {{ museum.city }}</dd>
                                    </dl>
                                {% endwith %}
                            {% endif %}
                            {% if exhibition.organizing_museum %}
                                <dl>
                                    <dt>{% trans "Organizer" %}</dt>
                                    <dd><a href="{{ exhibition.organizing_museum.get_url_path }}">{{ exhibition.organizing_museum.title }}</a></dd>
                                </dl>
                            {% else %}
                                {% if exhibition.organizer_title %}
                                    <dl>
                                        <dt>{% trans "Organizer" %}</dt>
                                        {% if exhibition.organizer_url_link %}
                                            <dd><a href="{{ exhibition.organizer_url_link }}">{{ exhibition.organizer_title }}</a></dd>
                                        {% else %}
                                            <dd>{{ exhibition.organizer_title }}</dd>
                                        {% endif %}
                                    </dl>
                                {% endif %}
                            {% endif %}
                        </li>
                        <li class="accordion-inner">  
                            <a class="" onclick="openGoogleMaps();" id="map_link" title="Karte" href="#">Googlemaps</a>
                            <a class="toggle_bvg" href="#">{% if LANGUAGE_CODE == "de" %}BVG Suche{% else %}BVG Search{% endif %}</a>
                        </li>
                    </ul>  
                </li>
                <li class="accordion-group">  
                    <h4 class="accordion-heading">  
                        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse-times">  
                            {% trans "When?" %}
                        </a>
                    </h4>
                    <ul id="collapse-times" class="accordion-body collapse">  
                        <li class="accordion-inner">
                            {% if exhibition.permanent %}
                                <p>{% trans "Permanent exhibition" %}</p>
                            {% else %}
                                <p>{{ exhibition.start|date:"d.m.Y" }} {% trans "till" %} {{ exhibition.end|date:"d.m.Y" }}</p>
                            {% endif %}
                            {% if exhibition.vernissage %}
                                <dl>
                                    <dt>{% trans "Vernissage" %}</dt>
                                    <dd>{{ exhibition.vernissage|date:"d.m.Y H:i" }}</dd>
                                </dl>
                            {% endif %} 
                            {% if exhibition.finissage %}
                                <dl>
                                    <dt>{% trans "Finissage" %}</dt>
                                    <dd>{{ exhibition.finissage|date:"d.m.Y H:i" }}</dd>
                                </dl>
                            {% endif %} 
                        </li>
                    </ul>  
                </li>
                <li class="accordion-group">  
                    <h4 class="accordion-heading">  
                        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse-opening-times">
                            {% trans "Opening hours" %}
                        </a>  
                    </h4>  
                    <ul id="collapse-opening-times" class="accordion-body collapse in">  
                        <li class="accordion-inner">
                            {% for season in exhibition.season_set.all %}
                                <h5>{% trans "Season" %} {{ season.start|date:"j. F Y" }} - {{ season.end|date:"j. F Y" }}</h5>
                                {% if season.is_appointment_based %}
                                    <p>{% trans "Based on appointment" %}</p>
                                {% else %}
                                    <table width="100%" border="0" cellspacing="5" cellpadding="10">
                                         <thead>
                                            <tr>
                                                <th>&nbsp;</th>
                                                {% if season.mon_open %}
                                                <th>Von</td> 
                                                {% if season.mon_break_close %}
                                                <th>Bis</th> 
                                                <th>Von</th>
                                                {% endif %} 
                                                <th>Bis</th>
                                                {% else %}
                                                <th>{% trans "closed" %}</th>
                                                {% endif %}
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <th>{% trans "Mon" %}</th>
                                                {% if season.mon_open %}
                                                <td>{{ season.mon_open|time:"H:i" }}</td> 
                                                {% if season.mon_break_close %}
                                                <td>{{ season.mon_break_close|time:"H:i" }}</td> 
                                                <td>{{ season.mon_break_open|time:"H:i" }}</td>
                                                {% endif %} 
                                                <td>{{ season.mon_close|time:"H:i" }}</td>
                                                {% else %}
                                                <td>{% trans "closed" %}</td>
                                                {% endif %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>{% trans "Tue" %}</th>
                                                {% if season.tue_open %}
                                                <td>{{ season.tue_open|time:"H:i" }}</td> 
                                                {% if season.tue_break_close %}
                                                <td>{{ season.tue_break_close|time:"H:i" }}</td> 
                                                <td>{{ season.tue_break_open|time:"H:i" }}</td>
                                                {% endif %} 
                                                <td>{{ season.tue_close|time:"H:i" }}</td>
                                                {% else %}
                                                <td>{% trans "closed" %}</td>
                                                {% endif %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>{% trans "Wed" %}</th>
                                                {% if season.wed_open %}
                                                <td>{{ season.wed_open|time:"H:i" }}</td> 
                                                {% if season.wed_break_close %}
                                                <td>{{ season.wed_break_close|time:"H:i" }}</td> 
                                                <td>{{ season.wed_break_open|time:"H:i" }}</td>
                                                {% endif %} 
                                                <td>{{ season.wed_close|time:"H:i" }}</td>
                                                {% else %}
                                                <td>{% trans "closed" %}</td>
                                                {% endif %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>{% trans "Thu" %}</th>
                                                {% if season.thu_open %}
                                                <td>{{ season.thu_open|time:"H:i" }}</td> 
                                                {% if season.thu_break_close %}
                                                <td>{{ season.thu_break_close|time:"H:i" }}</td> 
                                                <td>{{ season.thu_break_open|time:"H:i" }}</td>
                                                {% endif %} 
                                                <td>{{ season.thu_close|time:"H:i" }}</td>
                                                {% else %}
                                                <td>{% trans "closed" %}</td>
                                                {% endif %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>{% trans "Fri" %}</th>
                                                {% if season.fri_open %}
                                                <td>{{ season.fri_open|time:"H:i" }}</td> 
                                                {% if season.fri_break_close %}
                                                <td>{{ season.fri_break_close|time:"H:i" }}</td> 
                                                <td>{{ season.fri_break_open|time:"H:i" }}</td>
                                                {% endif %} 
                                                <td>{{ season.fri_close|time:"H:i" }}</td>
                                                {% else %}
                                                <td>{% trans "closed" %}</td>
                                                {% endif %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>{% trans "Sat" %}</th>
                                                {% if season.sat_open %}
                                                <td>{{ season.sat_open|time:"H:i" }}</td> 
                                                {% if season.sat_break_close %}
                                                <td>{{ season.sat_break_close|time:"H:i" }}</td> 
                                                <td>{{ season.sat_break_open|time:"H:i" }}</td>
                                                {% endif %} 
                                                <td>{{ season.sat_close|time:"H:i" }}</td>
                                                {% else %}
                                                <td>{% trans "closed" %}</td>
                                                {% endif %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>{% trans "Sun" %}</th>
                                                {% if season.sun_open %}
                                                <td>{{ season.sun_open|time:"H:i" }}</td> 
                                                {% if season.sun_break_close %}
                                                <td>{{ season.sun_break_close|time:"H:i" }}</td> 
                                                <td>{{ season.sun_break_open|time:"H:i" }}</td>
                                                {% endif %} 
                                                <td>{{ season.sun_close|time:"H:i" }}</td>
                                                {% else %}
                                                <td>{% trans "closed" %}</td>
                                                {% endif %}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                {% endif %}
                                {% if season.last_entry %}
                                    <div class="last_entry">{% trans "Last entry" %}: {{ season.last_entry }}</div>
                                {% endif %}
                                {% if season.exceptions %}
                                    <div class="exceptions">{{ season.get_rendered_exceptions }}</div>
                                {% endif %}
                            {% endfor %}
                            {% if exhibition.specialopeningtime_set.count %}
                                <h5>{% trans "Special Opening hours" %}</h5>
                                {% for special_opening in exhibition.specialopeningtime_set.all %}
                                    <h6>{% if special_opening.day_label %}{{ special_opening.day_label }}{% endif %}
                                    {{ special_opening.dd }}. {{ special_opening.get_mm_display }} {{ special_opening.yyyy|default:"" }}
                                    </h6>
                                    {% if special_opening.is_closed %}
                                        {% trans "Closed" %}
                                    {% else %}
                                        {% if special_opening.is_closed %}
                                            {% trans "Regular Opening hours" %}
                                        {% else %}
                                            {{ special_opening.opening|time:"H:i" }} - {{ special_opening.closing|time:"H:i" }}
                                            {% if season.sun_break_close %}
                                                | {% trans "Break:" %} {{ special_opening.break_close|time:"H:i" }} - {{ special_opening.break_open|time:"H:i" }}
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        </li>
                    </ul>  
                </li>  
                <li class="accordion-group">  
                    <h4 class="accordion-heading">  
                        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse-prices">  
                            {% trans "Prices" %} 
                        </a>  
                    </h4>  
                    <ul id="collapse-prices" class="accordion-body collapse">  
                        <li class="accordion-inner">
                            <dl>
                            {% if exhibition.free_entrance %}
                                <dt>{% trans "Free entrance" %}</dt>
                            {% else %}
                                {% if exhibition.admission_price %}
                                    <dt>{% trans "Admission price" %}: {{ exhibition.admission_price }}</dt>
                                    {% if exhibition.admission_price_info %}
                                    <dd class="admission_price_info">{{ exhibition.get_rendered_admission_price_info }}</dd>
                                    {% endif %}
                                {% endif %}
                                {% if exhibition.reduced_price %}
                                    <dt>{% trans "Reduced price" %}: {{ exhibition.reduced_price }}</dt>
                                    {% if exhibition.reduced_price_info %}
                                    <dd class="reduced_price_info">{{ exhibition.get_rendered_reduced_price_info }}</dd>
                                    {% endif %}
                                {% endif %}
                                {% if exhibition.arrangements_for_children %}
                                    <dt>{% trans "Arrangements for children" %}</dt>
                                    <dd class="arrangements_for_children">{{ exhibition.get_rendered_arrangements_for_children }}</dd>
                                {% endif %}
                                {% if exhibition.free_entrance_for %}
                                    <dt>{% trans "Free entrance for" %}</dt>
                                    <dd class="free_entrance_for">{{ exhibition.get_rendered_free_entrance_for }}</dd>
                                {% endif %}
                                {% if exhibition.family_ticket %}
                                    <dt>{% trans "Family ticket" %}</dt>
                                    <dd class="family_ticket">{{ exhibition.get_rendered_family_ticket }}</dd>
                                {% endif %}
                                {% if exhibition.group_ticket %}
                                    <dt>{% trans "Group ticket" %}</dt>
                                    <dd class="group_ticket">{{ exhibition.get_rendered_group_ticket }}</dd>
                                {% endif %}
                                {% if exhibition.free_entrance_times %}
                                    <dt>{% trans "Free entrance times" %}</dt>
                                    <dd class="free_entrance_times">{{ exhibition.get_rendered_free_entrance_times }}</dd>
                                {% endif %}
                                {% if exhibition.yearly_ticket %}
                                    <dt>{% trans "Yearly ticket" %}</dt>
                                    <dd class="yearly_ticket">{{ exhibition.get_rendered_yearly_ticket }}</dd>
                                {% endif %}
                                {% if exhibition.other_tickets %}
                                    <dt>{% trans "Other tickets" %}</dt>
                                    <dd class="other_tickets">{{ exhibition.get_rendered_other_tickets }}</dd>
                                {% endif %}
                                {% if exhibition.member_of_exhibitionspass %}
                                    <dt>{% trans "Member if Exhibitionspass Berlin" %}</dt>
                                {% endif %}
                            {% endif %}
                            </dl>
                        </li>
                    </ul>  
                </li>
                <li class="accordion-group">  
                    <h4 class="accordion-heading">  
                        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse-accessibility">  
                            {% trans "Accessibility" %}
                        </a>
                    </h4>
                    <ul id="collapse-accessibility" class="accordion-body collapse">
                        <li class="accordion-inner">
                            {% if exhibition.suitable_for_disabled %}
                                <p>{% trans "Suitable for disabled" %}</p>
                            {% else %}
                                <p>{% trans "Not suitable for disabled" %}</p>
                            {% endif %}
                            {% if exhibition.suitable_for_disabled_info %}
                                <div class="accessibility-desc">
                                    {{ exhibition.get_rendered_suitable_for_disabled_info }}
                                </div>
                            {% endif %}
                        </li>
                    </ul>  
                </li>
            </ul> 
        </section>
            
        <section class="sidebar" style="display: none">
            <dl class="address">
                <dt>{% trans "Location" %}</dt>
                <dd><a href="{{ exhibition.museum.get_url_path }}">{{ exhibition.museum.title }}</a></dd>
                <dd>{{ exhibition.museum.street_address }}</dd>
                {% if exhibition.museum.street_address2 %}<dd>{{ exhibition.museum.street_address2 }}</dd>{% endif %} 
                <dd>{{ exhibition.museum.postal_code }} {{ exhibition.museum.city }}</dd>
                <dd><a onclick="openGoogleMaps();" class="btn" id="map_link" title="Karte" href="#">Googlemaps</a>
                <a class="toggle_bvg btn" href="#">{% if LANGUAGE_CODE == "de" %}BVG Suche{% else %}BVG Search{% endif %}</a></dd>
            </dl>
            <dl id="bvg_widget" class="bvg">
                {% if LANGUAGE_CODE == "de" %}
                    <dt>So erreichen Sie uns</dt>
                    <dd>
                        <a id="bvg_logo" href="http://www.bvg.de/index.php/de/9430/name/Widgets.html" target="_blank" name="logo">&nbsp;</a>
                    
                        <form method="post" target="_blank" action="http://www.fahrinfo-berlin.de/Fahrinfo/bin/" name="fahrinfo_formular" id="fahrinfo_formular">
                            <fieldset class="clearfix">
                            
                                <input type="hidden" name="REQ0JourneyStopsS0ALocation" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsS0AAddress" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsS0APOI" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsZ0ALocation" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsZ0AAddress" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsZ0APOI" value="1" />
                            
                                <input type="hidden" name="REQ0JourneyStopsZA1" value="7"/>
                                <input type="hidden" name="_charset_" value="utf-8"/>
                                <input type="hidden" value="yes" name="start"/>
                            
                                <ul>
                                    <li>
                                        <label for="wdgt_from">Von</label>
                                        <input placeholder="Standort" type="text" name="from" id="wdgt_from" value="">
                                    </li>
                                    
                                    <li>
                                        <label for="wdgt_to">Nach</label>
                                        
                                        <textarea name="to" id="wdgt_to" >{{ exhibition.museum.street_address }}, {% if exhibition.museum.street_address2 %}{{ exhibition.museum.street_address2 }}, {% endif %}&#10;{{ exhibition.museum.postal_code }} {{ exhibition.museum.city }}</textarea>
                                    </li>
                                    
                                    <li>
                                        <label for="wdgt_date">Am</label>
                                        <input type="text" name="date" id="wdgt_date" value="{% now "d.m.Y" %}">
                                    </li>
                                    
                                    <li>
                                        <label for="wdgt_time">Um</label>
                                        <input type="text" name="time" id="wdgt_time" value="{% now "H:i" %}">
                                    </li>
                                    
                                    <li class="radios">
                                        <label for="wdgt_arr">Ankunft</label>
                                        <input id="wdgt_arr" type="radio" class="radio" name="timesel" value="arrive">
                                        
                                        <label for="wdgt_dep">Abfahrt</label>
                                        <input id="wdgt_dep" type="radio" class="radio" name="timesel" value="depart" checked="checked">
                                    </li>
                                    <li>
                                        <input id="submit" type="submit" name="start" value="Anfrage abschicken">
                                    </li>
                                    
                                </ul>
                            </fieldset>
                        </form>
                     </dd>
                {% else %}
                    <dt>How to get there</dt>
                    <dd>
                        <a id="bvg_logo" href="http://www.bvg.de/index.php/de/9430/name/Widgets.html" target="_blank" name="logo">&nbsp;</a>
                    
                        <form method="post" target="_blank" action="http://www.fahrinfo-berlin.de/Fahrinfo/bin/query.bin/en?ld=0.1" name="fahrinfo_formular" id="fahrinfo_formular">
                            <fieldset class="clearfix">
                            
                                <input type="hidden" name="REQ0JourneyStopsS0ALocation" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsS0AAddress" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsS0APOI" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsZ0ALocation" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsZ0AAddress" value="1" />
                                <input type="hidden" name="REQ0JourneyStopsZ0APOI" value="1" />
                                
                                <input type="hidden" name="REQ0JourneyStopsZA1" value="7"/>
                                <input type="hidden" name="_charset_" value="utf-8"/>
                                <input type="hidden" value="yes" name="start"/>
                            
                                <ul>
                                    <li>
                                        <label for="wdgt_from">From</label>
                                        <input placeholder="Location" type="text" name="from" id="wdgt_from" value="">
                                    </li>
                                    
                                    <li>
                                        <label for="wdgt_to">To</label>
                                        
                                        <textarea name="to" id="wdgt_to" >{{ museum.street_address }},&#10;{{ museum.postal_code }}, {{ museum.city }}</textarea>
                                    </li>
                                    
                                    <li>
                                        <label for="wdgt_date">Date</label>
                                        <input type="text" name="date" id="wdgt_date" value="{% now "d.m.Y" %}">
                                    </li>
                                    
                                    <li>
                                        <label for="wdgt_time">Time</label>
                                        <input type="text" name="time" id="wdgt_time" value="{% now "H:i" %}">
                                    </li>
                                    
                                    <li class="radios">
                                        <label for="wdgt_arr">Arrival</label>
                                        <input id="wdgt_arr" type="radio" class="radio" name="timesel" value="arrive">
                                        
                                        <label for="wdgt_dep">Departure</label>
                                        <input id="wdgt_dep" type="radio" class="radio" name="timesel" value="depart" checked="checked">
                                    </li>
                                    <li>
                                        <input id="submit" type="submit" name="start" value="Submit request">
                                    </li>
                                </ul>
                            </fieldset>
                        </form>
                     </dd>
                {% endif %}
                <script type="text/javascript">
                $('#fahrinfo_formular').submit(function() {
                    $('#wdgt_from').val($('#wdgt_from').val().replace(/([Ss]tr)a(ß|ss)e/, "$1."));
                    $('#wdgt_to').val($('#wdgt_to').val().replace(/([Ss]tr)a(ß|ss)e/, "$1."));
                })
                </script>
            </dl>
            
            <dl class="von">
                <dt>{% if LANGUAGE_CODE == "de" %}Von{% else %}From{% endif %}</dt>
                <dd>{{ exhibition.start|date:"d.m.Y" }}</a></dd>
            </dl>
            <dl class="bis">
                <dt>{% if LANGUAGE_CODE == "de" %}Bis{% else %}Till{% endif %}</dt>
                <dd>{{ exhibition.end|date:"d.m.Y" }}</a></dd>
            </dl>
            {% if exhibition.website %}
                <dl class="website">
                    <dt>{% trans "Website" %}</dt>
                    <dd><a href="{{ exhibition.website }}">{{ exhibition.website }}</a></dd>
                </dl>
            {% endif %}
        </section>

        <article class="with_sidebar">
            <header>
                <h1>
                    {{ exhibition.title }}
                     {% if exhibition.subtitle %}
                        <span>{{ exhibition.subtitle }}</span>
                    {% endif %}
                </h1>
                <a href="{{ exhibition.museum.get_url_path }}"><h3>{{ exhibition.museum.title }}</h3></a>
            </header>
            {{ exhibition.get_rendered_description }}
            
            <ul class="tags">
                {% if exhibition.categories.count %}
                    {% for cat in exhibition.categories.all %}
                        <li class="cat"><a href="{% if LANGUAGE_CODE == "de" %}/de/ausstellungen/{% else %}/en/exhibitions/{% endif %}#filter=.cat_{{ cat.title|slugify }}">{{ cat.title }}</a></li>
                    {% endfor %}
                {% endif %}
                {% tags_for_object exhibition as tags %}
                {% if tags %}
                    {% for tag in tags %}
                        <li><a href="{% if LANGUAGE_CODE == "de" %}/de/ausstellungen/{% else %}/en/exhibitions/{% endif %}#filter=.tag_{{ tag.slug }}">{{ tag.name }}</a></li>
                    {% endfor %}
                {% endif %}
            </ul>   

        </article>
    {% endwith %}
  </div>
</div>
<div class="content" class="clearfix" style="background-color: rgba(0,0,0,0.025)">
    <div class="inner">
        <h2>Nur noch kurze Zeit</h2>
        <ul id="container" class="list tiles small clearfix">
            {% get_objects closing_soon exhibitions.Exhibition 5 as exhibitions_closing_soon %}
            {% for exhibition in exhibitions_closing_soon %}
                <li class="item">
                    
                    <a class="img" href="{{ exhibition.get_url_path }}" {% if exhibition.image %}data-background="{{ MEDIA_URL }}{{ exhibition.image|modified_path:"exhibition_list" }}"{% endif %}>
                        <span class="spinner loading"></span>
                        <span class="overlay"></span>
                    </a>

                    <nav class="actions">
                        <button rel="tooltip" data-placement="top" data-original-title="Add to Favorites" class="add-favorite"></button>
                        <button href="#" rel="tooltip" data-placement="top" data-original-title="Show location on map" class="marker-link show-location"></button>
                    </nav>
                        
                    <a href="{{ exhibition.get_url_path }}">
                        <h3>{{ exhibition.museum.title }}</h3>
                        <h4>{{ exhibition.title }}</h4>
                        <h5>{% trans "till" %} {{ exhibition.end|date:"d.m.Y" }}</h5>
                    </a>
                </li>
            {% endfor %}
        </ul>

        <div id="page-controls">
            {% if prev_item %}
                <a href="{{ prev_item.get_url_path }}" class="prev">
                    <span>
                        <span class="title">{{ next_item.title }}</span>
                    </span>
                </a>
            {% endif %}
            {% if next_item %}
                <a href="{{ next_item.get_url_path }}" class="next">
                    <span>
                        <span class="title">{{ next_item.title }}</span>
                    </span>
                </a>
            {% endif %}
        </div>

    </div>
</div>  
<script>
    $(document).keydown(function(e){
        switch(e.which) {
            case 37: // left
                document.location.href="{{ prev_item.get_url_path }}";
            break;

            case 38: // up
                document.location.href="/de/museen/";
            break;

            case 39: // right
                document.location.href="{{ next_item.get_url_path }}";
            break;

            case 40: // down
            break;

            default: return; // exit this handler for other keys
        }
        e.preventDefault();
    });
</script>
{% endblock %}
