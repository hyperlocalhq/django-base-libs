{% extends "base.html" %}
{% load i18n image_modifications fb_tags base_tags %}

{% block content %}
<div class="content clearfix">
    <div class="inner">
        <ul id="photos" class="list clearfix">
            {% for media_file in exhibition.mediafile_set.all %}
                <li class="item" data-token="{{ media_file.get_token }}">
                    <div class="inner"> 
                        <a class="reorder img" data-background="{{ MEDIA_URL }}{{ media_file.path|modified_path:"max" }}?now={% now "YmdHis" %}">
                            <span class="spinner loading"></span>
                            
                            <img class="cover" src="{{ MEDIA_URL }}{{ media_file.path|modified_path:"cover" }}?now={% now "YmdHis" %}" alt="" />
                            <img class="max" src="{{ MEDIA_URL }}{{ media_file.path|modified_path:"max" }}?now={% now "YmdHis" %}" alt="" />
                        </a>
                        {% with media_file.path|file_description as file_desc %}
                        <div class="info">
                        {% if file_desc.title %}
                            <span class="title">{{ file_desc.title }}</span>
                        {% endif %}
                        {% if file_desc.description %}
                            <span class="description">{{ file_desc.description }}</span>
                        {% endif %}
                        </div>
                        {% endwith %}
                    </div>
                        
                    <nav class="actions">
                        <a href="{{ exhibition.get_url_path }}gallery/file_{{ media_file.get_token }}/" data-toggle="tooltip" data-placement="top" data-original-title="{% trans "Edit" %}" class="edit icon icon-white icon-edit"></a>
                        <a href="{% cropping_url media_file.path "cover" request request.path %}" data-toggle="tooltip" data-placement="top" data-original-title="{% trans "Crop image" %}" class="crop icon icon-white icon-tool-crop"></a>
                    </nav>
                </li>        
            {% endfor %}
        </ul>
    </div>
</div>

<script type="text/javascript">
    $(window).load(function() {
        $('#photos').isotope({
            itemSelector : '.item',
            layoutMode : 'masonry',
            masonry: {
                columnWidth: 340
            }
        });
    });
</script>
{% endblock %}
