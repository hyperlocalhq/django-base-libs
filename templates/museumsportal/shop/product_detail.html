{% extends "base.html" %}
{% load url from future %}
{% load i18n image_modifications base_tags tagging_tags favorites auth_extended babel %}
{% block title %}{% trans "Shop" %} – {{ object.title }} – {% endblock %}
{% block bodyclass %}shop-product-detail shop-product-list no-transition{% endblock %}

{% block open_graph %}
    <meta property="og:title" content="{{ object.title }}" />
    <meta property="og:type" content="article" />
    {% if object.image %}
      <meta property="og:image" content="{{ current_website_url }}{{ MEDIA_URL }}{{ object.image|modified_path:"og" }}" />
    {% else %}
      <meta property="og:image" content="{{ current_website_url }}{{ STATIC_URL }}site/img/museumsportal_opengraph.png" />
    {% endif %}
    <meta property="og:url" content="{{ object.get_url }}" />
    <meta property="og:site_name" content="Museumsportal Berlin" />
    <meta property="og:description" content="{{ object.get_rendered_description|striptags|truncatewords:20|escape }}" />
{% endblock %}

{% block js %}
  <script type="text/javascript" src="{{ STATIC_URL }}site/js/share.js" defer="defer"></script>
{% endblock %}

{% block content %}
    <div class="container clearfix">
        <div class="row">
			      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				        <h1>{{ object.title }}</h1>
                <h2>{{ object.subtitle }}</h2>
                <div class="tools">
                    <button class="btn btn-default btn-round share-twitter"  data-url="{{ object.get_url }}" data-text="{{ object.title }}{% if object.subtitle %} / {{ object.subtitle }}{% endif %}">
                        <span class="icon icon-social-twitter"></span>
                        <span class="sr-only">{% trans "Share on Twitter" %}</span>
                    </button>
                    <button class="btn btn-default btn-round share-facebook" data-url="{{ object.get_url }}" data-text="{{ object.title }}{% if object.subtitle %} / {{ object.subtitle }}{% endif %}">
                        <span class="icon icon-social-facebook"></span>
                        <span class="sr-only">{% trans "Share on Facebook" %}</span>
                    </button>
                </div>
			      </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-5 col-md-4 col-lg-4">
                <a href="{{ object.link }}" target="_blank">
                    <span class="img hidden-xs"><img src="{{ STATIC_URL }}site/img/placeholder_editorial.gif" alt="{{ object.title }}"  data-original="{{ MEDIA_URL }}{{ object.image }}" /></span>
                    <span class="img visible-xs"><img src="{{ STATIC_URL }}site/img/placeholder_editorial.gif" alt="{{ object.title }}"  data-original="{{ MEDIA_URL }}{{ object.image|modified_path:"editorial" }}" /></span>
                </a>
            </div>
            <div class="col-xs-12 col-sm-7 col-md-8 col-lg-8">
                <div class="clearfix">
                    <p>{{ object.get_rendered_description }}</p>
                    {% if object.price %}
                        <div class="clearfix"><div class="price">{{ object.price|currencyfmt:"€" }}</div></div>
                    {% endif %}
                    {% if object.get_related_museums %}
                        <h3>{% trans "Related museums" %}</h3>
                        <ul>
                            {% for museum in object.get_related_museums %}
                                <li><a href="{{ museum.get_url_path }}">{{ museum.title }}</a></li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if object.get_related_exhibitions %}
                        <h3>{% trans "Related exhibitions" %}</h3>
                        <ul>
                            {% for exhibition in object.get_related_exhibitions %}
                                <li><a href="{{ exhibition.get_url_path }}">{{ exhibition.title }}</a></li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if object.get_related_events %}
                        <h3>{% trans "Related events" %}</h3>
                        <ul>
                            {% for event in object.get_related_events %}
                                <li><a href="{{ event.get_url_path }}">{{ event.title }}</a></li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if object.get_related_workshops %}
                        <h3>{% trans "Related guided tours" %}</h3>
                        <ul>
                            {% for workshop in object.get_related_workshops %}
                                <li><a href="{{ workshop.get_url_path }}">{{ workshop.title }}</a></li>
                            {% endfor %}
                        </ul>
                    {% endif %}

                    <a class="btn btn-default btn-sm pull-right" href="{{ object.link }}" target="_blank">{% trans "to shop" %}</a>
                </div>
            </div>
        </div>
    </div>
    {% include "utils/page_controls.html" %}

    {% if object.get_similar_published_products %}
        <div id="list">
            <div class="container">
                <h2>{% trans "Similar products" %}</h2>
                <div id="container">
                    <div class="row row-md grid">
                        {% for product in object.get_similar_published_products|slice:':4' %}
                            <div class="item col-xs-12 col-sm-4 col-md-4 col-lg-3{% if forloop.counter == 4 %} hidden-sm hidden-md{% endif %}">
                                <a href="{{ product.get_url_path }}">
                                    {% if product.image %}
                                        <span class="img"><img src="{{ STATIC_URL }}site/img/placeholder_list.gif" data-original="{{ MEDIA_URL }}{{ product.image|modified_path:"editorial" }}" alt="product.title" /></span>
                                    {% endif %}
                                    {% if product.price %}
                                        <span class="price pull-right">{{ product.price|currencyfmt:"€" }}</span>
                                    {% endif %}
                                    <h3>
                                        {{ product.title }}
                                    </h3>
                                    {% if product.subtitle %}
                                        <h4>{{ product.subtitle }}</h4>
                                    {% endif %}
                                </a>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}