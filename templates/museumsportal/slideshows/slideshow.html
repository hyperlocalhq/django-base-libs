{% load image_modifications %}

<div id="stage" class="clearfix">
    {% for slide in slides %}
        <div class="slide">
            {% if slide.link %}<a href="{{ slide.link }}">{% endif %}
              
                <img src="{{ UPLOADS_URL }}{{ slide.path|modified_path:"slideshow" }}" alt="{{ slide.alt }}" width="640" height="260" />
             	
                <table class="wrap{% if slide.highlight %} highlight{% endif %}">
                    <tr>
                        <td>
                            <div class="h3">{{ slide.get_rendered_title }}</div>
                            <div class="h4">{{ slide.get_rendered_subtitle }}</div>
                        </td>
                    </tr>
                </table>	
            {% if slide.link %}</a>{% endif %}
        </div>
    {% endfor %}
    <div class="controls">
        <a id="prev" href="#">&nbsp;</a>
        <a id="next" href="#">&nbsp;</a>
    </div>
	<ul id="nav"></ul>
</div>

<script type="text/javascript">
    (function($, undefined) {
        function pagerFactory(idx, slide) {
            var s = idx > 2 ? ' ' : '';
            return '<li'+s+'><a href="#">'+(idx+1)+'</a></li>';
        };
    
        $(function() {
            $('#stage').cycle({
                fx:                 'fade',
                speed:              400,
                timeout:            4000,
                pager:              '#nav',
                slideExpr:          '.slide',
                next:               '#next', 
                prev:               '#prev',
                easing:             'easeInOutSine',
                pagerAnchorBuilder: pagerFactory
            });
        });
    }(jQuery));
</script>