{% extends "base.html" %}{% load i18n base_tags image_modifications tagging_tags favorites %}{% block js %}    {{ block.super }}    <script type="text/javascript" src="{{ STATIC_URL }}site/js/favorites.js" defer="defer"></script>{% endblock %}{% block title %}{% trans "Favorites" %}{% endblock %}{% block content %}    <div class="content clearfix">        <div class="inner">            <h1>{% trans "Favorites" %}</h1>            {% if object_list %}                <ul id="container" class="list tiles clearfix">                    {% for favorite_object in object_list %}                        {# MUSEUM #}                        {% if favorite_object.content_type.app_label == "museums" and favorite_object.content_type.model == "museum" %}                            {% with favorite_object.content_object as museum %}                                {% tags_for_object museum as tags %}                                <li class="item initial_{{ museum.title|slugify|slice:"0:1" }}{% for cat in museum.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}">                                                                        {% if museum.cover_image %}                                        <a class="img" href="{{ museum.get_url_path }}"  data-background="{{ MEDIA_URL }}{{ museum.cover_image }}">                                            <span class="spinner loading"></span>                                            <span class="overlay"></span>                                        </a>                                    {% endif %}                                                    <nav class="actions">                                        {% if request.user.is_authenticated %}                                            {% adding2favorites for museum %}                                        {% endif %}                                        <button href="#" rel="tooltip" data-placement="top" data-original-title="Show location on map" class="marker-link show-location"></button>                                    </nav>                                                                        <a href="{{ museum.get_url_path }}">                                         <h3>{{ museum.title }}</h3>                                        {% if museum.subtitle %}                                            <h4>{{ museum.subtitle }}</h4>                                        {% endif %}                                    </a>                                                                        {% if museum.latitude %}                                        <script type="text/javascript">                                        //<![CDATA[                                        (function(undefined) {                                            var iIndex = aGeopositions.length;                                            aGeopositions[iIndex] = {                                                latitude: {{ museum.latitude }},                                                longitude: {{ museum.longitude }},                                                categories: "initial_{{ museum.title|slugify|slice:"0:1" }}{% for cat in museum.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}",                                                content:                                                '{% if museum.cover_image %}<span class="img" style="background-image: url({{ UPLOADS_URL }}{{ museum.cover_image.path }})"></span>{% endif %}'                                                + '<a href="{{ museum.get_url_path }}">{{ museum.title }} <span>{% trans "more" %}â€¦</span></a>'                                            }                                        }());                                        //]]>                                        </script>                                     {% endif %}                                </li>                            {% endwith %}                        {% endif %}                                                {# EXHIBITION #}                        {% if favorite_object.content_type.app_label == "exhibitions" and favorite_object.content_type.model == "exhibition" %}                            {% with favorite_object.content_object as exhibition %}                                {% tags_for_object exhibition as tags %}                                <li class="item {% cycle "class1" "class2" "class3" %} initial_{{ exhibition.title|slugify|slice:"0:1" }} {% if exhibition.closing_soon %} closing_soon{% endif %}{% if exhibition.newly_opened %} newly_opened{% endif %}{% for cat in exhibition.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}" style="cursor: pointer">                                    {% if exhibition.cover_image %}                                        <a class="img" href="{{ exhibition.get_url_path }}" data-background="{{ MEDIA_URL }}{{ exhibition.cover_image|modified_path:"exhibition_list" }}">                                            <span class="spinner loading"></span>                                            <span class="overlay"></span>                                        </a>                                    {% else %}                                        <a class="img" href="{{ exhibition.get_url_path }}"  {% if exhibition.museum.cover_image %}data-background="{{ MEDIA_URL }}{{ exhibition.museum.cover_image|modified_path:"exhibition_list" }}">                                            <span class="spinner loading"></span>                                            <span class="overlay"></span>                                        </a>                                    {% endif %}{% endif %}                                                        <nav class="actions">                                        {% if request.user.is_authenticated %}                                            {% adding2favorites for exhibition %}                                        {% endif %}                                        <button href="#" rel="tooltip" data-placement="top" data-original-title="Show location on map" class="marker-link show-location"></button>                                    </nav>                                                        <a href="{{ exhibition.get_url_path }}">                                      <h3>{{ exhibition.museum.title }}</h3>                                      <h4>{{ exhibition.title }}</h4>                                      <h5><span class="from_date">{{ exhibition.start|date:"d.m.Y" }}</span> {% trans "till" %} {{ exhibition.end|date:"d.m.Y" }}</h5>                                    </a>                                                            <div class="description">                                        <p>{{ exhibition.get_rendered_description|striptags }}</p>                                        <a class="more" href="{{ exhibition.get_url_path }}">more</a>                                    </div>                                                                        {% with exhibition.museum as museum %}                                      {% if museum.latitude %}                                          <script type="text/javascript">                                          //<![CDATA[                                          (function(undefined) {                                              var iIndex = aGeopositions.length;                                              aGeopositions[iIndex] = {                                                  latitude: {{ museum.latitude }},                                                  longitude: {{ museum.longitude }},                                                  categories: "initial_{{ exhibition.title|slugify|slice:"0:1" }}{% if exhibition.closing_soon %} closing_soon{% endif %}{% if exhibition.newly_opened %} newly_opened{% endif %}{% for cat in exhibition.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}",                                                  content:                                                   '{% if museum.cover_image %}<span class="img" style="background-image: url({{ UPLOADS_URL }}{{ museum.cover_image.path }})"></span>{% endif %}'                                                  + '<h3>{{ exhibition.title }}</h3>'                                                  + '<h4>{{ museum.title }}</h4>'                                                  + '<h5>{{ museum.street_address }} {{ museum.street_address2 }}</h5>'                                                  + '<a class="btn btn-primary small" href="{{ exhibition.get_url_path }}">{% trans "more" %}</a>'                                              }                                          }());                                          //]]>                                          </script>                                      {% endif %}                                    {% endwith %}                                </li>                            {% endwith %}                        {% endif %}                        {# EVENT #}                        {% if favorite_object.content_type.app_label == "events" and favorite_object.content_type.model == "event" %}                            {% with favorite_object.content_object as event %}                                {% tags_for_object event as tags %}                                <li class="item initial_{{ event.title|slugify|slice:"0:1" }} {% if event.closing_soon %} closing_soon{% endif %}{% if event.newly_opened %} newly_opened{% endif %}{% for cat in event.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}">                                    <a class="img" href="{{ event.get_url_path }}"                                      {% if event.cover_image %}data-background="{{ MEDIA_URL }}{{ event.cover_image|modified_path:"event_list" }}"{% else %}                                    {% if event.museum.cover_image %}data-background="{{ MEDIA_URL }}{{ event.museum.cover_image|modified_path:"event_list" }}"{% endif %}{% endif %}>                                        <span class="spinner loading"></span>                                        <span class="overlay"></span>                                    </a>                                                    <nav class="actions">                                        {% if request.user.is_authenticated %}                                            {% adding2favorites for event %}                                        {% endif %}                                        <button href="#" rel="tooltip" data-placement="top" data-original-title="Show location on map" class="marker-link show-location"></button>                                    </nav>                                                            <a href="{{ event.get_url_path }}">                                        <h3>{{ event.museum.title }}</h3>                                        <h4>{{ event.title }}</h4>                                        {% with event.eventtime_set.all.0 as event_time %}                                            <h5>{{ event_time.event_date|date:"j. F Y" }} {{ event_time.start|date:"H:i" }}</h5>                                        {% endwith %}                                    </a>                                                            {% with event.museum as museum %}                                        {% if museum.latitude %}                                            <script type="text/javascript">                                            //<![CDATA[                                            (function(undefined) {                                                var iIndex = aGeopositions.length;                                                aGeopositions[iIndex] = {                                                    latitude: {{ museum.latitude }},                                                    longitude: {{ museum.longitude }},                                                    categories: "initial_{{ event.title|slugify|slice:"0:1" }}{% if event.closing_soon %} closing_soon{% endif %}{% if event.newly_opened %} newly_opened{% endif %}{% for cat in event.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}",                                                    content:                                                     '{% if museum.cover_image %}<span class="img" style="background-image: url({{ UPLOADS_URL }}{{ museum.cover_image.path }})"></span>{% endif %}'                                                    + '<h3>{{ event.title }}</h3>'                                                    + '<h4>{{ museum.title }}</h4>'                                                    + '<h5>{{ museum.street_address }} {{ museum.street_address2 }}</h5>'                                                    + '<a class="btn btn-primary small" href="{{ event.get_url_path }}">{% trans "more" %}</a>'                                                }                                            }());                                            //]]>                                            </script>                                        {% endif %}                                    {% endwith %}                                </li>                            {% endwith %}                        {% endif %}                                                {# WORKSHOP #}                        {% if favorite_object.content_type.app_label == "workshops" and favorite_object.content_type.model == "workshop" %}                            {% with favorite_object.content_object as workshop %}                                {% tags_for_object workshop as tags %}                                <li class="item {% cycle "class1" "class2" "class3" %} initial_{{ workshop.title|slugify|slice:"0:1" }} {% if workshop.closing_soon %} closing_soon{% endif %}{% if workshop.newly_opened %} newly_opened{% endif %}{% for cat in workshop.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}" style="cursor: pointer">                                                                        <a class="img" href="{{ workshop.get_url_path }}"                                     {% if workshop.cover_image %}data-background="{{ MEDIA_URL }}{{ workshop.cover_image|modified_path:"workshop_list" }}"{% else %}                                    {% if workshop.museum.cover_image %}data-background="{{ MEDIA_URL }}{{ workshop.museum.cover_image|modified_path:"workshop_list" }}"{% endif %}{% endif %}>                                        <span class="spinner loading"></span>                                        <span class="overlay"></span>                                    </a>                                                        <nav class="actions">                                        {% if request.user.is_authenticated %}                                            {% adding2favorites for workshop %}                                        {% endif %}                                        <button href="#" rel="tooltip" data-placement="top" data-original-title="Show location on map" class="marker-link show-location"></button>                                    </nav>                                                            <a href="{{ workshop.get_url_path }}">                                        <h3>{{ workshop.museum.title }}</h3>                                        <h4>{{ workshop.title }}</h4>                                        {% with workshop.workshoptime_set.all.0 as workshop_time %}                                            <h5>{{ workshop_time.workshop_date|date:"j. F Y" }} {{ workshop_time.start|date:"H:i" }}</h5>                                        {% endwith %}                                    </a>                                                            <div class="description">                                        <p>{{ workshop.get_rendered_description|striptags }}</p>                                        <a class="more" href="{{ workshop.get_url_path }}">more</a>                                    </div>                                                                        {% with workshop.museum as museum %}                                        {% if museum.latitude %}                                            <script type="text/javascript">                                            //<![CDATA[                                            (function(undefined) {                                                var iIndex = aGeopositions.length;                                                aGeopositions[iIndex] = {                                                latitude: {{ museum.latitude }},                                                longitude: {{ museum.longitude }},                                                categories: "initial_{{ workshop.title|slugify|slice:"0:1" }}{% if workshop.closing_soon %} closing_soon{% endif %}{% if workshop.newly_opened %} newly_opened{% endif %}{% for cat in workshop.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}",                                                content:                                                 '{% if museum.cover_image %}<span class="img" style="background-image: url({{ UPLOADS_URL }}{{ museum.cover_image.path }})"></span>{% endif %}'                                                + '<h3>{{ workshop.title }}</h3>'                                                + '<h4>{{ museum.title }}</h4>'                                                + '<h5>{{ museum.street_address }} {{ museum.street_address2 }}</h5>'                                                + '<a class="btn btn-primary small" href="{{ workshop.get_url_path }}">{% trans "more" %}</a>'                                                }                                            }());                                            //]]>                                            </script>                                        {% endif %}                                    {% endwith %}                                </li>                            {% endwith %}                        {% endif %}                                            {% endfor %}                </ul>            {% else %}                <p>{% trans "You have no favorites." %}</p>            {% endif %}        </div>    </div>{% endblock %}