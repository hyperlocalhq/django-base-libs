{% extends "base.html" %}{% load i18n base_tags image_modifications tagging_tags favorites %}{% block js %}    {{ block.super }}    <script type="text/javascript" src="{{ STATIC_URL }}site/js/favorites.js" defer="defer"></script>    <script type="text/javascript">        $(function() {            $('.favorite').click(function() {                $(this).closest('.item').addClass('delete');            });        });    </script>{% endblock %}{% block title %}{% trans "Favorites" %}{% endblock %}{% block content %}    <div id="favorites" class="content clearfix">        <div class="inner">            <h1>{% trans "Favorites" %}</h1>            {% regroup object_list by content_type as favorites_by_content_type %}            {% for content_type in favorites_by_content_type %}                {% if content_type.grouper.app_label == "museums" and content_type.grouper.model == "museum" %}                        <h3>{% trans "Museums" %}</h3>                        <ul class="list rows collapsed clearfix">                            {% for favorite_object in content_type.list %}                                {% with favorite_object.content_object as museum %}                                    {% tags_for_object museum as tags %}                                    <li class="item initial_{{ museum.title|slugify|slice:"0:1" }}{% for cat in museum.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}">                                                                                <a href="{{ museum.get_url_path }}">                                             <h3>{{ museum.title }}</h3>                                            {% if museum.subtitle %}                                                <h4>{{ museum.subtitle }}</h4>                                            {% endif %}                                        </a>                                                            <nav class="actions">                                            {% if request.user.is_authenticated %}                                                {% adding2favorites for museum %}                                            {% endif %}                                        </nav>                                    </li>                                {% endwith %}                            {% endfor %}                        </ul>                {% endif %}                {% if content_type.grouper.app_label == "exhibitions" and content_type.grouper.model == "exhibition" %}                        <h3>{% trans "Exhibitions" %}</h3>                        <ul class="list rows clearfix">                            {% for favorite_object in content_type.list %}                                {% with favorite_object.content_object as exhibition %}                                    {% tags_for_object exhibition as tags %}                                    <li class="item {% cycle "class1" "class2" "class3" %} initial_{{ exhibition.title|slugify|slice:"0:1" }} {% if exhibition.closing_soon %} closing_soon{% endif %}{% if exhibition.newly_opened %} newly_opened{% endif %}{% for cat in exhibition.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}">                                                                <a href="{{ exhibition.get_url_path }}">                                            <h4><span class="from_date">{{ exhibition.start|date:"d.m.Y" }}</span> {% trans "till" %} {{ exhibition.end|date:"d.m.Y" }} </h4>                                            <h3>{{ exhibition.title }}</h3>                                            <h4>{{ exhibition.subtitle }}</h4>                                            <h5>{{ exhibition.museum.title }}</h5>                                        </a>                                            <nav class="actions">                                            {% if request.user.is_authenticated %}                                                {% adding2favorites for exhibition %}                                            {% endif %}                                        </nav>                                    </li>                                {% endwith %}                            {% endfor %}                        </ul>                {% endif %}                {% if content_type.grouper.app_label == "events" and content_type.grouper.model == "event" %}                        <h3>{% trans "Events" %}</h3>                        <ul class="list rows clearfix">                            {% for favorite_object in content_type.list %}                                {% with favorite_object.content_object as event %}                                    {% tags_for_object event as tags %}                                    <li class="item initial_{{ event.title|slugify|slice:"0:1" }} {% if event.closing_soon %} closing_soon{% endif %}{% if event.newly_opened %} newly_opened{% endif %}{% for cat in event.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}">                                                                                        <a href="{{ event.get_url_path }}">                                            <h4>{% with event.get_closest_event_time as event_time %}{{ event_time.event_date|date:"j. F Y" }}{{ event_time.start|time:"H:i" }}{% endwith %}</h4>                                            <h3>{{ event.title }}</h3>                                            <h4>{{ event.subtitle }}</h4>                                            <h5>{{ event.museum.title }}</h5>                                        </a>                                            <nav class="actions">                                            {% if request.user.is_authenticated %}                                                {% adding2favorites for event %}                                            {% endif %}                                        </nav>                                    </li>                                {% endwith %}                            {% endfor %}                        </ul>                {% endif %}                {% if content_type.grouper.app_label == "workshops" and content_type.grouper.model == "workshop" %}                        <h3>{% trans "Guided Tours, Workshops and educational offers" %}</h3>                        <ul class="list rows clearfix">                            {% for favorite_object in content_type.list %}                                {% with favorite_object.content_object as workshop %}                                    {% tags_for_object workshop as tags %}                                    <li class="item {% cycle "class1" "class2" "class3" %} initial_{{ workshop.title|slugify|slice:"0:1" }} {% if workshop.closing_soon %} closing_soon{% endif %}{% if workshop.newly_opened %} newly_opened{% endif %}{% for cat in workshop.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}">                                        <a href="{{ workshop.get_url_path }}">                                            <h4>{{ workshop.workshop_type }} {% with workshop.get_closest_workshop_time as workshop_time %}{{ workshop_time.workshop_date|date:"j. F Y" }}{{ workshop_time.start|time:"H:i" }}{% endwith %}</h4>                                            <h3>{{ workshop.title }}</h3>                                            <h4>{{ workshop.subtitle }}</h4>                                            <h5>{{ workshop.museum.title }}</h5>                                        </a>                                                                <nav class="actions">                                            {% if request.user.is_authenticated %}                                                {% adding2favorites for workshop %}                                            {% endif %}                                        </nav>                                    </li>                                {% endwith %}                            {% endfor %}                        </ul>                {% endif %}            {% endfor %}                    </div>    </div>{% endblock %}