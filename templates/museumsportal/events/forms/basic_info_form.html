{% extends "events/forms/base.html" %}
{% load crispy_forms_tags %}

{% block stylesheet %}
    {{ block.super }}
    <link href="{{ jetson_media_url }}js/jquery/autocomplete_1.0/jquery.autocomplete.css" rel="stylesheet" />
    <link href="{{ STATIC_URL }}site/css/jquery.tagsinput.css" rel="stylesheet" />
{% endblock %}

{% block js %}
    {{ block.super }}
    <script src="{{ jetson_media_url }}js/jquery/autocomplete_1.0/jquery.bgiframe.min.js"></script>
    <script src="{{ jetson_media_url }}js/jquery/autocomplete_1.0/jquery.autocomplete.js"></script>
    <script src="{{ jetson_media_url }}js/admin/autocomplete.js"></script>
    <script src="{{ STATIC_URL }}site/js/jquery.tagsinput.js"></script>
{% endblock %}

{% block bodyclass %}map_visible{% endblock %}

{% block multistep_form %}
    {% crispy form %}
    <script src="http://maps.google.com/maps/api/js?sensor=false&amp;language={{ LANGUAGE_CODE }}&amp;region=DE"></script>
    <script src="{{ STATIC_URL }}site/js/gmaps_for_address.js"></script>
    <script>
        $(function() {
            $('.dateinput').datepicker({
                format: 'yyyy-mm-dd',
                weekStart: 1
            })
            $('.timeinput').timepicker();
            $('#id_tags').tagsInput();
            $('[name="location"]').click(function() {
                if ($(this).val() != "another") {
                    $.get('/helper/museum_attrs/' + $(this).val() + '/', function(data) {
                        $('#id_location_name').val(data['title']).addClass("noneditable");
                        $('#id_street_address').val(data['street_address']).addClass("noneditable");
                        $('#id_street_address2').val(data['street_address2']).addClass("noneditable");
                        $('#id_postal_code').val(data['postal_code']).addClass("noneditable");
                        $('#id_city').val(data['city']).addClass("noneditable");
                        $('#id_latitude').val(data['latitude']).addClass("noneditable");
                        $('#id_longitude').val(data['longitude']).addClass("noneditable");
                        $('#dyn_locate_geo').click();
                    }, 'json');
                } else {
                    $('#id_location_name').val("").removeClass("noneditable");
                    $('#id_street_address').val("").removeClass("noneditable");
                    $('#id_street_address2').val("").removeClass("noneditable");
                    $('#id_postal_code').val("").removeClass("noneditable");
                    $('#id_city').val("").removeClass("noneditable");
                    GMapManager.removeGeoPos();
                }
            });
            if (!$('[name="location"]:checked').val()) {
                $('[name="location"]:first').click();
            }
        });
    </script>
{% endblock %}
