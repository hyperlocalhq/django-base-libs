{% extends "base.html" %}
{% load url from future %}
{% load i18n image_modifications base_tags tagging_tags favorites auth_extended infoblocks %}
{% block title %}{% trans "Events" %} â€“ {% endblock %}
{% block bodyclass %}event-list{% endblock %}

{% block js %}
<script type="text/javascript" src="{{ STATIC_URL }}site/js/GetSet.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}site/js/list.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}site/js/favorites.js" defer="defer"></script>
<script type="text/javascript">
var aGeopositions = [];
var str_filter_selection = "{% trans "Filter selection" %}";
</script>
{% endblock %}

{% block content %}
  <div class="content">
    <div class="container">
      <header class="list-header clearfix">
        <h4 class="visible-xs">{% trans "Events in the Museums of Berlin" %}</h4>

        <div class="list-controls">
          <a class="btn btn-info pull-right" href="{% url "event_list_map" %}">{% trans "Show map" %}</a>
          <div class="btn-group pull-left" style="margin-right: 15px;">
            <button id="toggle-list-filter" class="btn btn-info"  data-parent="#list-filter" data-toggle="collapse" data-target="#list-filter">{% trans "filter" %}</button>
            <button id="filter-reset" type="button" class="filter-reset btn btn-info">{% trans "Reset" %}</button>
          </div>
          <ul id="filter-summary" class="pull-left">
            {% if facets.selected.abc or facets.selected.category or facets.selected.suitable_for_children or facets.selected.free_admission or facets.selected.calendar %}
              <li><b>{% trans "Filter selection" %}:</b></li>
              {% if facets.selected.abc %}<li data-param="abc" data-value="{{ facets.selected.abc }}"><a href="{% append_to_get abc="" %}">{{ facets.selected.abc }}</a></li>{% endif %}
              {% if facets.selected.category %}<li data-param="category" data-value="{{ facets.selected.category.slug }}"><a href="{% append_to_get category="" %}">{{ facets.selected.category.title }}</a></li>{% endif %}
              {% if facets.selected.suitable_for_children %}<li data-param="suitable_for_children" data-value="1"><a href="{% append_to_get suitable_for_children="" %}">{% trans "Suitable for children" %}</a></li>{% endif %}
              {% if facets.selected.free_admission %}<li data-param="free_admission" data-value="1"><a href="{% append_to_get free_admission="" %}">{% trans "Free admission" %}</a></li>{% endif %}
              {% if facets.selected.calendar %}<li data-param="calendar" data-value="{{ facets.selected.calendar.0 }}"><a href="{% append_to_get calendar="" %}">{{ facets.selected.calendar.1 }}</a></li>{% endif %}
            {% endif %}
          </ul>
        </div>
      </header>
    </div>

    <div id="list-filter" class="collapse">
      <div>
        <div class="container relative">
          <button class="cancel btn btn-info btn-lg btn-icon"  data-parent="#list-filter" data-toggle="collapse" data-target="#list-filter">
            <span class="icon icon-remove"></span>
            <span class="sr-only">{% trans "close" %}</span>
          </button>
          {% include "utils/filter_events.html" %}
        </div>
      </div>
    </div>

    <div id="list">
      <div class="container">
    
      <div id="notices" class="hidden-xs">
        <h6 class="block-label">{% trans "Editors Recommendations" %}</h6>
        <div class="row row-sm">
          <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3">{% infoblock "event_notice_1" %}</div>
          <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3">{% infoblock "event_notice_2" %}</div>
          <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3 hidden-xs">{% infoblock "event_notice_3" %}</div>
          <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3 hidden-sm hidden-xs">{% infoblock "event_notice_4" %}</div>
        </div>
      </div>

      <div id="container">
        <div class="row row-md list isotope">
          {% if page == 1 %}
            <div class="item col-xs-12 col-sm-12 col-md-12 col-lg-12 hidden-xs">
              {% load advertising_tags %}
              {% random_zone_ad 'events' %}
            </div>
          {% endif %}
          {% if object_list %}
            {% for event in object_list %}
              {% tags_for_object event as tags %}
              <div class="item col-xs-12 col-sm-12 col-md-12 col-lg-12" data-filter-categories="initial_{{ event.title|slugify|slice:"0:1" }}{% for cat in event.categories.all %} cat_{{ cat.title|slugify }}{% endfor %}{% if tags %}{% for tag in tags %} tag_{{ tag.slug }}{% endfor %}{% endif %}{% if event.suitable_for_children %} is_for_children{% endif %}{% if event.free_admission %} is_free_admission{% endif %}{% if event.is_today %} is_today{% endif %}{% if event.is_tomorrow %} is_tomorrow{% endif %}{% if event.is_within_7_days %} is_within_7_days{% endif %}{% if event.is_within_30_days %} is_within_30_days{% endif %}" data-description-src="{{ event.get_url_path }}ajax/">
                <a href="{{ event.get_url_path }}">
                  <h4>
                    {% for cat in event.categories.all %}{{ cat.title }}{% if not forloop.last %}, {% else %}: {% endif %}{% endfor %}
                    {% with event.get_closest_event_time as event_time %}{{ event_time.event_date|date:"j. F Y" }} {{ event_time.start|time:"H:i" }}{% if LANGUAGE_CODE == "de" %} Uhr{% endif %}{% endwith %}
                  </h4>
                  <h3>{{ event.title }}</h3>
                  <h4>{{ event.subtitle }}</h4>
                  {% if event.location_name %}
                  <h5>{{ event.location_name }}</h5>
                  {% else %}
                  <h5>{{ event.museum.title }}</h5>
                  {% endif %}
                </a>
                <div class="description"></div>
              </div>
            {% endfor %}
            {% include "utils/pagination.html" %}
          {% else %}
            {% include "utils/container_empty.html" %}
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
