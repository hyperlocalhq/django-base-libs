{% extends "base.html" %}
{% load base_tags i18n image_modifications tagging_tags babel auth_extended fb_tags infoblocks favorites %}
{% block title %}{% trans "Museum" %} – {{ object.title }} – {% endblock %}
{% block bodyclass %}museum-detail{% endblock %}

{% block open_graph %}
    <meta property="og:title" content="{{ object.title }}" />
    <meta property="og:type" content="article" />
    {% if object.cover_image %}
      <meta property="og:image" content="http://{{ request.get_host }}{{ MEDIA_URL }}{{ object.cover_image|modified_path:"og" }}" />
    {% else %}
      <meta property="og:image" content="http://{{ request.get_host }}{{ STATIC_URL }}site/img/logo/museumsportal-og.jpg" />
    {% endif %}
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="600" />
    <meta property="og:image:height" content="600" />
    <meta property="og:description" content="{{ object.get_rendered_description|striptags|truncatewords:20|escape }}" />
{% endblock %}

{% block stylesheet %}
{{ block.super }}
<link href="{{ STATIC_URL }}site/css/jquery.selectbox.css" rel="stylesheet" media="screen" type="text/css" />
{% endblock %}

{% block js %}
  <script type="text/javascript" src="{{ STATIC_URL }}site/js/share.js" defer="defer"></script>
  <script type="text/javascript" src="{{ STATIC_URL }}site/js/favorites.js" defer="defer"></script>
  <script type="text/javascript" src="{{ STATIC_URL }}site/js/twitter.js"></script>
  <script type="text/javascript">
  var aGeopositions = [];
  $(document).ready(function(){
    $(".toggle_bvg").click(function () {
      $("#bvg_widget").toggleClass("on");
      return false;
    });
  });
  </script>

  <script src="{{ STATIC_URL }}site/js/jquery.selectbox-0.2.min.js"></script>
{% endblock %}

{% block map %}
{# {% include "utils/gmap.html" %} #}
{% endblock %}

{% block content %}
  {% with object as museum %}
    <div id="museum" class="content">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
            <article>
              <header>
                <h1>{{ museum.title }}
                {% if_has_perm "museums.change_museum" object %}
                  {% if not request.is_mobile %}
                    <span class="cms_edit"><a class="icon icon-pencil" data-toggle="tooltip" data-placement="bottom" data-original-title="{% trans "Edit" %}" href="{{ request.path }}change/">&nbsp;<span class="sr-only">{% trans "Edit" %}</span></a></span>
                  {% endif %}
                {% end_if_has_perm %}
                </h1>
                {% if museum.subtitle %}
                  <h2>{{ museum.subtitle }}</h2>
                {% endif %}

                {% comment %}
                <a href="{{ exhibition.museum.get_url_path }}"><h3>
                  {% if museum.parent %}
                    {{ museum.parent.street_address }}
                  {% else %}
                    {{ museum.street_address }}
                  {% endif %}
                </h3></a>
                {% endcomment %}
              </header>

              <!-- ======= Tools ======= -->

              <div class="tools clearfix">

                {% if request.user.is_authenticated %}
                  {% adding2favorites for museum using "favorites/includes/favorite_detail.html" %}
                {% endif %}

                <a class="btn btn-default btn-round location" href="{% url "museum_list_map" %}#object_id={{ museum.pk }}">
                  <span class="icon icon-location"></span>
                  <span class="sr-only">{% trans "Show location on map" %}</span>
                </a>

                <button class="btn btn-default btn-round share-twitter" data-toggle="tooltip" data-placement="top" data-original-title="{% trans "Share on Twitter" %}"  data-url="{{ object.get_url }}" data-text="{{ museum.title }}">
                  <span class="icon icon-social-twitter"></span>
                  <span class="sr-only">{% trans "Share on Twitter" %}</span>
                </button>

                <button class="btn btn-default btn-round share-facebook" data-toggle="tooltip" data-placement="top" data-original-title="{% trans "Share on Facebook" %}" data-url="{{ object.get_url }}" data-text="{{ museum.title }}">
                  <span class="icon icon-social-facebook"></span>
                  <span class="sr-only">{% trans "Share on Facebook" %}</span>
                </button>

                {% comment %}
                {% if museum.participates_in_berlinartweek %}
                  <a target="_blank" class="pull-right" href="http://www.berlinartweek.de/{% if LANGUAGE_CODE == "de" %}de{% else %}en{% endif %}/berlin-art-week.html">
                    <img src="{{ STATIC_URL }}site/img/berlin-art-week-banner.jpg" alt="Berlin Art Week" height="40" />
                  </a>
                {% elif museum.participates_in_langenacht %}
                  <a target="_blank" class="pull-right" href="http://www.lange-nacht-der-museen.de/{% if LANGUAGE_CODE == "de" %}de/museen/{% else %}en/museums/{% endif %}{{ museum.slug }}/">
                    <img src="{{ STATIC_URL }}site/img/langenacht-banner.png" alt="Lange Nacht der Museen" height="40" />
                  </a>
                {% endif %}
                {% endcomment %}
                {% if museum.participates_in_emop %}
                  <a target="_blank" class="pull-right" href="http://www.emop-berlin.eu/{% if LANGUAGE_CODE == "de" %}de/{% else %}en/{% endif %}">
                    <img src="{{ STATIC_URL }}site/img/emop-banner.jpg" alt="EUROPEAN MONTH OF PHOTOGRAPHY BERLIN" height="40" />
                  </a>
                {% endif %}
              </div>


              {% if object.mediafile_set.count > 1 or object.get_twitter_username or object.get_published_exhibitions or object.get_published_events or object.get_published_workshops or object.get_related_products %}
              <div class="btn-group hidden-xs clearfix">
                {% if object.mediafile_set.count > 1 %}
                  <a class="btn btn-info btn-sm" href="#section-images">{% trans "Images" %}</a>
                {% endif %}
                {% if object.get_twitter_username %}
                  <a class="btn btn-info btn-sm" href="#section-tweets">{% trans "Current Tweets" %}</a>
                {% endif %}
                {% if object.get_published_exhibitions %}
                  <a class="btn btn-info btn-sm" href="#section-exhibitions">{% trans "Exhibitions" %}</a>
                {% endif %}
                {% if object.get_published_events %}
                  <a class="btn btn-info btn-sm" href="#section-events">{% trans "Events" %}</a>
                {% endif %}
                {% if object.get_published_workshops %}
                  <a class="btn btn-info btn-sm" href="#section-workshops">{% trans "Current Guided Tours, Workshops and educational offers" %}</a>
                {% endif %}
                {% if object.get_related_products %}
                  <a class="btn btn-info btn-sm" href="#section-related-products">{% trans "Products" %}</a>
                {% endif %}
              </div>
              {% endif %}

              {% include "utils/cover_image.html" %}


              <div class="lead">
                {{ museum.get_rendered_description|disarm_user_input }}
              </div>
            </article>
          </div>

          <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
            <div class="panel-group" id="details">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <a class="accordion-toggle" data-toggle="collapse" data-parent="#details" href="#collapse-location"> {% trans "Location" %}</a>
                </div>

                <div id="collapse-location" class="panel-collapse collapse in">
                  <div class="panel-body">
                    {% if museum.parent %}
                    <p>
                      <b>{{ museum.parent.title }}</b><br/>
                      {{ museum.parent.street_address }}<br/>
                      {% if museum.parent.street_address2 %}{{ museum.parent.street_address2 }}<br/>{% endif %}
                      {{ museum.parent.postal_code }} {{ museum.parent.city }}
                    </p>
                    {% else %}
                    <p>
                      <b>{{ museum.title }}</b><br/>
                      {{ museum.street_address }}<br/>
                      {% if museum.street_address2 %}
                        {{ museum.street_address2 }}<br/>
                      {% endif %}
                      {{ museum.postal_code }} {{ museum.city }}
                    </p>
                    {% endif %}

                      {% if museum.service_phone_number %}
                        <dl>
                          <dt>{% trans "Service Telephone" %}</dt>
                          <dd>+{{ museum.service_phone_country }} ({{ museum.service_phone_area }}) {{ museum.service_phone_number }}</dd>
                        </dl>
                      {% endif %}

                      {% if museum.phone_number %}
                        <dl>
                          <dt>{% trans "Telephone" %}</dt>
                          <dd>+{{ museum.phone_country }} ({{ museum.phone_area }}) {{ museum.phone_number }}</dd>
                        </dl>
                      {% endif %}

                      {% if museum.group_bookings_phone_number %}
                      <dl>
                        <dt>{% trans "Booking Telephone" %}</dt>
                        <dd>+{{ museum.group_bookings_phone_country }} ({{ museum.group_bookings_phone_area }}) {{ museum.group_bookings_phone_number }}</dd>
                      </dl>
                      {% endif %}


                      {% if museum.fax_number %}
                        <dl>
                          <dt>{% trans "Fax" %}</dt>
                          <dd>+{{ museum.fax_country }} ({{ museum.fax_area }}) {{ museum.fax_number }}</dd>
                        </dl>
                      {% endif %}

                      {% if museum.website %}
                        <dl>
                          <dt>{% trans "Website" %}</dt>
                          <dd><a class="crop" href="{{ museum.website }}">{{ museum.website|humanize_url:"25" }}</a></dd>
                        </dl>
                      {% endif %}

                      {% if museum.email %}
                      {% load site_specific_tags %}
                        <dl>
                          <dt>{% trans "Email" %}</dt>
                          <dd>{% encrypt_email museum.email 30 %}</dd>
                        </dl>
                      {% endif %}

                    {% if museum.socialmediachannel_set.count %}
                    <dl>
                      <dt>{% trans "Social Networks" %}</dt>
                      <dd>
                        {% for social in museum.socialmediachannel_set.all %}
                        <a target="_blank" href="{{ social.url }}">{{ social.channel_type }}</a>
                        {% if not forloop.last %}, {% endif %}
                        {% endfor %}
                      </dd>
                    </dl>
                    {% endif %}
                  </div>
                </div>
              </div>

              {% with museum as list_item %}
                {% include "utils/bvg.html" %}
              {% endwith %}

              <!-- ======= Opening hours ======= -->

              {% if museum.season_set.count or museum.specialopeningtime_set.count %}
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#details" href="#collapse-opening-times">
                      {% trans "Opening hours" %}
                    </a>
                  </div>

                  <div id="collapse-opening-times" class="panel-collapse collapse in">
                    <div class="panel-body">
                      {% if museum.season_set.count == 1 %}
                        {% with museum.season_set.all.0 as season %}
                            {% comment %}
                            <!--  <dl>
                              <dt>{{ season.title }}</dt>
                              <dd>{{ season.start|date:"j. F Y" }} - {{ season.end|date:"j. F Y" }}</dd>
                            </dl> -->
                            {% endcomment %}
                            {% if season.is_appointment_based %}
                            <dl>
                              <dt>{% trans "Based on appointment" %}</dt>
                            </dl>
                            {% else %}
                            {% regroup season.get_opening_hours by times as opening_hours %}
                              {% for same_hours in opening_hours %}
                                <dl>
                                  <dt>
                                    {% for day in same_hours.list %}{% if forloop.first %}{{ day.weekday }}{% endif %}{% if forloop.last %}{% if forloop.counter0 %}-{{ day.weekday }}{% endif %}{% endif %}{% endfor %}
                                  </dt>
                                  {% if same_hours.list.0.open %}
                                  <dd>
                                    {{ same_hours.list.0.open|time:"H:i" }}
                                    {% if same_hours.list.0.break_close %}
                                    - {{ same_hours.list.0.break_close|time:"H:i" }}
                                    / {{ same_hours.list.0.break_open|time:"H:i" }}
                                    - {{ same_hours.list.0.close|time:"H:i" }}
                                    {% else %}
                                    - {{ same_hours.list.0.close|time:"H:i" }}
                                    {% endif %}
                                    {% if LANGUAGE_CODE == "de" %} Uhr{% endif %}
                                  </dd>
                                  {% else %}
                                  <dd>
                                    {% trans "closed" %}
                                  </dd>
                                  {% endif %}
                                </dl>
                              {% endfor %}
                            {% endif %}
                            {% if season.last_entry %}
                            <dl>
                              <dt>{% trans "Last entry" %} </dt>
                                <dd>{{ season.last_entry }}</dd>
                            </dl>
                            {% endif %}
                            {% if season.exceptions %}
                            <p>{{ season.get_rendered_exceptions }}</p>
                            {% endif %}
                        {% endwith %}
                      {% else %}
                        <div id="seasons">
                          {% for season in museum.season_set.all %}
                            <div class="season">
                              <b>{{ season.title }}</b>
                              <p>{{ season.start|date:"j. F Y" }} - {{ season.end|date:"j. F Y" }}</p>
                              {% if season.is_appointment_based %}
                                <dl>
                                  <dt>{% trans "Based on appointment" %}</dt>
                                </dl>
                              {% else %}
                                {% regroup season.get_opening_hours by times as opening_hours %}
                                {% for same_hours in opening_hours %}
                                  <dl>
                                    <dt>
                                      {% for day in same_hours.list %}{% if forloop.first %}{{ day.weekday }}{% endif %}{% if forloop.last %}{% if forloop.counter0 %}-{{ day.weekday }}{% endif %}{% endif %}{% endfor %}
                                    </dt>
                                    <dd>
                                      {% if same_hours.list.0.open %}
                                          {{ same_hours.list.0.open|time:"H:i" }}
                                          {% if same_hours.list.0.break_close %}
                                            - {{ same_hours.list.0.break_close|time:"H:i" }}
                                            / {{ same_hours.list.0.break_open|time:"H:i" }}
                                            - {{ same_hours.list.0.close|time:"H:i" }}
                                          {% else %}
                                            - {{ same_hours.list.0.close|time:"H:i" }}
                                          {% endif %}
                                          {% if LANGUAGE_CODE == "de" %} Uhr{% endif %}
                                      {% else %}
                                          {% trans "closed" %}
                                      {% endif %}
                                    </dd>
                                  </dl>
                                {% endfor %}
                              {% endif %}

                              {% if season.last_entry %}
                                <dl>
                                  <dt>{% trans "Last entry" %}
                                    <dd>{{ season.last_entry }}</dd>
                                  </dt>
                                </dl>
                              {% endif %}
                              {% if season.exceptions %}
                              <dd>{{ season.get_rendered_exceptions }}</dd>
                            {% endif %}
                          </div>
                        {% endfor %}
                      </div>
                    {% endif %}

                    {% if museum.specialopeningtime_set.count %}
                      <div id="special_openings">
                        {% for special_opening in museum.specialopeningtime_set.all %}
                          <dl{% comment %} {% if forloop.counter > 5 %} class="hidden"{% endif %}{% endcomment %}>
                            <dt>
                              {{ special_opening.dd }}. {{ special_opening.get_mm_display }} {{ special_opening.yyyy|default:"" }}
                              {% if special_opening.is_closed %}
                                <dd>{% trans "Closed" %}</dd>
                              {% else %}
                                {% if special_opening.is_regular %}
                                  <dd>{% trans "Regular" %}</dd>
                                {% else %}
                                  <dd>{{ special_opening.opening|time:"H:i" }} - {{ special_opening.closing|time:"H:i" }}{% if LANGUAGE_CODE == "de" %} Uhr{% endif %}</dd>
                                  {% if season.sun_break_close %}
                                    <dt>{% trans "Break:" %}</dt>
                                    <dd>{{ special_opening.break_close|time:"H:i" }} - {{ special_opening.break_open|time:"H:i" }}{% if LANGUAGE_CODE == "de" %} Uhr{% endif %}</dd>
                                  {% endif %}
                                {% endif %}
                              {% endif %}
                            </dt>
                          </dl>
                        {% endfor %}
                      </div>
                      {% comment %}
                        <script>
                        $(function() {
                          var $special_openings = $('#special_openings');
                          var $hidden_times = $('dt.hidden', $special_openings).hide();
                          if ($hidden_times.length) {
                            $('<a href="">{% trans "more" %}...</a>').click(function() {
                              $(this).closest('dd').remove();
                              $hidden_times.removeClass('hidden').show();
                              return false;
                            }).appendTo('<dd></dd>').parent().appendTo($special_openings);
                          }
                        });
                        </script>
                      {% endcomment %}
                    {% endif %}
                  </div>
                </div>
                </div>
              {% endif %}

              <!-- ======= Tickets ======= -->

              {% if museum.free_entrance or museum.admission_price or museum.admission_price_info or museum.reduced_price or museum.reduced_price_info or museum.arrangements_for_children or museum.free_entrance_for or museum.family_ticket or museum.group_ticket or museum.free_entrance_times or museum.yearly_ticket or museum.other_tickets or museum.member_of_museumspass or museum.group_booking_phone_number or museum.service_phone_number %}
              <div class="panel panel-default">
                <div class="panel-heading">
                  <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#details" href="#collapse-prices">
                    {% trans "Tickets" %}
                  </a>
                </div>
                <div id="collapse-prices" class="panel-collapse collapse">
                  <div class="panel-body">
                    {% if museum.free_entrance %}
                    {% trans "Free entrance" %}
                    {% else %}
                    {% if museum.admission_price or museum.admission_price_info %}
                      <dl>
                        {% if museum.admission_price %}
                        <dt>{% trans "Admission price" %} </dt>
                        <dd>{{ museum.admission_price|currencyfmt:"EUR" }}</dd>
                        {% endif %}
                      </dl>
                      {% if museum.admission_price_info %}
                        <p>{{ museum.get_rendered_admission_price_info|removetags:"p" }}</p>
                      {% endif %}
                    {% endif %}

                    {% if museum.reduced_price or museum.reduced_price_info %}
                    <dl>
                      {% if museum.reduced_price %}
                      <dt>{% trans "Reduced price" %} </dt>
                      <dd>{{ museum.reduced_price|currencyfmt:"EUR" }}</dd>
                      {% endif %}
                    </dl>
                      {% if museum.reduced_price_info %}
                        <p>{{ museum.get_rendered_reduced_price_info|removetags:"p" }} </p>
                      {% endif %}
                    {% endif %}

                    {% if museum.show_family_ticket %}
                    <dl>
                      <dt>{% trans "Family ticket" %}</dt>
                      <dd>{% infoblock "family_ticket_info" %} </dd>
                    </dl>
                    {% endif %}

                    {% if museum.show_group_ticket %}
                    <dl>
                      <dt>{% trans "Group ticket" %}</dt>
                      <dd>{{ museum.get_rendered_group_ticket }} </dd>
                    </dl>
                    {% endif %}

                    {% if museum.show_yearly_ticket %}
                    <dl>
                      <dt>{% trans "Yearly ticket" %}</dt>
                      <dd>{% infoblock "yearly_ticket_info" %} </dd>
                    </dl>
                    {% endif %}

                    {% if museum.member_of_museumspass %}
                    <dl>
                      <dt>{% trans "Member of Museumspass Berlin" %}</dt>
                    </dl>
                    {% endif %}

                    {% endif %}
                  </div>
                  {% if museum.group_bookings_phone_number %}
                  <div class="panel-body">
                    <dl>
                      <dt>{% trans "Booking Telephone" %}</dt>
                      <dd>+{{ museum.group_bookings_phone_country }} ({{ museum.group_bookings_phone_area }}) {{ museum.group_bookings_phone_number }}</dd>
                    </dl>
                  </div>
                  {% endif %}
                </div>
              </div>
              {% endif %}

              <!-- ======= Services ======= -->

              {% if museum.service_shop or museum.service_books or museum.service_restaurant or museum.service_cafe or museum.service_library or musuem.service_archive or musuem.service_studio or museum.service_online or museum.service_diaper_changing_table or musuem.service_birthdays or museum.service_rent or musuem.service_other %}
              <div class="panel panel-default">
                <div class="panel-heading">
                  <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#details" href="#collapse-services">
                    {% trans "Services" %}
                  </a>
                </div>
                <div id="collapse-services" class="panel-collapse collapse">
                  <div class="panel-body">
                    <p>
                    <!-- {% if museum.service_shop %}
                        <dd>{% trans "Shop" %}</dd>
                    {% endif %}
                    {% if museum.service_restaurant %}
                        <dd>{% trans "Restaurant" %}</dd>
                    {% endif %}
                    {% if museum.service_cafe %}
                        <dd>{% trans "Cafe" %}</dd>
                    {% endif %}
                    {% if museum.service_library %}
                        <dd>{% trans "Library" %}</dd>
                    {% endif %}
                    {% if musuem.service_archive %}
                        <dd>{% trans "Archive" %}</dd>
                    {% endif %}
                    {% if museum.service_diaper_changing_table %}
                        <dd>{% trans "Diaper changing table" %}</dd>
                        {% endif %} -->
                          {% for service in museum.get_services %}
                          {{ service }} {% if not forloop.last %}, {% endif %}
                          {% endfor %}
                      </p>
                    </div>

                    {% if museum.service_phone_number %}
                    <div class="panel-body">
                      <dl>
                        <dt>{% trans "Service Telephone" %}</dt>
                        <dd>+{{ museum.service_phone_country }} ({{ museum.service_phone_area }}) {{ museum.service_phone_number }}</dd>
                      </dl>
                    </div>
                    {% endif %}
                  </div>
                </div>
                {% endif %}

                <!-- ======= Accessibility ======= -->

                {% if museum.accessibility_options.count or museum.accessibility or museum.mobidat %}
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#details" href="#collapse-accessibility">
                      {% trans "Accessibility" %}
                    </a>
                  </div>
                  <div id="collapse-accessibility" class="panel-collapse collapse" style="height: 0px; ">
                    <div class="panel-body clearfix">
                      {% if museum.accessibility_options.count %}
                      <ul class="list-lines">
                        {% for opt in museum.accessibility_options.all %}
                          <li class="clearfix">
                            <img class="pull-left" style="margin-right: 10px;" alt="{{ opt.title|escape }}" title="{{ opt.title|escape }}" src="{{ MEDIA_URL }}{{ opt.image }}" />
                            {{ opt.title|escape }}
                          </li>
                        {% endfor %}
                      </ul>
                      {% endif %}
                    </div>
                    {% if museum.accessibility %}
                    <div class="panel-body">
                      <div class="accessibility">
                        {{ museum.get_rendered_accessibility }}
                      </div>
                    </div>
                    {% endif %}
                    {% if museum.mobidat %}
                    <div class="panel-body">
                      <div class="accessibility">
                        {{ museum.get_rendered_mobidat }}
                      </div>
                    </div>
                    {% endif %}
                  </div>
                </div>
                {% endif %}

                <!-- ======= Audioguides ======= -->

                {% if museum.has_audioguide or museum.has_audioguide_for_children or museum.has_audioguide_for_learning_difficulties %}
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#details" href="#collapse-mediation-offer">   {% trans "Audioguides" %}
                    </a>
                  </div>
                  <div id="collapse-mediation-offer" class="panel-collapse collapse" style="height: 0px; ">
                    {% if museum.has_audioguide %}
                    <div class="panel-body">
                      <dl>
                        <dt>
                          {% if museum.get_audioguide_languages %}
                          {% trans "In" %}
                          {% for lang in museum.get_audioguide_languages %}
                          {{ lang }}{% if not forloop.last %}, {% endif %}
                          {% endfor %}
                          {% endif %}
                        </dt>
                      </dl>
                    </div>
                    {% endif %}
                    {% if museum.has_audioguide_for_children %}
                    <div class="panel-body">
                      <dl>
                        <dt>{% trans "For children and teenager" %}</dt>
                      </dl>
                    </div>
                    {% endif %}
                    {% if museum.has_audioguide_for_learning_difficulties %}
                    <div class="panel-body">
                      <dl>
                        <dt>{% trans "For people with learning difficulties" %}</dt>
                      </dl>
                    </div>
                    {% endif %}
                  </div>
                </div>
                {% endif %}

                <!-- ======= hotelbooking ======= -->

                <button class="btn btn-default btn-lg btn-block" id="hotelbooking-toggle">
                  {% trans "Hotels and Package Offers" %}
                </button>
              </div>
            {% if museum.linkgroup_set.count %}
              {% for link_group in museum.linkgroup_set.all %}
                {% if LANGUAGE_CODE == link_group.language %}
                  <div class="link-group">
                    {% if link_group.group_title %}<h4>{{ link_group.group_title }}</h4>{% endif %}
                    {% with link_group.get_links as links %}
                      {% if links %}
                        <ul>
                          {% for link in links %}
                            <li><a href="{{ link.url }}">{{ link.text }}</a></li>
                          {% endfor %}
                        </ul>
                      {% endif %}
                    {% endwith %}
                  </div>
                {% endif %}
              {% endfor %}
            {% endif %}
            </div>
          </div>
        </div>
    </div>

    {% include "utils/images.html" %}

    {% if museum.get_twitter_username %}

      <div id="museums-twitterfeed" class="content">
        <div class="container">
          <h2 class="section-head" id="section-tweets">{% trans "Current Tweets" %}</h2>
          <div id="tweets" class="row row-md" data-twitter-username="{{ museum.get_twitter_username }}"></div>
        </div>
      </div>
    {% endif %}

    <!-- ======= Exhibitions ======= -->
    <div id="additional-contents">

      {% if object.get_published_exhibitions %}
        <div id="exhibitions" class="content">
          <div class="container">
            <h2 class="section-head" id="section-exhibitions">{% trans "Current Exhibitions" %}</h2>
            <div class="list row row-md">
              {% for exhibition in object.get_published_exhibitions %}
              <div class="item col-xs-12 col-sm-12 col-md-12 col-lg-12">
                {% comment %}<!--
                  <a class="img" href="{{ exhibition.get_url_path }}" {% if exhibition.cover_image %} data-background="{{ MEDIA_URL }}{{ exhibition.cover_image|modified_path:"museum_list" }}"{% endif %}> </a>

                  <nav class="actions">
                      {% if request.user.is_authenticated %}
                          {% adding2favorites for exhibition %}
                      {% endif %}
                      <button data-toggle="tooltip" data-placement="top" data-original-title="{% trans "Show location on map" %}" class="location icon icon-white icon-location"></button>
                  </nav>

                  {% with exhibition as list_item %}
                      {% include "utils/geo_position.html" %}
                  {% endwith %}
                -->{% endcomment %}

                <a href="{{ exhibition.get_url_path }}">
                  <h3>{{ exhibition.title }}</h3>
                  <h4>{{ exhibition.subtitle }}</h4>
                  <h5>
                    {% if exhibition.permanent %}
                    {{ exhibition.start|date:"d.m.Y" }} {% trans "until further notice" %}
                    {% else %}
                    {{ exhibition.start|date:"d.m.Y" }}{% if exhibition.end %} {% trans "till" %} {{ exhibition.end|date:"d.m.Y" }}{% endif %}
                    {% endif %}
                  </h5>
                </a>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}

      <!-- ======= Events ======= -->

      {% if object.get_published_events %}
        <div id="events" class="content">
          <div class="container">
            <h2 class="section-head" id="section-events">{% trans "Current Events" %}</h2>
            <div class="list row row-md">
              {% for event in object.get_published_events %}
              <div class="item col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <a href="{{ event.get_url_path }}">
                  <h4>{% with event.get_closest_event_time as event_time %}{{ event_time.event_date|date:"j. F Y" }} {{ event_time.start|time:"H:i" }}{% if LANGUAGE_CODE == "de" %} Uhr{% endif %}{% endwith %}</h4>
                  <h3>{{ event.title }}</h3>
                  <h4>{{ event.subtitle }}</h4>
                  <h5>{{ event.museum.title }}</h5>
                </a>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}

      <!-- ======= Guided Tours ======= -->

      {% if object.get_published_workshops %}
        <div id="workshops" class="content">
          <div class="container">
            <h2 class="section-head" id="section-workshops">{% trans "Current Guided Tours, Workshops and educational offers" %}</h2>
            <div class="list row row-md">
              {% for workshop in object.get_published_workshops %}
                <div class="item col-xs-12 col-sm-12 col-md-12 col-lg-12">
                  <a href="{{ workshop.get_url_path }}">
                    {% if workshop.has_group_offer or not workshop.workshoptime_set.count %}
                      <h4>{% if workshop.workshop_type %}{{ workshop.workshop_type }}:{% endif %} {% trans "Bookable Offer" %}</h4>
                      {% else %}
                      <h4>
                        {% if workshop.workshop_type %}{{ workshop.workshop_type }}:{% endif %}
                        {% with workshop.get_closest_workshop_time as workshop_time %}
                        {{ workshop_time.workshop_date|date:"j. F Y" }}
                        {{ workshop_time.start|time:"H:i" }}{% if workshop_time.end %} {% trans "till" %} {{ workshop_time.end|time:"H:i" }}{% endif %}
                        {% if LANGUAGE_CODE == "de" %} Uhr{% endif %}
                        {% endwith %}
                      </h4>
                    {% endif %}
                    <h3>{{ workshop.title }}</h3>
                    <h4>{{ workshop.subtitle }}</h4>
                    <h5>{{ workshop.museum.title }}</h5>
                  </a>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}

      <!-- ======= Products ======= -->

      {% if object.get_related_products %}
          <div id="list" class="shop-product-list">
              <div class="container">
                  <header class="clearfix">
                      <h2 class="section-head pull-left" id="section-related-products">{% trans "Products" %}</h2>
                      <a href="{% url "museum_products" slug=object.slug %}" class="pull-right">{% trans "All products of the museum" %}</a>
                  </header>
                  <div id="container clearfix">
                      <div class="row row-md grid">
                          {% for product in object.get_related_products|slice:':4' %}
                              <div class="item col-xs-12 col-sm-4 col-md-4 col-lg-3{% if forloop.counter == 4 %} hidden-sm hidden-md{% endif %}">
                                  <a href="{{ product.get_url_path }}">
                                      {% if product.image %}
                                          <span class="img"><img src="{{ STATIC_URL }}site/img/placeholder_editorial.gif" data-original="{{ MEDIA_URL }}{{ product.image|modified_path:"editorial" }}" alt="product.title" /></span>
                                      {% endif %}
                                      {% if product.price %}
                                          <span class="price pull-right">{{ product.price|currencyfmt:"€" }}</span>
                                      {% endif %}
                                      <h3>
                                          {{ product.title }}
                                      </h3>
                                      {% if product.subtitle %}
                                          <h4>{{ product.subtitle }}</h4>
                                      {% endif %}
                                  </a>
                              </div>
                          {% endfor %}
                      </div>
                  </div>
              </div>
          </div>
      {% endif %}


    </div>

  {% endwith %}

  {% include "utils/page_controls.html" %}
  {# {% include "utils/gmap_scripts.html" %} #}
  {# {% include "utils/gallery_scripts.html" %} #}

  <div class="modal fade" id="hotelbooking" tabindex="-1" role="dialog" aria-labelledby="hotelbookingLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body" style="background: #fff;">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <iframe style="border:none" src="https://buchung1.visitberlin.de/hotelbuchung/controller?command=part&partid=93597537563" width="500" height="500" name="SELFHTML_in_a_box">
          <p>Ihr Browser kann leider keine eingebetteten Frames anzeigen:
            Sie k&ouml;nnen die eingebettete Seite &uuml;ber den folgenden Verweis
            aufrufen: <a href="../../../index.htm">SELFHTML</a></p>
          </iframe>
        </div>
      </div>
    </div>
  </div>

{% endblock %}

{% block footer %}
  {{ block.super }}
  <script>
    $(function() {
      $('#hotelbooking-toggle').click(function() {
        $('#hotelbooking').modal('show');
        return false;
      });
    });
  </script>
{% endblock %}
