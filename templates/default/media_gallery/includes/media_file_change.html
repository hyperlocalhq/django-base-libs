{% load i18n base_tags auth_extended image_modifications %}
<div class="portfolio">
    <form action="." method="post" enctype="multipart/form-data">
        <div class="field_layout" id="media_file_editing">
            {{ form.non_field_errors }}
            <fieldset id="upload_media_file">
                <legend>
                    {% ifequal media_file_type "image" %}
                        {% trans "Upload Image" %}
                    {% endifequal %}
                    {% ifequal media_file_type "audio" %}
                        {% trans "Upload Audio" %}
                    {% endifequal %}
                    {% ifequal media_file_type "video" %}
                        {% trans "Upload Video" %}
                    {% endifequal %}
                </legend>
                <ul>
                    <li class="preview_img">
                        {% if media_file.get_preview_representation %}
                            {{ media_file.get_preview_representation }}
                        {% else %}
                            <img src="{{ STATIC_URL }}site/img/website/placeholder/upload_image.png" alt="{{ object.get_title|escape }}" />
                        {% endif %}
                    </li>
                    <li class="insert_img">
                        {{ form.media_file }}
                        {{ form.media_file.error_tag }}
                         <label class="label_input_img">
                            {{ form.media_file.help_text }}
                        </label>
                    </li>
                    <li class="insert_img">
                        <input type="submit" class="button_good" value="{% filter upper %}{% trans "Upload" %}{% endfilter %}" name="save_continue" />
                    </li>
                    <li class="insert_img">
                        <a href="#link_to_media_file" id="link_to_media_file_switcher">
                        {% trans "Use an externally hosted media file." %}
                        </a>
                    </li>
                </ul>
            </fieldset>
            <fieldset id="link_to_media_file" class="to_hide">
                <legend>
                    {% ifequal media_file_type "image" %}
                        {% trans "Link to External Image" %}
                    {% endifequal %}
                    {% ifequal media_file_type "audio" %}
                        {% trans "Link to External Audio" %}
                    {% endifequal %}
                    {% ifequal media_file_type "video" %}
                        {% trans "Link to External Video" %}
                    {% endifequal %}
                </legend>
                <ul>
                    <li class="preview_img">
                        {% if media_file.get_preview_representation %}
                            {{ media_file.get_preview_representation }}
                        {% else %}
                            <img src="{{ STATIC_URL }}site/img/website/placeholder/upload_image.png" alt="{{ object.get_title|escape }}" />
                        {% endif %}
                    </li>
                    <li class="insert_img">
                        {{ form.external_url }}
                        {{ form.external_url.error_tag }}
                         <label class="label_input_img">
                            {{ form.external_url.help_text }}
                        </label>
                    </li>
                    <li class="insert_img">
                        <input type="submit" class="button_good" value="{% filter upper %}{% trans "Save and Show" %}{% endfilter %}" name="save_continue" />
                    </li>
                    <li class="insert_img">
                        <a href="#upload_media_file" id="upload_media_file_switcher">
                        {% trans "Upload a media file instead." %}
                        </a>
                    </li>
                </ul>
            </fieldset>
            {% if form.splash_image_file %}
                <fieldset>
                    <legend>{% trans "Upload Illustration" %}</legend>
                    <ul>
                        <li class="preview_img">
                            {% if media_file.splash_image_file %}
                                <img src="{{ media_file.splash_image_file|modified_path:"gp" }}" alt="{{ object.get_title|escape }}" />
                            {% else %}
                                <img src="{{ STATIC_URL }}site/img/default/placeholder/{{ media_file_type }}_f.png" alt="{{ object.get_title|escape }}" />
                            {% endif %}
                        </li>
                        <li class="insert_img">
                            {{ form.splash_image_file }}
                            {{ form.splash_image_file.error_tag }}
                             <label class="label_input_img">
                                {{ form.splash_image_file.help_text }}
                            </label>
                        </li>
                        <li class="insert_img">
                            <input type="submit" class="button_good" value="{% filter upper %}{% trans "Upload" %}{% endfilter %}" name="save_continue" />
                        </li>
                    </ul>
                </fieldset>
            {% endif %}
            <fieldset class="fieldset_end">
                <legend>{% trans "Description" %}</legend>
                <ul>
                    <li>
                        {{ form.title_de.label_tag }}
                        {{ form.title_de }}
                        {{ form.title.error_tag }}
                    </li>
                    <li>
                        <label for="id_description_de">
                            {{ form.description_de.label }}<br/>
                            {{ form.description_de.help_text}}
                        </label>
                        {{ form.description_de }}
                        {{ form.description_de.error_tag }}
                    </li>                            
                    <li>
                        {{ form.title_en.label_tag }}
                        {{ form.title_en }}
                        {{ form.title_en.error_tag }}
                    </li>
                    <li>
                        <label for="id_description">
                            {{ form.description_en.label }}<br/>
                            {{ form.description_en.help_text }}
                        </label>
                        {{ form.description_en }}
                        {{ form.description_en.error_tag }}
                    </li>                        
                </ul>                   
            </fieldset>
            <input type="button" class="button_bad button_delete" value="{% filter upper %}{% trans "Back" %}{% endfilter %}" onclick="redirect('{{ object.get_url_path }}{{ URL_ID_PORTFOLIO }}/')" />
            <div class="buttons">
                <input type="submit" class="button_good" value="{% filter upper %}{% trans "Save" %}{% endfilter %}" />
                <input name="save_add" type="submit" class="button_good" value="{% filter upper %}{% trans "Save and add another" %}{% endfilter %}" />
            </div>
        </div>
        {% if list_of_files %}
            {% for f in list_of_files %}
                {% if forloop.first %}
                    <h6 class="subline">{% trans "Thumbnails" %}</h6>
                    <ul id="media_thumbs">
                {% endif %}
                    <li{% ifequal f.id media_file.id %} class="active"{% endifequal %}>
                        <a href="{{ object.get_url_path }}{{ URL_ID_PORTFOLIO }}/file_{{ f.id }}/"><img src="{{ f.get_thumbnail_url }}" alt="{{ f.title|escape }}" title="{{ f.get_file_type_display }}. {{ f.title|escape }}" /></a>
                    </li>
                 {% if forloop.last %}
                    </ul>
                {% endif %}
            {% endfor %}
        {% endif %}                
    </form>
</div>

