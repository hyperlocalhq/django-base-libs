{% extends base_template|default:"base_sidebar_counselling.html" %}
{% load events i18n base_tags navigation_tags auth_extended babel infoblocks cms_tags %}

{% block extrahead %}
    {{ block.super }}
    
    <link rel="alternate" type="application/rss+xml" title="{% blocktrans with object.get_title as institution_title %}RSS Feed of Events by/at {{ institution_title }}{% endblocktrans %}" href="{{ website_url|slice:"0:-1" }}{{ request.path }}feed/rss/{{ LANGUAGE_CODE }}/{% filter force_escape %}{% append_to_get page=0,paginate_by=0,sort_by=0,view_type=0 no_path %}{% endfilter %}">
    
    <link rel="alternate" type="application/atom+xml" title="{% blocktrans with object.get_title as institution_title %}Atom Feed of Events by/at {{ institution_title }}{% endblocktrans %}" href="{{ website_url|slice:"0:-1" }}{{ request.path }}feed/atom/{{ LANGUAGE_CODE }}/{% filter force_escape %}{% append_to_get page=0,paginate_by=0,sort_by=0,view_type=0 no_path %}{% endfilter %}">
    
    {% if view_type == "map" %}
        <script type="text/javascript" src="//maps.google.com/maps/api/js?language={{ LANGUAGE_CODE }}&amp;region=DE&amp;key={{ GOOGLE_API_KEY }}"></script>
        <script type="text/javascript" src="{{ STATIC_URL }}site/js/website/styledinfowindow.js"></script>
        <script type="text/javascript">
            //<![CDATA[
            var aGeopositions = [];
            //]]>
        </script>
    {% endif %}
{% endblock %}

{% block content %}
    <div class="header">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <h1>{% trans "Events" %}</h1>
                    <p></p>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-4 col-md-3">
            </div>
            <div class="col-xs-12 col-sm-8 col-md-9">
                {% if object_list %}
                    <div class="row event-list">
                        {% for date in object_list %}
                            {% with event=date.event %}
                                {% ifchanged date.present_then_past %}
                                    {% if date.present_then_past == 1 %}
                                        {# When switching from current to past events, display the header again #}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="header">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <h1>{% trans "Past Events" %}</h1>
                    <p></p>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-4 col-md-3">
            </div>
            <div class="col-xs-12 col-sm-8 col-md-9">
                <div class="row event-list">
                                    {% endif %}
                                {% endifchanged %}
                                {% ifchanged date.start|date:'D, d. m. Y' %}<h2 class="date">{{ date.start|date:'D, d. m. Y' }}</h2>{% endifchanged %}
                                {% include "counselling_events/lists/event.html" %}
                            {% endwith %}
                        {% endfor %}
                    </div>
                    {% include "utils/includes/pagination.html" %}
                {% else %}
                    <p>{% trans "No objects found within the selected conditions." %}</p>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    <script type="text/javascript" src="{{ STATIC_URL }}site/js/event-list.js"></script>
{% endblock %}
