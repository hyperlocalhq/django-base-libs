{% load events i18n base_tags auth_extended navigation_tags %}
{% with today|date:"Ymd" as str_today %}
    <ul class="event-quick-links">
        <li class="first_item">
            {% parse "{{ base_url|slice:':-1' }}{{ show }}/" as url_part %}
            <a href="{{ base_url|slice:':-1' }}{{ show }}/?{{ form.get_query|escape }}" id="link_all_events"
                {% ifequal url_part request.path %} class="active"{% endifequal %}>{% trans "All" %}</a>
        </li>

        <li>
            {% parse "/{{ str_today }}/" as url_part %}
            <a href="{{ base_url|slice:':-1' }}{{ show }}/{{ str_today }}/?{{ form.get_query|escape }}"
                {% if url_part|in_list:request.path %} class="active"{% endif %}>{% trans "Today" %}</a>
        </li>

        {% with today|add_days:1|date:"Ymd" as str_tomorrow %}
            {% parse "/{{ str_tomorrow }}/" as url_part %}
            <li>
                <a href="{{ base_url|slice:':-1' }}{{ show }}/{{ str_tomorrow }}/?{{ form.get_query|escape }}"
                    {% if url_part|in_list:request.path %} class="active"{% endif %}>{% trans "Tomorrow" %}</a>
            </li>
        {% endwith %}

        {% with today|add_days:7|date:"Ymd" as str_after_7_days %}
            {% parse "{{ str_today }}-{{ str_after_7_days }}" as str_next_7_days %}
            {% parse "/{{ str_next_7_days }}/" as url_part %}
            <li>
                <a href="{{ base_url|slice:':-1' }}{{ show }}/{{ str_next_7_days }}/?{{ form.get_query|escape }}"
                    {% if url_part|in_list:request.path %} class="active"{% endif %}>{% trans "Next 7 days" %}</a>
            </li>
        {% endwith %}

        {% with today|add_days:30|date:"Ymd" as str_after_30_days %}
            {% parse "{{ str_today }}-{{ str_after_30_days }}" as str_next_30_days %}
            {% parse "/{{ str_next_30_days }}/" as url_part %}
            <li>
                <a href="{{ base_url|slice:':-1' }}{{ show }}/{{ str_next_30_days }}/?{{ form.get_query|escape }}"
                    {% if url_part|in_list:request.path %} class="active"{% endif %}>{% trans "Next 30 days" %}</a>
            </li>
        {% endwith %}
    </ul>
{% endwith %}
<fieldset id="fieldset_datepicker">
    <input type="date" id="id_eventdate"/>
</fieldset>

<script type="text/javascript">
    $(document).ready(function () {
        $('#id_eventdate').datepicker({
            onSelect: function (dateText, inst) {
                var date = $(this).datepicker('getDate');
                var date_string = $.datepicker.formatDate('yymmdd', date);
                var oLoc = window.location;
                if (date_string) {
                    oLoc.href = oLoc.pathname.replace(
                            /\/events\/([a-z\-_]+\/)?.*$/,
                            "/events/$1" + date_string + "/"
                        ) + oLoc.search;
                }
            },
            showOn: 'button',
            buttonText: '{% trans "Pick a date" %}'
        });
        $('#id_eventdate').datepicker('option', {showMonthAfterYear: false});
        if ($.datepicker.regional[window.settings['lang']]) {
            $('#id_eventdate').datepicker('option', $.datepicker.regional[window.settings['lang']]);
        }
    });
</script>

