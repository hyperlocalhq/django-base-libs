{% extends "events/details_base.html" %}
{% load i18n base_tags events infoblocks %}

{% block content %}
    <div class="map">{{ block.super }}</div>{% endblock %}

{% block details %}
    <div class="map">
        <noscript>{% infoblock "js_warning" %}</noscript>

        <div class="go-back">
            <a href="{{ object.get_url_path }}">{% trans "Back to profile view" %}</a>
        </div>

        <div id="dyn_map" class="to_show">
            <div id="gmap"></div>

            {% with object as contact %}
                <div>
                    {% include "events/profile/map_contact.html" %}
                </div>
            {% endwith %}
        </div>
    </div>
{% endblock %}

{% block extrabody %}
    <script type="text/javascript"
        src="//maps.google.com/maps/api/js?language={{ LANGUAGE_CODE }}&amp;region=DE"></script>
    <script type="text/javascript">
        self.aGeopositions = [];
        {% for contact in object.get_contacts %}
            {% with contact.postal_address.get_geoposition as geopos %}
                {% if geopos %}
                    self.aGeopositions[{{ forloop.counter0 }}] = [{{ geopos.latitude }}, {{ geopos.longitude }}];
                {% endif %}
            {% endwith %}
        {% endfor %}
    </script>
    <script type="text/javascript" src="{{ STATIC_URL }}site/js/website/map.js"></script>
{% endblock %}
