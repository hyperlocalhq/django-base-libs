{% extends "bulletin_board/details_base.html" %}
{% load image_mods_tags bulletin_board_tags i18n %}

{% block details %}

    <h3>{% if object.bulletin_type %}{{ object.bulletin_type }}{% if object.category %} {{ object.category }}{% endif %} {% elif object.category %}{{ object.category }} {% endif %}{% if object.published_till %}<time>{% trans "Published till" %} {{ object.published_till|date:"d. m. Y H:i" }}</time>{% endif %}</h3>

    <h2>{{ object.get_title }}</h2>

    {% if object.image %}
        <img src="{{ UPLOADS_URL }}{{ object.image|modified_path:"article" }}" alt="{{ object.get_title|escape }}" />
        {% if object.image_description %}
            <h5 class="caption">{{ object.image_description }}</h5>
        {% endif %}
    {% endif %}

    
    {% if object.description %}
        <h5>{% trans 'Description' %}</h5>
        <div class="line"></div>
        <p>{{ object.get_description|urlize|linebreaks }}</p>
    {% endif %}
    
    {% if object.description %}
        <h5>{% trans 'Contact' %}</h5>
        <div class="line"></div>
        <p>
            {% if object.institution %}
                {% if object.institution.status == "published" %}
                    <a href="{{ object.institution.get_url_path }}">{{ object.institution.title }}</a>
                {% else %}
                    {{ object.institution.title }}
                {% endif %}
                <br/>
            {% endif %}
            {% if object.contact_person %}
                {{ object.contact_person }}<br/>
            {% endif %}
            {% if object.phone %}
                {% trans "Phone" %}: {{ object.phone }}<br/>
            {% endif %}
            {% if object.email %}
                {% trans "Email" %}: <a href="mailto:{{ object.email }}">{{ object.email }}</a>
            {% endif %}
            
        </p>
    {% endif %}
    
    {% if object.external_url and object.content_provider %}
            <p><a href="{{ object.external_url }}" target="_blank">{% blocktrans with content_provider_title=object.content_provider.title %}More info at {{ content_provider_title }}{% endblocktrans %}</a></p>
    {% endif %}
            
{% endblock %}

{% block details_old %}
    <div class="head">
        <div id="dyn_avatar" class="dyn_section bulletin_avatar">
            <div class="article_img">
                {% if object.image %}
                    <img src="{{ UPLOADS_URL }}{{ object.image|modified_path:"ad" }}" alt="{{ object.get_title|escape }}" title="{{ object.get_title|escape }}" />
                    {% if object|can_be_changed:request.user %}
                        <!--<a href="{% cropping_url bulletin.image.path "ad" request request.path %}" class="but_edit recrop_link"><span><span>Adjust image</span></span></a>-->
                    {% endif %}
                {% else %}
                    <img alt="{{ object.get_title|escape }}" src="{{ STATIC_URL }}site/img/website/placeholder/default/news.png" />
                {% endif %}
            </div>
            {% if object.image_description %}
                <div class="caption">
                    <p>{{ object.image_description }}</p>
                </div>
            {% endif %}
        </div>
    </div>
    <div id="dyn_content" class="dyn_section">
        <div class="dyn_section_content">
            <h2>{{ object.get_title }}</h2>
            {% if object.description %}
                <div class="dyn_section_content">
                    <p>{{ object.get_description|urlize|linebreaks }}</p>
                </div>
            {% endif %}
        </div>
        {% if request.user.is_authenticated and object|can_be_changed:request.user %}
            <a id="but_edit_content" href="{% url "change_bulletin" token=object.get_token %}" class="but_edit"><span><span>bearbeiten</span></span></a>
        {% endif %}

        <div class="section-details address_field_last">
            <div class="bulletin-contact">
                <dl>
                    <dt>{% trans "Contact" %}</dt>
                    {% if object.institution %}
                        <dd>
                            {% if object.institution.status == "published" %}
                                <a href="{{ object.institution.get_url_path }}">{{ object.institution.title }}</a>
                            {% else %}
                                {{ object.institution.title }}
                            {% endif %}
                        </dd>
                    {% endif %}
                    {% if object.contact_person %}
                        <dd>{{ object.contact_person }}</dd>
                    {% endif %}
                </dl>
            </div>
            {% if object.phone %}
                <dl>
                    <dd class="tel">
                        <abbr class="type">{% trans "Phone" %}:</abbr>
                        <span class="value">&nbsp;{{ object.phone }}</span>
                    </dd>
                </dl>
            {% endif %}
            {% if object.email %}
                <dl>
                    <dd class="tel">
                        <span class="value"><a href="mailto:{{ object.email }}">{{ object.email }}</a></span>
                    </dd>
                </dl>
            {% endif %}

        </div>
        {% if object.external_url and object.content_provider %}
            <p><a href="{{ object.external_url }}" target="_blank">{% blocktrans with content_provider_title=object.content_provider.title %}More info at {{ content_provider_title }}{% endblocktrans %}</a></p>
        {% endif %}

    </div>
    <div>
        <h3>{% trans "Categories" %}</h3>
        <dl class="extra_info">
            {% if object.bulletin_type %}
                <dt>{% trans "Bulletin Type" %}</dt>
                <dd>{% trans object.bulletin_type %}</dd>
            {% endif %}
            {% if object.bulletin_category %}
                <dt>{% trans "Bulletin Category" %}</dt>
                <dd>{{ object.bulletin_category }}</dd>
            {% endif %}
            {% if object.categories %}
                <dt>{% trans "Categories" %}</dt>
                {% for item in object.categories.all %}
                    <dd>{{ item }}</dd>
                {% endfor %}
            {% endif %}
            <dt>{% trans "Location type" %}</dt>
            <dd>
                {% if object.locality_type %}
                    {{ object.locality_type }}
                {% else %}
                    {% trans "All" %}
                {% endif %}
            </dd>
        </dl>
    </div>
{% endblock %}
