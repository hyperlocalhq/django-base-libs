{% extends "media_gallery/portfolio_base.html" %}
{% load i18n base_tags auth_extended infoblocks image_modifications uni_form_tags uni_form_field %}

{% block details %}
    <div id="create_update_mediafile">
        <div class="portfolio">
            <form action="." method="post" enctype="multipart/form-data" class="uniForm">{% csrf_token %}
                <div id="media_file_editing">
                    {{ form.non_field_errors }}
                    <fieldset id="upload_media_file">
                        <h3>
                            {% ifequal media_file_type "image" %}
                                {% trans "Upload Image" %}
                            {% endifequal %}
                            {% ifequal media_file_type "audio" %}
                                {% trans "Upload Audio" %}
                            {% endifequal %}
                            {% ifequal media_file_type "video" %}
                                {% trans "Upload Video" %}
                            {% endifequal %}
                        </h3>
                        <ul class="media_file_upload clearfix">
                            <li class="preview_img">
                                {% if media_file.get_preview_representation %}
                                    {{ media_file.get_preview_representation }}
                                {% else %}
                                    <img src="{{ STATIC_URL }}site/img/website/placeholder/{{ media_file_type }}_f.png"
                                         alt="{{ object.get_title|escape }}"/>
                                {% endif %}
                            </li>
                            <li class="insert_img">
                                {{ form.media_file }}
                                {{ form.media_file.error_tag }}
                                <label class="label_input_img">
                                    {{ form.media_file.help_text }}
                                </label>
                            </li>
                            <li class="insert_img">
                                <div class="buttonHolder">
                                    <input type="submit" class="primaryAction"
                                           value="{% filter upper %}{% trans "Upload" %}{% endfilter %}"
                                           name="save_continue"/>
                                </div>
                            </li>
                            <li class="insert_img">
                                <a href="#link_to_media_file" id="link_to_media_file_switcher">
                                    {% trans "Use an externally hosted media file." %}
                                </a>
                            </li>
                        </ul>
                    </fieldset>
                    <fieldset id="link_to_media_file" class="to_hide">
                        <h3>
                            {% ifequal media_file_type "image" %}
                                {% trans "Link to External Image" %}
                            {% endifequal %}
                            {% ifequal media_file_type "audio" %}
                                {% trans "Link to External Audio" %}
                            {% endifequal %}
                            {% ifequal media_file_type "video" %}
                                {% trans "Link to External Video" %}
                            {% endifequal %}
                        </h3>
                        <ul class="media_file_upload clearfix">
                            <li class="preview_img">
                                {% if media_file.get_preview_representation %}
                                    {{ media_file.get_preview_representation }}
                                {% else %}
                                    <img src="{{ STATIC_URL }}site/img/website/placeholder/{{ media_file_type }}_f.png"
                                         alt="{{ object.get_title|escape }}"/>
                                {% endif %}
                            </li>
                            <li class="insert_img">
                                {{ form.external_url|with_class }}
                                {{ form.external_url.error_tag }}
                                <label class="label_input_img">
                                    {{ form.external_url.help_text }}
                                </label>
                            </li>
                            <li class="insert_img">
                                <div class="buttonHolder">
                                    <input type="submit" class="primaryAction"
                                           value="{% filter upper %}{% trans "Upload" %}{% endfilter %}"
                                           name="save_continue"/>
                                </div>
                            </li>
                            <li class="insert_img">
                                <a href="#upload_media_file" id="upload_media_file_switcher">
                                    {% trans "Upload a media file instead." %}
                                </a>
                            </li>
                        </ul>
                    </fieldset>
                    {% if form.splash_image_file %}
                        <fieldset>
                            <h3>{% trans "Upload Illustration" %}</h3>
                            <ul class="media_file_upload clearfix">
                                <li class="preview_img">
                                    {% if media_file.splash_image_path %}
                                        <img src="
                                                {{ UPLOADS_URL }}{{ media_file.splash_image_path|modified_path:"gp" }}"
                                             alt="{{ object.get_title|escape }}"/>
                                    {% else %}
                                        <img src="{{ STATIC_URL }}site/img/website/placeholder/upload_image.png"
                                             alt="{{ object.get_title|escape }}"/>
                                    {% endif %}
                                </li>
                                <li class="insert_img">
                                    {{ form.splash_image_file }}
                                    {{ form.splash_image_file.error_tag }}
                                    <label class="label_input_img">
                                        {{ form.splash_image_file.help_text }}
                                    </label>
                                </li>
                                <li class="insert_img">
                                    <div class="buttonHolder">
                                        <input type="submit" class="primaryAction"
                                               value="{% filter upper %}{% trans "Upload" %}{% endfilter %}"
                                               name="save_continue"/>
                                    </div>
                                </li>
                            </ul>
                        </fieldset>
                    {% endif %}
                    <fieldset class="inlineLabels">
                        <h3>{% trans "Description" %}</h3>
                        {{ form.title_de|as_uni_field }}
                        {{ form.description_de|as_uni_field }}
                        {{ form.title_en|as_uni_field }}
                        {{ form.description_en|as_uni_field }}
                    </fieldset>
                    <div class="buttonHolder">
                        <input type="submit" class="primaryAction"
                               value="{% filter upper %}{% trans "Save" %}{% endfilter %}"/>
                    </div>
                </div>
            </form>
        </div>
        <script type="text/javascript" src="{{ STATIC_URL }}site/js/website/portfolio_change.js"></script>
        <script type="text/javascript">
            (function ($) {
                $(document).ready(function () {
                    $('<input type="button" class="secondaryAction" value="' + gettext('Cancel') + '">').click(function () {
                        redirect("../manage/");
                    }).prependTo(
                        $(":submit").parent()
                    );
                })
            }(jQuery));
        </script>
    </div>
{% endblock %}
