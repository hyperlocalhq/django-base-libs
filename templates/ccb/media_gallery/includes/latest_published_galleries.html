{% load i18n base_tags image_mods_tags favorites %}
{% comment %}<!--
Usage in any template:
    {% load base_tags %}
    
    Simple:
    {% include_parsed "media_gallery/includes/latest_published_galleries.html" %}
    
    Customized:
    {% include_parsed "media_gallery/includes/latest_published_galleries.html" with 5 as amount %}
    
-->{% endcomment %}

{% with amount|default:5 as amount %}
    {% get_objects newest_featured media_gallery.MediaGallery amount as newest_objects %}
    {% if newest_objects %}
    
        <div class="row slider portfolio">
            <div class="wrapper">
        
                {% for gallery in newest_objects %}
                    {% with gallery.content_object as content_object %}
            
                        <div class="col-xs-12 slide">
                            <a class="content" href="{{ content_object.get_url_path }}portfolio/">
                                <span class="image-hover-bg">
                                    {% if gallery.mediafile_set.count %}
                                        <img src="{{ UPLOADS_URL }}{{ gallery.mediafile_set.all.0.path|modified_path:"portfolio_slide" }}" alt="{{ content_object.get_title|escape }}"/>
                                    {% else %}
                                        <img src="{{ STATIC_URL }}site/img/placeholder/infolink_square.png" alt="{{ content_object.get_title|escape }}"/>
                                    {% endif %}
                                </span>
                                <h2>{{ content_object.get_title }}</h2>
                            </a>
                            <div class="button-group">
                                {% if request.user.is_authenticated %}
                                    {% adding2favorites for content_object using "generic/favorite_icon.html" %}
                                {% else %}
                                    <a href="{% url 'login' %}?goto_next={{ request.path }}" class="fawesome fa-favorite button"><span class="sr-only">{% trans "Add to favorites" %}</span></a>
                                {% endif %}
                            </div>
                        </div>
                
                    {% endwith %}
                {% endfor %}
        
            </div>
        </div>
        
    {% else %}
        <p class="intro">{% trans "There are no portfolios." %}</p>
    {% endif %}
{% endwith %}
