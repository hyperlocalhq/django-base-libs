{% load i18n base_tags image_mods_tags %}
{% comment %}<!--
Usage in any template:
    {% load base_tags %}
    
    Simple:
    {% include_parsed "media_gallery/includes/latest_published_galleries.html" %}
    
    Customized:
    {% include_parsed "media_gallery/includes/latest_published_galleries.html" with 5 as amount %}
    
-->{% endcomment %}

<div class="dragging_handle">
    <h5>{% trans "New Galleries" %}</h5>
    <a
        href="/portfolios/?order_by=creation_date_desc">{% trans "more..." %}</a>
</div>
<div class="draggable_block_media">
    <div class="galleries">
        {% with amount|default:3 as amount %}
            {% get_objects all media_gallery.MediaGallery amount as newest_objects %}
            {% if newest_objects %}
                {% for gallery in newest_objects %}
                    {% with gallery.content_object as content_object %}
                        <div>
                            <a href="{{ content_object.get_url_path }}portfolio/">
                                {% if gallery.mediafile_set.count %}
                                    <img width="155px" height="155px" alt="{{ content_object.get_title|escape }}"
                                        src="{{ gallery.mediafile_set.all.0.get_list_image_url }}"/>
                                {% endif %}
                            </a>
                            <h5>
                                <a href="{{ content_object.get_url_path }}portfolio/">
                                    {{ content_object.get_title }}
                                </a>
                            </h5>
                            {% if gallery.description %}
                                <p>
                                    {{ gallery.description }}
                                </p>
                            {% endif %}
                        </div>
                    {% endwith %}
                {% endfor %}
            {% else %}
                <p>{% trans "There are no galleries." %}</p>
            {% endif %}
        {% endwith %}
    </div>
</div>
