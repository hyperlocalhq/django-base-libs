{% extends base_template|default:"institutions/details_base.html" %}
{% load i18n base_tags navigation_tags auth_extended %}


{% block details %}
    <div class="network_details">
        <div class="person">
            {% if object_list %}

                {% include "utils/includes/sorting_and_pagination.html" %}

                <div id="object_list">
                    {% for person in object_list %}
                        <div class="info expanded" onclick="redirect('{{ person.get_url_path }}');">
                            <div class="info_address">
                                <h5>
                                    <a class="person_hl"
                                        href="{{ person.get_url_path }}">{{ person.get_title|escape }}</a>
                                </h5>
                                {% with person.get_primary_contact as contact %}
                                    {% if contact %}
                                        {% if person.is_address_displayed %}
                                            <p>
                                                <a href="/vcard/{{ person|content_type_id }}/{{ person.id }}">vcard</a>
                                            </p>
                                            {% if contact.street_address or contact.country_name %}
                                                <address class=" hidable">
                                                    {% if contact.street_address %}
                                                        {{ contact.street_address|escape }}<br/>
                                                    {% endif %}
                                                    {% if contact.street_address2 %}
                                                        {{ contact.street_address2|escape }}<br/>
                                                    {% endif %}
                                                    {% if contact.street_address3 %}
                                                        {{ contact.street_address3|escape }}<br/>
                                                    {% endif %}
                                                    {% if contact.postal_code %}
                                                        {{ contact.postal_code|escape }} {{ contact.city|escape }}<br/>
                                                    {% endif %}
                                                    {% if contact.country_name %}
                                                        {{ contact.country_name }}<br/>
                                                    {% endif %}
                                                </address>
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% endwith %}
                            </div>
                            <div class="info_facts">
                                <div class="visibility_toggler">
                                    <a href="#"><span>Expand</span></a>
                                </div>
                                {% if person.individual_type %}
                                    <div class="type">{{ person.individual_type.get_title|escape }}</div>
                                {% endif %}
                                {% with person.get_primary_contact as contact %}
                                    {% if contact %}
                                        {% if person.get_contacts %}
                                            {% for phone in person.get_contacts.0.get_phones %}
                                                <p>{% if phone.type %}<span>{{ phone.type }}</span> {% endif %}
                                                    +{{ phone.country }}-{{ phone.area }}-{{ phone.number }}</p>
                                            {% endfor %}
                                        {% endif %}
                                        {% for url in person.get_contacts.0.get_urls %}
                                            <p>{% if url.type %}<span>{{ url.type }}</span> {% endif %}
                                                <a
                                                    href="{{ url.link|escape }}" onclick="open_new_window(event)">
                                                    {% with url.link|slice:"0:30"|escape as sliced %}{{ sliced }}
                                                        {% with url.link|escape as not_sliced %}
                                                            {% ifnotequal sliced url.link|escape %}...
                                                            {% endifnotequal %}
                                                        {% endwith %}{% endwith %}</a>
                                            </p>
                                        {% endfor %}
                                    {% endif %}
                                {% endwith %}
                                {% if person.get_description %}
                                    {% with person.get_description|striptags|truncatewords:"60" as filtered_desc %}
                                        {% with filtered_desc|truncatewords:"40" as shortened_desc %}
                                            <p class="description hidable">{{ shortened_desc }}
                                                {% ifnotequal shortened_desc filtered_desc %}
                                                    <a href="{{ person.get_url_path }}">{% trans "read more" %}</a>
                                                {% endifnotequal %}
                                            </p>
                                        {% endwith %}{% endwith %}
                                {% endif %}
                            </div>
                            {% with object as institution %}
                                {% include "institutions/controls.html" %}
                            {% endwith %}
                            <div class="cleaner"></div>
                        </div><!-- end of info -->
                    {% endfor %}
                </div>

                {% include "utils/includes/sorting_and_pagination.html" %}

            {% else %}
                <p class="nothing">{% trans "No objects found within the selected conditions." %}</p>
            {% endif %}
            <div class="cleaner"></div>
        </div>
    </div>
{% endblock %}

{% block breadcrumbs %}
    <div class="breadcrumbs">
        <a href="/">{% trans "Home" %}</a>
        <span class="b-sep"><span>::</span></span>
        <a href="{{ object.get_url_path }}network/">{% trans "Network" %}</a>
        <span class="b-sep"><span>::</span></span>
        <a class="active" href="#">{% trans "Staff" %}</a>
    </div>
{% endblock %}

{% block extrabody %}
    <script type="text/javascript" src="{{ STATIC_URL }}site/js/website/listing.js"></script>
{% endblock %}
