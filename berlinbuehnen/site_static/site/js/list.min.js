!function(){function t(t){var i=navigator.userAgent.toLowerCase();i.indexOf("safari")>-1&&!(i.indexOf("chrome")>-1)&&$("body").addClass("safari");var e=this;this.me=e,e.$main=t,e.$body=$("body"),e.autoload=t.hasClass("list-autoload"),e.reinitByFilter(),$(window).resize(function(){e.onResize()}),e.$main.data("list",e)}function i(){$(".list").each(function(){new t($(this))})}t.prototype.reinitByFilter=function(){if(this.me)var t=this.me;t.last_headline="",t.last_width=-1,t.small=null,t.resize_timer=null,t.$first_item=$(".list-item",t.$main).first(),t.$first_head=$(".list-item-head",t.$first_item),t.initListItems(),t.autoload&&t.initAutoscroll()},t.prototype.initListItems=function(t){if(this.me)var i=this.me;var e=$(".list-item",i.$main);t&&(e=e.not(".old-list-item")),e.each(function(){var t=$(this),e=$(".list-item-link",t);t.data("link",e),t.click(i.onClick)});var s=$(".list-headline",i.$main);t&&(s=s.not(".old-list-item").addClass("old-list-item")),s.each(function(){var t=$(this);t.html()!=i.last_headline?i.last_headline=t.html():t.css("display","none")}),"function"==typeof window.addToCalenderReset&&window.addToCalenderReset(),i.onResize(t)},t.prototype.setListItemsBodyWidth=function(){if(this.me)var t=this.me;var i=$(".list-item-body",t.$main);if(t.small)i.css("width","");else{var e=t.$first_head.width();i.width(t.last_width-e)}},t.prototype.setListItemBodyHeight=function(t){if(this.me)var i=this.me;var e=$(".list-item-body",t),s=$("h3",e),a=$("p",e);a.length||(a=$(".copy",e)),a.each(function(){$object=$(this);var t=$object.data("text");if(t)$object.html(t),$object.css("display","block");else{var t=$object.html();t=t.replace(/\n/g,""),t=t.replace(/(\<br\>|\<br\/\>)/gi,"\n"),t=t.replace(/\<\/br\>/gi,""),$object.html(t),t=$object.text(),t=t.replace(/\n/g," <br/>"),$object.html(t),$object.data("text",t)}}),s.css("display","block");var l=e.height(),n=!1;s.each(function(){var t=$(this);if(n)t.css("display","none");else{var i=t.position().top,e=t.height();i+e>l&&(n=!0,t.css("display","none"))}});var o=null;if(a.each(function(){var t=$(this);if(n)t.css("display","none");else{var i=t.position().top,e=t.height();i+e>l&&(n=!0,i>l?t.css("display","none"):o=t)}}),o){for(var r=o.position().top,h="",m=o.data("text"),d="",c=m.length;c;){for(o.html(h+m);r+o.height()>l;)c=Math.floor(c/2),d=m.substr(c),m=m.substr(0,c),o.html(h+m);h+=m,m=d,d=""}if(h.length>3){h=h.substr(0,h.length-3);do{for(;h.length&&" "!=h.charAt(h.length-1);)h=h.substr(0,h.length-1);h.length?o.html(h+"..."):o.css("display","none"),h=h.substr(0,h.length-1)}while(r+o.height()>l)}else o.css("display","none")}},t.prototype.initAutoscroll=function(){if(this.me)var t=this.me;var i=t.$main.attr("id"),e=$(".pagination",t.$main).removeClass("item").hide();t.$main.data("jscroll",null),e.length&&t.$main.jscroll({loadingHtml:"<small>Loading...</small>",padding:100,contentSelector:"#"+i+" .list-headline, #"+i+" .list-item, #"+i+" .pagination",nextSelector:".next_page:last",pagingSelector:"#"+i+" .pagination",callback:function(){t.onAutoscrollItems()}})},t.prototype.onAutoscrollItems=function(){if(this.me)var t=this.me;$(".pagination").removeClass("item").hide(),t.initListItems(!0)},t.prototype.onClick=function(t){var i=$(t.target);if(i.is("a"))return!0;t.stopPropagation();var e=$(this),s=e.data("link");s&&(location.href=s.attr("href"))},t.prototype.onResize=function(t){if(this.me)var i=this.me;i.resize_timer&&(window.clearTimeout(i.resize_timer),i.resize_timer=null);var e=function(){i.resize_timer=null;var e=i.small;i.$body.hasClass("is-xs")?i.small=!0:i.small=!1;var s=i.$main.width();if(s!=i.last_width||t||e!==i.small){i.last_width=s,i.setListItemsBodyWidth();var a=$(".list-item",i.$main);t&&(e==i.small?a=a.not(".old-list-item").addClass("old-list-item"):a.not(".old-list-item").addClass("old-list-item")),a.each(function(){i.setListItemBodyHeight($(this))})}};i.resize_timer=window.setTimeout(function(){e()},25)},$(document).ready(i)}();