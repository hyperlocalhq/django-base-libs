!function($,e){function t(){var e=!1;$("#videos").each(function(){var t=$(this).data("load-url");$(this).load(t+" #videos>*",function(){$("#videos").sortable({start:function(){e=!0},stop:function(){setTimeout(function(){e=!1},500)},placeholder:"ui-state-highlight",update:function(e,i){var o=[];$(".video","#videos").each(function(){$(this).data("token")&&(o[o.length]=$(this).data("token"))}),$.post(t,{ordering:o.join(",")})},forcePlaceholderSize:!0,create:function(){var e=this,t=function(){$(e).css("height","auto")};$(e).find("img").load(t).error(t)}}),$("#videos").disableSelection().find(".edit").click(function(){return!e&&($("#edit_media_item").load($(this).attr("href")+" #edit_media_item form",i),$("#media_item_overviews").hide(),$(".form-actions:last").hide(),!1)}),$(window).trigger("scrollstop")})}),$("#media_item_overviews").show(),$(".form-actions:last").show()}function i(){$("select").not('[name*="__prefix__"]').selectbox(),$("textarea").autosize(),$("#submit-id-cancel").click(function(e){e.preventDefault(),$("#edit_media_item").html(""),t()}),$("#button-id-delete-video").click(function(){var e=$(this).data("href");$("#deleteConfirmation").removeClass("hide").modal("show"),$("#button-id-confirm-deletion").click(function(){return $.post(e,{},function(){$("#deleteConfirmation").modal("hide"),$("#edit_media_item").html(""),t()}),!1})}),$("#edit_media_item form").attr("target","hidden_iframe"),self.hidden_iframe_loaded=function(e){var o=$("<div>"+e+"</div>").find("form");o.length?($("#edit_media_item").html("").append(o),i()):($("#edit_media_item").html(""),t())}}function o(){var e=!1;$("#streamings").each(function(){var t=$(this).data("load-url");$(this).load(t+" #streamings>*",function(){$("#streamings").sortable({start:function(){e=!0},stop:function(){setTimeout(function(){e=!1},500)},placeholder:"ui-state-highlight",update:function(e,i){var o=[];$(".streaming","#streamings").each(function(){$(this).data("token")&&(o[o.length]=$(this).data("token"))}),$.post(t,{ordering:o.join(",")})},forcePlaceholderSize:!0,create:function(){var e=this,t=function(){$(e).css("height","auto")};$(e).find("img").load(t).error(t)}}),$("#streamings").disableSelection().find(".edit").click(function(){return!e&&($("#edit_media_item").load($(this).attr("href")+" #edit_media_item form",a),$("#media_item_overviews").hide(),$(".form-actions:last").hide(),!1)}),$(window).trigger("scrollstop")})}),$("#media_item_overviews").show(),$(".form-actions:last").show()}function a(){$("select").not('[name*="__prefix__"]').selectbox(),$("textarea").autosize(),$("#submit-id-cancel").click(function(e){e.preventDefault(),$("#edit_media_item").html(""),o()}),$("#button-id-delete-streaming").click(function(){var e=$(this).data("href");$("#deleteConfirmation").removeClass("hide").modal("show"),$("#button-id-confirm-deletion").click(function(){return $.post(e,{},function(){$("#deleteConfirmation").modal("hide"),$("#edit_media_item").html(""),o()}),!1})}),$("#edit_media_item form").attr("target","hidden_iframe"),self.hidden_iframe_loaded=function(e){var t=$("<div>"+e+"</div>").find("form");t.length?($("#edit_media_item").html("").append(t),a()):($("#edit_media_item").html(""),o())}}function n(){lazyload_images();var e=!1;$("#photos").each(function(){var t=$(this).data("load-url");$(this).load(t+" #photos>*",function(){$("#photos").sortable({start:function(){e=!0},stop:function(){setTimeout(function(){e=!1},500)},placeholder:"ui-state-highlight",update:function(e,i){var o=[];$(".photo","#photos").each(function(){$(this).data("token")&&(o[o.length]=$(this).data("token"))}),$.post(t,{ordering:o.join(",")})},forcePlaceholderSize:!0,create:function(){var e=this,t=function(){$(e).css("height","auto")};$(e).find("img").load(t).error(t)}}),$("#photos").disableSelection().find(".edit").click(function(){return!e&&($("#edit_media_item").load($(this).attr("href")+" #edit_media_item form",d),$("#media_item_overviews").hide(),$(".form-actions:last").hide(),!1)}),$("#photos").find(".crop").each(function(){$(this).attr("href")&&$(this).attr("href",$(this).attr("href").replace(/goto_next=.+$/gim,"goto_next="+location.href))}),$(window).trigger("scrollstop")})}),$("#media_item_overviews").show(),$(".form-actions:last").show()}function d(){if($("select").not('[name*="__prefix__"]').selectbox(),$("textarea").autosize(),$("#submit-id-cancel").click(function(e){e.preventDefault(),$("#edit_media_item").html(""),n()}),$("#button-id-crop-photo").click(function(){location.href=$(this).data("href").replace(/goto_next=.+$/,"goto_next="+location.href)}),$("#button-id-delete-photo").click(function(){var e=$(this).data("href");$("#deleteConfirmation").removeClass("hide").modal("show"),$("#button-id-confirm-deletion").click(function(){return $.post(e,{},function(){$("#deleteConfirmation").modal("hide"),$("#edit_media_item").html(""),n()}),!1})}),$("#edit_media_item form").attr("target","hidden_iframe"),self.hidden_iframe_loaded=function(e){var t=$("<div>"+e+"</div>").find("form");t.length?($("#edit_media_item").html("").append(t),d()):($("#edit_media_item").html(""),n())},$("#image_uploader").length)var e=$.extend(translatable_file_uploader_options,{allowedExtensions:["gif","jpg","png"],action:"/"+self.settings.lang+"/helper/ajax-upload/",element:$("#image_uploader")[0],multiple:!1,onComplete:function(e,t,i){i.success&&($(".messages").html(""),$("#id_media_file_path").val(i.path),$.post("/"+self.settings.lang+"/helper/modified-path/",{file_path:self.settings.media_url+i.path,mod_sysname:"gallery_image"},function(e,t,i){$("#image_preview").html('<img class="img-responsive" alt="" src="'+e+'" />'),$("#image_uploader").hide(),$("#image_help_text").hide()},"text"))},onAllComplete:function(e){$(".qq-upload-success").fadeOut("slow",function(){$(this).remove()})},params:{csrf_token:$('input[name="csrfmiddlewaretoken"]').val(),csrf_name:"csrfmiddlewaretoken",csrf_xname:"X-CSRFToken"},showMessage:function(e){$(".messages").html('<div class="alert alert-danger">'+e+"</div>")}}),t=new qq.FileUploader(e)}function r(){var e=!1;$("#pdfs").each(function(){var t=$(this).data("load-url");$(this).load(t+" #pdfs>*",function(){$("#pdfs").sortable({start:function(){e=!0},stop:function(){setTimeout(function(){e=!1},500)},placeholder:"ui-state-highlight",update:function(e,i){var o=[];$(".pdf","#pdfs").each(function(){$(this).data("token")&&(o[o.length]=$(this).data("token"))}),$.post(t,{ordering:o.join(",")})},forcePlaceholderSize:!0,create:function(){var e=this,t=function(){$(e).css("height","auto")};$(e).find("img").load(t).error(t)}}),$("#pdfs").disableSelection().find(".edit").click(function(){return!e&&($("#edit_media_item").load($(this).attr("href")+" #edit_media_item form",s),$("#media_item_overviews").hide(),$(".form-actions:last").hide(),!1)}),$(window).trigger("scrollstop")})}),$("#media_item_overviews").show(),$(".form-actions:last").show()}function s(){if($("select").not('[name*="__prefix__"]').selectbox(),$("textarea").autosize(),$("#submit-id-cancel").click(function(e){e.preventDefault(),$("#edit_media_item").html(""),r()}),$("#button-id-delete-pdf").click(function(){var e=$(this).data("href");$("#deleteConfirmation").removeClass("hide").modal("show"),$("#button-id-confirm-deletion").click(function(){return $.post(e,{},function(){$("#deleteConfirmation").modal("hide"),$("#edit_media_item").html(""),r()}),!1})}),$("#edit_media_item form").attr("target","hidden_iframe"),self.hidden_iframe_loaded=function(e){var t=$("<div>"+e+"</div>").find("form");t.length?($("#edit_media_item").html("").append(t),s()):($("#edit_media_item").html(""),r())},$("#pdf_uploader").length)var e=$.extend(translatable_file_uploader_options,{allowedExtensions:["pdf"],action:"/"+self.settings.lang+"/helper/ajax-upload/",element:$("#pdf_uploader")[0],multiple:!1,onComplete:function(e,t,i){i.success&&($(".messages").html(""),$("#id_media_file_path").val(i.path),$.post("/"+self.settings.lang+"/helper/modified-path/",{file_path:i.path,mod_sysname:"medium"},function(e,t,i){$("#pdf_preview").html('<img class="img-responsive" alt="" src="'+window.settings.STATIC_URL+'site/img/pdf.png" />'),$("#pdf_uploader").hide(),$("#pdf_help_text").hide()},"text"))},onAllComplete:function(e){$(".qq-upload-success").fadeOut("slow",function(){$(this).remove()})},params:{csrf_token:$('input[name="csrfmiddlewaretoken"]').val(),csrf_name:"csrfmiddlewaretoken",csrf_xname:"X-CSRFToken"},showMessage:function(e){$(".messages").html('<div class="alert alert-danger">'+e+"</div>")}}),t=new qq.FileUploader(e)}$("#add_video").click(function(){return $("#edit_media_item").load($(this).attr("href")+" #edit_media_item form",i),$("#media_item_overviews").hide(),$(".form-actions:last").hide(),!1}),$("#add_streaming").click(function(){return $("#edit_media_item").load($(this).attr("href")+" #edit_media_item form",a),$("#media_item_overviews").hide(),$(".form-actions:last").hide(),!1}),$("#add_photo").click(function(){return $("#edit_media_item").load($(this).attr("href")+" #edit_media_item form",d),$("#media_item_overviews").hide(),$(".form-actions:last").hide(),!1}),$(document).on("click","#crop_list_image",function(){return location.href=$("#photos").find(".crop_list_image:first").attr("href").replace(/goto_next=.+$/,"goto_next="+location.href),!1}),$(document).on("click","#crop_cover_image",function(){return location.href=$("#photos").find(".crop_cover_image:first").attr("href").replace(/goto_next=.+$/,"goto_next="+location.href),!1}),$("#add_pdf").click(function(){return $("#edit_media_item").load($(this).attr("href")+" #edit_media_item form",s),$("#media_item_overviews").hide(),$(".form-actions:last").hide(),!1}),$(function(){t(),o(),n(),r()})}(jQuery);