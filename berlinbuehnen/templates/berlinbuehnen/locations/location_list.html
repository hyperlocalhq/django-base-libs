{% extends "base.html" %}
{% load url from future %}
{% load i18n image_modifications base_tags tagging_tags favorites auth_extended %}
{% block title %}{% trans "Locations" %} â€“ {% endblock %}
{% block bodyclass %}location-list no-transition{% endblock %}


{% block js %}
    <script type="text/javascript" src="{{ STATIC_URL }}site/js/grid.js" defer="defer"></script>
{% endblock %}

{% block content %}
    <div class="content overview">
        <div class="container">
            <div class="row">
                
                <h1 class="bottom-line">{% trans "Locations" %}</h1>
                
                <div class="col-xs-12">
                    
                    <!-- the list -->
                    {% if object_list %}
                        <div id="main_grid" class="grid location-grid grid-autoload row">
                            {% for location in object_list %}
                                <a class="grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3" href="{{ location.get_url_path }}">
                                                
                                    <!-- image -->
                                    <span class="grid-item-image img">
                                        {% comment %}{% if location.logo %}
                                            <img src="{{ MEDIA_URL }}{{ location.logo|modified_path:"detail_image" }}{% if_has_perm "location.change_location" location %}?now={% now "YmdHis" %}{% end_if_has_perm %}" alt="{{ location.title|escape }}" />{% endcomment %}
                                        {% if location.first_image %}
                                            <img src="{{ MEDIA_URL }}{{ location.first_image.path|modified_path:"detail_image" }}{% if_has_perm "location.change_location" location %}?now={% now "YmdHis" %}{% end_if_has_perm %}" alt="{{ event.production.title|escape }}" />
                                        {% elif location.image_set.exists %}
                                            {% with location.image_set.all|first as image %}
                                                <img src="{{ MEDIA_URL }}{{ image.path|modified_path:"detail_image" }}{% if_has_perm "location.change_location" location %}?now={% now "YmdHis" %}{% end_if_has_perm %}" alt="{{ location.title|escape }}" />
                                            {% endwith %}
                                        {% else %}
                                            <img src="{{ STATIC_URL }}site/img/placeholder_location_grid.png" />
                                        {% endif %}
                                    </span>
                                    
                                    {% if location.title %}<h2>{{ location.title }}</h2>{% endif %}
                                    {% if location.subtitle %}<h3>{{ location.subtitle }}</h3>{% endif %}
                                    {% if location.description %}<div class="copy">{{ location.get_rendered_description|truncatewords:20 }}</div>{% endif %}
                                    
                                </a>
                                
                            {% endfor %}
                            
                            {% include "utils/pagination.html" %}
                        </div>
                    {% else %}
                        {% include "utils/container_empty.html" %}
                    {% endif %}
                        
                </div>
            </div>
        </div>
    </div>
{% endblock %}