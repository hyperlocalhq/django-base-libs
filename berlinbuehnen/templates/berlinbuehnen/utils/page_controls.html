{% load i18n base_tags sekizai_tags %}
<div id="page-controls" class="hidden-xs">
    {% with prev_item=object.get_previous_item next_item=object.get_next_item %}
    {# overwriting the prev_item and next_item with values not dependent on httpstate #}
        {% if prev_item %}
            <a href="{{ prev_item.get_url_path }}{% remove_from_query "page" %}" class="prev">
                <span>
                    {% if prev_item.production %}
                        <span class="title">{{ prev_item.production.title }}</span>
                    {% else %}
                        <span class="title">{{ prev_item.title }}</span>
                    {% endif %}
                </span>
            </a>
        {% endif %}
        {% if next_item %}
            <a href="{{ next_item.get_url_path }}{% remove_from_query "page" %}" class="next">
                <span>
                    {% if next_item.production %}
                        <span class="title">{{ next_item.production.title }}</span>
                    {% else %}
                        <span class="title">{{ next_item.title }}</span>
                    {% endif %}
                </span>
            </a>
        {% endif %}
    {% endwith %}
</div>

{% now "uuuu" as microseconds %}
<script nonce="{{ microseconds|to_base64 }}">
    $(document).keydown(function(e){
        switch(e.which) {
            case 37: // left
                document.location.href="{{ prev_item.get_url_path }}";
                break;

            case 38: // up
                break;

            case 39: // right
                document.location.href="{{ next_item.get_url_path }}";
                break;

            case 40: // down
                break;

            default:
                return; // exit this handler for other keys
        }
        e.preventDefault();
    });
</script>
{% add_data "script_nonces" microseconds|to_base64 %}