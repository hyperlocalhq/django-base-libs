{% extends "site_specific/dashboard.html" %}{% load url from future %}{% load base_tags i18n crispy_forms_tags tagging_tags image_modifications infoblocks auth_extended %}{% block js %}<script src="{{ STATIC_URL }}site/js/jquery.selectbox-0.2.min.js"></script>{% endblock %}{% block content %}    <div class="dashboard-header container relative">        <div id="form-meta">            <div id="pub-status">                <select id="status_filter">                    <option{% if status == "published" %} selected="selected"{% endif %} value="published">{% trans "Only Published" %}</option>                    <option{% if status == "draft" %} selected="selected"{% endif %} value="draft">{% trans "Only Draft" %}</option>                    <option{% if status == "import" %} selected="selected"{% endif %} value="import">{% trans "Only Imported" %}</option>                    <option{% if status == "expired" %} selected="selected"{% endif %} value="expired">{% trans "Only Expired" %}</option>                </select>            </div>            <div>                <form id="dashboard_search" action="" method="get">                    <input type="text" name="q" id="q" value="{{ q|escape }}" />                    <button type="submit" class="btn"><span class="icon icon-zoom"></span></button>                </form>            </div>            {% if_has_perm "festivals.add_festival" %}                <a class="btn btn-primary" href="{% url "add_festival" %}">{% trans "Add festival" %}</a>            {% end_if_has_perm %}        </div>        <h4><a href="{% url "dashboard_festivals" %}">{% trans "Festivals" %}</a></h4>    </div>    <div id="dashboard" class="container">        <div id="festivals" class="content">            <table class="dashboard-table">                <thead>                    <tr>                        <th class="col-title"> <small><a data-sort_by="{% if sort_by == "title" %}-{% endif %}title" href="?sort_by={% if sort_by == "title" %}-{% endif %}title">{% trans "Title" %}                            {% if sort_by == "title" %}                                <span class="icon icon-arrow-down"></span>                            {% elif sort_by == "-title" %}                                <span class="icon icon-arrow-top"></span>                            {% endif %}                        </a></small> </th>                        <th class="col-date"> <small><a data-sort_by="{% if sort_by == "date" %}-{% endif %}date" href="?sort_by={% if sort_by == "date" %}-{% endif %}date">{% trans "Last Change" %}                            {% if sort_by == "date" %}                                <span class="icon icon-arrow-down"></span>                            {% elif sort_by == "-date" %}                                <span class="icon icon-arrow-top"></span>                            {% endif %}                        </a></small> </th>                        <th> <small>{% trans "Status" %}</small> </th>                        <th> <small>{% trans "Actions" %}</small> </th>                    </tr>                </thead>                <tbody>                    {% if page.object_list %}                    {% for festival in page.object_list %}                    {% tags_for_object festival as tags %}                    <tr>                        <td class="item">                            <a href="{% url "change_festival" slug=festival.slug %}"><b>{{ festival.title }}</b></a>                        </td>                        <td class="date">{{ festival.modified_date|default:festival.creation_date|date:"d.m.Y H:i" }}</td>                        <td>                            <div class="status">                                <select class="status-switch" data-url="{% url "change_festival_status" slug=festival.slug %}">                                    <option value="draft"{% if festival.status == "draft" %} selected="selected"{% endif %}>{% trans "Draft" %}</option>                                    <option value="published"{% if festival.status == "published" %} selected="selected"{% endif %}>{% trans "Published" %}</option>                                    <option value="import"{% if festival.status == "import" %} selected="selected"{% endif %}>{% trans "Imported" %}</option>                                    <option value="expired"{% if festival.status == "expired" %} selected="selected"{% endif %}>{% trans "Expired" %}</option>                                </select>                            </div>                        </td>                        <td>                            <a href="{{ festival.get_url_path }}?preview" data-toggle="tooltip" data-placement="top" data-original-title="{% trans "Preview" %}" class="btn btn-sm btn-icon btn-link" target="_blank">                                <span class="icon icon-eye-open"></span>                                <span class="sr-only">{% trans "Preview" %}</span>                            </a>                            {% if_has_perm "festivals.add_festival" %}                                <a href="{% url "duplicate_festival" slug=festival.slug %}" data-toggle="tooltip" data-placement="top" data-original-title="{% trans "Duplicate" %}" class="btn btn-sm btn-icon btn-link duplicate" data-object-title="{{ festival.title }}" data-object-type="{% trans "Festival" %}">                                    <span class="fawesome fa-files-o"></span>                                    <span class="sr-only">{% trans "Remove" %}</span>                                </a>                            {% end_if_has_perm %}                            {% if festival.is_deletable %}                                <a href="{% url "delete_festival" slug=festival.slug %}" data-toggle="tooltip" data-placement="top" data-original-title="{% trans "Delete" %}" class="btn btn-sm btn-icon btn-link delete" data-object-title="{{ festival.title }}" data-object-type="{% trans "Festival" %}">                                    <span class="icon icon-remove"></span>                                    <span class="sr-only">{% trans "Remove" %}</span>                                </a>                            {% endif %}                            {% if festival.status == "published" %} {% endif %}                        </td>                    </tr>                    {% endfor %}                    {% else %}                    <tr>                        <td colspan="4">                            <span class="pull-left">                                {% if status == "published" %} {% trans "There are no published items." %} {% endif %}                                {% if status == "draft" %} {% trans "There are no draft items." %} {% endif %}                                {% if status == "expired" %} {% trans "There are no expired items." %} {% endif %}                            </span>                        </td>                    </tr>                    {% endif %}                </tbody>            </table>            {% include "utils/dashboard_pagination.html" %}        </div>    </div>    {% include "utils/dashboard_delete.html" %}    {% include "utils/dashboard_duplicate.html" %}    <script>        $('#dashboard_search').submit(function(e) {            e.preventDefault();            append_to_get({q: $('#q').val()});        });        $('#status_filter').change(function() {            append_to_get({status: $(this).val()});        });        $(function() {            $('.status').hover(function() {                $(this).addClass('hover');            }, function() {                $(this).removeClass('hover');            }).mouseleave();            $('.status-switch').change(function() {                var $this = $(this);                $.post($this.attr('data-url'), {'status': $this.val()}, function(data) {});            });            $('.dashboard-table').each(function() {                var $table = $(this);                var sorted_by = $table.data('sorted_by');                $table.find('th.col-title a').click(function(e) {                    e.preventDefault();                    append_to_get({sort_by: $(this).data('sort_by')});                });                $table.find('th.col-date a').click(function(e) {                    e.preventDefault();                    append_to_get({sort_by: $(this).data('sort_by')});                });            });        });        $("select").selectbox();    </script>{% endblock %}