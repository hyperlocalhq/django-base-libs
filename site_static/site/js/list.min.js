!function(t,i){function a(){var i=t("#container"),a=t("#item-preview");if(a.length){var e=a.find(".description"),r=a.position().left,n=i.width(),o=parseInt(i.css("margin-left"),10),l=parseInt(i.css("margin-right"),10);e.css({left:-r,width:n+o+l}),isotope_list()}}function e(){if(!navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|IEMobile|Opera Mini|webOS/i)){var i=t(".pagination").removeClass("item").hide(),a=t("#container").data("jscroll",null);i.length&&a.jscroll({loadingHtml:"<small>Loading...</small>",contentSelector:"#container .isotope",nextSelector:".next_page:last",pagingSelector:".pagination",callback:function(){t(".pagination").removeClass("item").hide(),isotope_list(),lazyload_images()}})}}var r="click";navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|IEMobile|Opera Mini|webOS/i)&&(r="touchstart"),t(function(){e(),t("#map-list-link").click(function(){return location.href=t(this).attr("href")+location.hash,!1}),t("#container").on("click",".item>a",function(){var i=t(this).closest(".item");if(a(),i.attr("id"))return t("#item-preview").attr("id",""),isotope_list(),lazyload_images(),!1;t("#item-preview").attr("id",""),i.attr("id","item-preview");var e=i.find(".description");return t.trim(e.text())?isotope_list():e.load(i.data("description-src"),function(){t("#container .item .cancel").on("click",function(){t("#item-preview").attr("id",""),isotope_list(),lazyload_images()}),a(),window.init_share&&window.init_share()}),!1})}),t(window).bind("smartresize",a),t(window).load(function(){var i=t("#container"),a={};if(i.length){var n=t("#filters"),o=t("#filter-summary"),l={},s=!1;t(".filter a").on(r,function(r,n){if(r.preventDefault(),!s||n){s=!0;var c=t(this),d=c.closest("li"),p=c.closest(".option-set"),v=p.attr("data-filter-group");a[v]=a[v]||[];var u=c.attr("data-filter-value"),f=p.attr("data-single-selection"),m=p.attr("data-hierarchical"),g=parseInt(d.attr("data-level"),10),h=c.attr("data-level-1-at"),w=c.attr("data-target"),_;h?_=t(h):1===g&&(_=c.closest(".level-1-container"));var y=d.data("param"),k=d.data("value");if(u)if(d.hasClass("active"))d.removeClass("active"),_&&0===g&&(t("li.active>a",_).trigger("click",[!0]),t("ul.in",_).removeClass("in")),a[v]=t.grep(a[v],function(t){return t!==u}),t('li[data-param="'+y+'"]',o).remove(),1===o.children().length&&o.empty(),l[y]=!1;else{m?f?0===g?(t("li.active>a",p).trigger("click",[!0]),_&&t("ul.in",_).removeClass("in"),a[v]=[u]):(_&&t("li.active>a",_).trigger("click",[!0]),a[v].push(u)):a[v].push(u):f?(t("li.active>a",p).trigger("click",[!0]),a[v]=[u]):a[v].push(u),l[y]=k,d.addClass("active"),_&&t(w,_).addClass("in");var b;""===o.text().trim()&&(b=t("<li><b>"+window.str_filter_selection+":</b></li>"),o.append(b)),b=t('<li data-filter-group="'+v+'" data-filter-value="'+u+'" data-param="'+y+'" data-value="'+k+'"><a href="">'+c.text()+"</a></li>"),o.append(b),o.css("display","block")}var C=[],j=[];for(var z in a)for(var P=0;P<a[z].length;P++){var S=a[z][P].replace(/\./,"");j.push(S)}var x="?"+window.append_to_get(l,!0);return window.history.pushState({},document.title,x),n||(t("#container").jscroll.destroy&&t("#container").jscroll.destroy(),t("#container").load(x+" #container>*",function(){e(),setTimeout(function(){isotope_list(),lazyload_images()},500)})),i.trigger("map_filter",{filter:j}),s=!1,!1}}),o.on(r,"a",function(){var i=t(this).closest("li"),a=i.data("param"),e=i.data("value");return a?t('li.active[data-param="'+a+'"][data-value="'+e+'"]>a',n).click():t("li.active>a",n).click(),!1}),t("#filter-reset").on(r,function(){return t(t("li.active>a",n).get().reverse()).trigger("click",[!0]),t("#container").jscroll.destroy&&t("#container").jscroll.destroy(),t("#container").load("? #container>*",function(){e(),isotope_list(),lazyload_images()}),!1})}}),t(window).load(function(){setTimeout(function(){t("body").removeClass("no-transition")},1e3)})}(jQuery);