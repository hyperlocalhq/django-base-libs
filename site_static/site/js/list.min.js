!function(t,i){function a(){var i=t("#container"),a=t("#item-preview");if(a.length){var e=a.find(".description"),r=a.position().left,n=i.width(),o=parseInt(i.css("margin-left"),10),l=parseInt(i.css("margin-right"),10);e.css({left:-r,width:n+o+l}),isotope_list()}}function e(){if(!navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|IEMobile|Opera Mini|webOS/i)){var i=t(".pagination").removeClass("item").hide(),a=t("#container").data("jscroll",null);i.length&&a.jscroll({loadingHtml:"<small>Loading...</small>",contentSelector:"#container .isotope",nextSelector:".next_page:last",pagingSelector:".pagination",callback:function(){t(".pagination").removeClass("item").hide(),isotope_list(),lazyload_images()}})}}var r="click";navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|IEMobile|Opera Mini|webOS/i)&&(r="touchstart"),t(function(){e(),t("#map-list-link").click(function(){return location.href=t(this).attr("href")+location.hash,!1}),t("#container").on("click",".item>a",function(){var i=t(this).closest(".item");if(a(),i.attr("id"))return t("#item-preview").attr("id",""),isotope_list(),lazyload_images(),!1;t("#item-preview").attr("id",""),i.attr("id","item-preview");var e=i.find(".description");return t.trim(e.text())?isotope_list():e.load(i.data("description-src"),function(){t("#container .item .cancel").on("click",function(){t("#item-preview").attr("id",""),isotope_list(),lazyload_images()}),a(),window.init_share&&window.init_share()}),!1})}),t(window).bind("smartresize",a),t(window).load(function(){var i=t("#container"),a={};if(i.length){var n=t("#filters"),o=t("#filter-summary"),l={},s=!1;t(".filter a").on(r,function(n,c){if(n.preventDefault(),!s||c){s=!0;var d=t(this),p=d.closest("li"),v=d.closest(".option-set"),u=v.attr("data-filter-group");a[u]=a[u]||[];var f=d.attr("data-filter-value"),g=v.attr("data-single-selection"),m=v.attr("data-hierarchical"),h=parseInt(p.attr("data-level"),10),w=d.attr("data-level-1-at"),_=d.attr("data-target"),y;w?y=t(w):1===h&&(y=d.closest(".level-1-container"));var b=p.data("param"),k=p.data("value");if(f)if(p.hasClass("active"))p.removeClass("active"),y&&0===h&&(t("li.active>a",y).trigger(r,[!0]),t("ul.in",y).removeClass("in")),a[u]=t.grep(a[u],function(t){return t!==f}),t('li[data-param="'+b+'"]',o).remove(),1===o.children().length&&o.empty(),l[b]=!1;else{m?g?0===h?(t("li.active>a",v).trigger(r,[!0]),y&&t("ul.in",y).removeClass("in"),a[u]=[f]):(y&&t("li.active>a",y).trigger(r,[!0]),a[u].push(f)):a[u].push(f):g?(t("li.active>a",v).trigger(r,[!0]),a[u]=[f]):a[u].push(f),l[b]=k,p.addClass("active"),y&&t(_,y).addClass("in");var C;""===o.text().trim()&&(C=t("<li><b>"+window.str_filter_selection+":</b></li>"),o.append(C)),C=t('<li data-filter-group="'+u+'" data-filter-value="'+f+'" data-param="'+b+'" data-value="'+k+'"><a href="">'+d.text()+"</a></li>"),o.append(C),o.css("display","block")}var j=[],z=[];for(var P in a)for(var S=0;S<a[P].length;S++){var x=a[P][S].replace(/\./,"");z.push(x)}l.page="";var I="?"+window.append_to_get(l,!0);return window.history.pushState({},document.title,I),c?s=!1:(t("#container").jscroll.destroy&&t("#container").jscroll.destroy(),t("#container").load(I+" #container>*",function(){e(),setTimeout(function(){isotope_list(),lazyload_images(),s=!1},500)})),i.trigger("map_filter",{filter:z}),!1}}),o.on(r,"a",function(i){i.preventDefault();var a=t(this).closest("li"),e=a.data("param"),o=a.data("value");e?t('li.active[data-param="'+e+'"][data-value="'+o+'"]>a',n).trigger(r):t("li.active>a",n).trigger(r)}),t("#filter-reset").on(r,function(i){i.preventDefault(),t(t("li.active>a",n).get().reverse()).trigger(r,[!0]),t("#container").jscroll.destroy&&t("#container").jscroll.destroy(),t("#container").load("? #container>*",function(){e(),isotope_list(),lazyload_images()})})}}),t(window).load(function(){setTimeout(function(){t("body").removeClass("no-transition")},1e3)})}(jQuery);