/* jshint unused:false, eqnull:false, sub:true *//* global $:false *//* global lazyload_images:false *//* global isotope_list:false */(function(e,t){function r(){var t=e("#container"),n=e("#item-preview");if(!n.length)return;var r=n.find(".description"),i=n.position().left,s=t.width(),o=parseInt(t.css("margin-left"),10),u=parseInt(t.css("margin-right"),10);r.css({left:-i,width:s+o+u});isotope_list()}function i(){if(!navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|IEMobile|Opera Mini|webOS/i)){var t=e(".pagination").removeClass("item").hide(),n=e("#container").data("jscroll",null);t.length&&n.jscroll({loadingHtml:"<small>Loading...</small>",contentSelector:"#container .isotope",nextSelector:".next_page:last",pagingSelector:".pagination",callback:function(){e(".pagination").removeClass("item").hide();isotope_list();lazyload_images()}})}}var n="click";navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|IEMobile|Opera Mini|webOS/i)&&(n="touchstart");e(function(){i();e("#map-list-link").click(function(){location.href=e(this).attr("href")+location.hash;return!1});e("#container").on("click",".item>a",function(){var t=e(this).closest(".item");r();if(t.attr("id")){e("#item-preview").attr("id","");isotope_list();lazyload_images();return!1}e("#item-preview").attr("id","");t.attr("id","item-preview");var n=t.find(".description");e.trim(n.text())?isotope_list():n.load(t.data("description-src"),function(){e("#container .item .cancel").on("click",function(){e("#item-preview").attr("id","");isotope_list();lazyload_images()});r();window.init_share&&window.init_share()});return!1})});e(window).bind("smartresize",r);e(window).load(function(){var t=e("#container"),r={};if(!t.length)return;var s=e("#filters"),o=e("#filter-summary"),u={},a=!1;e(".filter a").on(n,function(n,s){n.preventDefault();if(a&&!s)return;a=!0;var f=e(this),l=f.closest("li"),c=f.closest(".option-set"),h=c.attr("data-filter-group");r[h]=r[h]||[];var p=f.attr("data-filter-value"),d=c.attr("data-single-selection"),v=c.attr("data-hierarchical"),m=parseInt(l.attr("data-level"),10),g=f.attr("data-level-1-at"),y=f.attr("data-target"),b;g?b=e(g):m===1&&(b=f.closest(".level-1-container"));var w=l.data("param"),E=l.data("value");if(p)if(l.hasClass("active")){l.removeClass("active");if(b&&m===0){e("li.active>a",b).trigger("click",[!0]);e("ul.in",b).removeClass("in")}r[h]=e.grep(r[h],function(e){return e!==p});e('li[data-param="'+w+'"]',o).remove();o.children().length===1&&o.empty();u[w]=!1}else{if(v)if(d)if(m===0){e("li.active>a",c).trigger("click",[!0]);b&&e("ul.in",b).removeClass("in");r[h]=[p]}else{b&&e("li.active>a",b).trigger("click",[!0]);r[h].push(p)}else r[h].push(p);else if(d){e("li.active>a",c).trigger("click",[!0]);r[h]=[p]}else r[h].push(p);u[w]=E;l.addClass("active");b&&e(y,b).addClass("in");var S;if(o.text().trim()===""){S=e("<li><b>"+window.str_filter_selection+":</b></li>");o.append(S)}S=e('<li data-filter-group="'+h+'" data-filter-value="'+p+'" data-param="'+w+'" data-value="'+E+'"><a href="">'+f.text()+"</a></li>");o.append(S);o.css("display","block")}var x=[],T=[];for(var N in r)for(var C=0;C<r[N].length;C++){var k=r[N][C].replace(/\./,"");T.push(k)}var L="?"+window.append_to_get(u,!0);window.history.pushState({},document.title,L);if(!s){e("#container").jscroll.destroy&&e("#container").jscroll.destroy();e("#container").load(L+" #container>*",function(){i();setTimeout(function(){isotope_list();lazyload_images()},500)})}t.trigger("map_filter",{filter:T});a=!1;return!1});o.on(n,"a",function(){var t=e(this).closest("li"),n=t.data("param"),r=t.data("value");n?e('li.active[data-param="'+n+'"][data-value="'+r+'"]>a',s).click():e("li.active>a",s).click();return!1});e("#filter-reset").on(n,function(){e(e("li.active>a",s).get().reverse()).trigger("click",[!0]);e("#container").jscroll.destroy&&e("#container").jscroll.destroy();e("#container").load("? #container>*",function(){i();isotope_list();lazyload_images()});return!1})});e(window).load(function(){setTimeout(function(){e("body").removeClass("no-transition")},1e3)})})(jQuery);