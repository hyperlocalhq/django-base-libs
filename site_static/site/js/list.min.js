/* jshint unused:false, eqnull:false, sub:true *//* global $:false *//* global lazyload_images:false *//* global isotope_list:false *//* global console:false */(function(e,t){function r(){var t=e("#container"),n=e("#item-preview");if(!n.length)return;var r=n.find(".description"),i=n.position().left,s=t.width(),o=parseInt(t.css("margin-left"),10),u=parseInt(t.css("margin-right"),10);r.css({left:-i,width:s+o+u});isotope_list()}function i(){if(!navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|IEMobile|Opera Mini|webOS/i)){var t=e(".pagination").removeClass("item").hide(),n=e("#container").data("jscroll",null);t.length&&n.jscroll({loadingHtml:"<small>Loading...</small>",contentSelector:"#container .isotope",nextSelector:".next_page:last",pagingSelector:".pagination",callback:function(){e(".pagination").removeClass("item").hide();isotope_list();lazyload_images()}})}}var n="click";navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|IEMobile|Opera Mini|webOS/i)&&(n="touchstart");e(function(){i();e("#map-list-link").click(function(){location.href=e(this).attr("href")+location.hash;return!1});e("#container").on("click",".item>a",function(){var t=e(this).closest(".item");r();if(t.attr("id")){e("#item-preview").attr("id","");isotope_list();lazyload_images();return!1}e("#item-preview").attr("id","");t.attr("id","item-preview");var n=t.find(".description");e.trim(n.text())?isotope_list():n.load(t.data("description-src"),function(){e("#container .item .cancel").on("click",function(){e("#item-preview").attr("id","");isotope_list();lazyload_images()});r();window.init_share&&window.init_share()});return!1})});e(window).bind("smartresize",r);e(window).load(function(){var t=e("#container"),r={};if(!t.length)return;var s=e("#filters"),o=e("#filter-summary"),u={},a=!1;e(".filter a").on(n,function(s,f){s.preventDefault();if(a&&!f)return;a=!0;var l=e(this),c=l.closest("li"),h=l.closest(".option-set"),p=h.attr("data-filter-group");r[p]=r[p]||[];var d=l.attr("data-filter-value"),v=h.attr("data-single-selection"),m=h.attr("data-hierarchical"),g=parseInt(c.attr("data-level"),10),y=l.attr("data-level-1-at"),b=l.attr("data-target"),w;y?w=e(y):g===1&&(w=l.closest(".level-1-container"));var E=c.data("param"),S=c.data("value");if(d)if(c.hasClass("active")){c.removeClass("active");if(w&&g===0){e("li.active>a",w).trigger(n,[!0]);e("ul.in",w).removeClass("in")}r[p]=e.grep(r[p],function(e){return e!==d});e('li[data-param="'+E+'"]',o).remove();o.children().length===1&&o.empty();u[E]=!1}else{if(m)if(v)if(g===0){e("li.active>a",h).trigger(n,[!0]);w&&e("ul.in",w).removeClass("in");r[p]=[d]}else{w&&e("li.active>a",w).trigger(n,[!0]);r[p].push(d)}else r[p].push(d);else if(v){e("li.active>a",h).trigger(n,[!0]);r[p]=[d]}else r[p].push(d);u[E]=S;c.addClass("active");w&&e(b,w).addClass("in");var x;if(o.text().trim()===""){x=e("<li><b>"+window.str_filter_selection+":</b></li>");o.append(x)}x=e('<li data-filter-group="'+p+'" data-filter-value="'+d+'" data-param="'+E+'" data-value="'+S+'"><a href="">'+l.text()+"</a></li>");o.append(x);o.css("display","block")}var T=[],N=[];for(var C in r)for(var k=0;k<r[C].length;k++){var L=r[C][k].replace(/\./,"");N.push(L)}u.page="";var A="?"+window.append_to_get(u,!0);window.history.pushState({},document.title,A);if(!f){e("#container").jscroll.destroy&&e("#container").jscroll.destroy();e("#container").load(A+" #container>*",function(){i();setTimeout(function(){isotope_list();lazyload_images();a=!1},500)})}else a=!1;t.trigger("map_filter",{filter:N});return!1});o.on(n,"a",function(t){t.preventDefault();var r=e(this).closest("li"),i=r.data("param"),o=r.data("value");i?e('li.active[data-param="'+i+'"][data-value="'+o+'"]>a',s).trigger(n):e("li.active>a",s).trigger(n)});e("#filter-reset").on(n,function(t){t.preventDefault();e(e("li.active>a",s).get().reverse()).trigger(n,[!0]);e("#container").jscroll.destroy&&e("#container").jscroll.destroy();e("#container").load("? #container>*",function(){i();isotope_list();lazyload_images()})})});e(window).load(function(){setTimeout(function(){e("body").removeClass("no-transition")},1e3)})})(jQuery);