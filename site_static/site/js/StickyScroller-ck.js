/*****************************************************************************/// Class Scroller
// Purpose: Create a fixed scroller
// Parameters:
//  obj: The object that will be scrolling
//  start: What distance from the top (in px) the effect starts
//  end: What distance from the top (in px) the effect ends
//  interval: What scroll distance triggers the callback
//  range: How many pixels after the
//  margin: Margin from the top of the browser
// Dependencies:
//  GetSet class. Included in Vert Library @ http://vertstudios.com/vertlib.js
/******************************************************************************/function StickyScroller(e,t){typeof StickyScroller.counter=="undefined"?StickyScroller.counter=0:StickyScroller.counter++;var n=this,r=$(e).css("top"),i=$(e).css("left"),s=$(e).css("right"),o=0,u=0,a={start:0,end:1e4,interval:$(e).height(),margin:parseInt(r,10),range:$(e).height()},f=jQuery.extend(a,t);e=$(e);f.index=0;f.oldIndex=0;GetSet.getters({scope:n,obj:f});var l={};l.newIndex=function(){};l.limbo=function(){};l.scroll=function(){};GetSet.setters({scope:this,prefix:"on",obj:l});this.distanceFrom=function(e){var t=e*f.interval+f.start,n=e*f.interval+f.range+f.start,r=Math.abs(o-t),i=Math.abs(o-n);return r<i?r:i};this.closestIndex=function(){if(f.index===0)return 1;var e=this.distanceFrom(f.index-1),t=this.distanceFrom(f.index+1);return e<=t?f.index-1:f.index+1};var c=function(){if(o>f.start&&o<f.end){tempIndex=Math.floor((o-f.start)/f.interval);if(tempIndex!==f.index){f.oldIndex=f.index;f.index=tempIndex}}else if(o>=f.end){f.oldIndex=f.index;f.index=Math.floor((f.end-f.start)/f.interval)}else{f.oldIndex=f.index;f.index=0}};this.firstIndex=function(){return 0};this.lastIndex=function(){return Math.floor((f.end-f.start+f.margin)/f.interval)};this.inRange=function(){var e=f.index*f.interval+f.start,t=f.index*f.interval+f.start+f.range,n=o>=e&&o<=t;return n};var h=$('<div id="scrollcontainer'+StickyScroller.counter+'">').css({width:e.width(),height:e.height(),position:"fixed",top:r,left:i,right:s});e.wrap(h);$(window).scroll(function(){o=$(window).scrollTop();c();if(o<f.start){$(e).css({position:"absolute",top:0,left:0,right:0});$("#scrollcontainer"+StickyScroller.counter).css({position:"absolute",top:r,left:i,right:s})}else if(o>f.end){$(e).css({position:"absolute",top:0,left:0,right:0});$("#scrollcontainer"+StickyScroller.counter).css({position:"absolute",top:f.end+f.margin,left:i,right:s})}else $(e).css({position:"fixed",top:f.margin,left:i,right:s});f.oldIndex!==f.index&&l.newIndex(f.index);!n.inRange()&&o>f.start&&o<f.end&&l.limbo(f.index);l.scroll(f.index)})};