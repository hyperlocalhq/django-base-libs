!function($,t){function e(){lazyload_images();var t=!1;$("#photos").each(function(){var e=$(this).data("load-url");$(this).load(e+" #photos>*",function(){$("#photos").sortable({start:function(){t=!0},stop:function(){setTimeout(function(){t=!1},500)},placeholder:"ui-state-highlight",update:function(t,o){var i=[];$(".photo","#photos").each(function(){$(this).data("token")&&(i[i.length]=$(this).data("token"))}),$.post(e,{ordering:i.join(",")})},forcePlaceholderSize:!0,create:function(){var t=this,e=function(){$(t).css("height","auto")};$(t).find("img").load(e).error(e)}}),$("#photos").disableSelection().find(".edit").click(function(){return t?!1:($("#edit_photo").load($(this).attr("href")+" #edit_photo form",o),$("#photos").parents("fieldset:first").hide(),$(".form-actions:last").hide(),!1)}),$("#add_photo").click(function(){return $("#edit_photo").load($(this).attr("href")+" #edit_photo form",o),$("#photos").parents("fieldset:first").hide(),$(".form-actions:last").hide(),!1}),$("#photos").find(".crop").each(function(){$(this).attr("href")&&$(this).attr("href",$(this).attr("href").replace(/goto_next=.+$/gim,"goto_next="+location.href))}),$(window).trigger("scrollstop")})}),$("#photos").parents("fieldset:first").show(),$(".form-actions:last").show()}function o(){$("textarea").autosize(),$("#button-id-cancel").click(function(){$("#edit_photo").html(""),e()}),$("#button-id-crop-photo").click(function(){location.href=$(this).data("href").replace(/goto_next=.+$/,"goto_next="+location.href)}),$("#button-id-delete-photo").click(function(){var t=$(this).data("href");$("#deleteConfirmation").removeClass("hide").modal("show"),$("#button-id-confirm-deletion").click(function(){return $.post(t,{},function(){$("#deleteConfirmation").modal("hide"),$("#edit_photo").html(""),e()}),!1})}),$("#edit_photo form").attr("target","hidden_iframe"),self.hidden_iframe_loaded=function(t){var i=$("<div>"+t+"</div>").find("form");i.length?($("#edit_photo").html("").append(i),o()):($("#edit_photo").html(""),e())};var t=$.extend(translatable_file_uploader_options,{allowedExtensions:["gif","jpg","png","tif","bmp"],action:"/"+self.settings.lang+"/helper/ajax-upload/",element:$("#image_uploader")[0],multiple:!1,onComplete:function(t,e,o){o.success&&($(".messages").html(""),$("#id_media_file_path").val(o.path),$.post("/"+self.settings.lang+"/helper/modified-path/",{file_path:o.path,mod_sysname:"medium"},function(t,e,o){$("#image_preview").html('<img class="img-responsive" alt="" src="/media/'+t+'" />'),$("#image_uploader").hide(),$("#image_help_text").hide()},"text"))},onAllComplete:function(t){$(".qq-upload-success").fadeOut("slow",function(){$(this).remove()})},params:{csrf_token:$('input[name="csrfmiddlewaretoken"]').val(),csrf_name:"csrfmiddlewaretoken",csrf_xname:"X-CSRFToken"},showMessage:function(t){$(".messages").html('<div class="alert alert-danger">'+t+"</div>")}}),i=new qq.FileUploader(t)}$(document).on("click","#crop_list_image",function(){return location.href=$("#photos").find(".crop_list_image:first").attr("href").replace(/goto_next=.+$/,"goto_next="+location.href),!1}),$(document).on("click","#crop_cover_image",function(){return location.href=$("#photos").find(".crop_cover_image:first").attr("href").replace(/goto_next=.+$/,"goto_next="+location.href),!1}),$(function(){e()})}(jQuery);