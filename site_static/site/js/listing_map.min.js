(function(e){e.fn.autoscroll=function(){e("html,body").animate({scrollLeft:this.offset().left,scrollTop:this.offset().top},500);return this}})(jQuery);var oMap;(function(e,t){function s(){n&&n.close();self.aGeopositions=[];for(var e=0,t=r.length;e<t;e++)r[e].setMap(null);r=[]}function o(){var t=long_min=500,n=long_max=-500,i=[],s=self.settings.STATIC_URL+"site/img/marker_default.png",o=self.settings.STATIC_URL+"site/img/marker_selected.png",u=null,f="";if(window.location.hash){var l=window.location.hash?e.deparam.fragment(window.location.hash,!0):{};f=l.object_id}e(self.aGeopositions).each(function(a,l){var c=l.latitude,h=l.longitude;n<c&&(n=c);c<t&&(t=c);long_max<h&&(long_max=h);h<long_min&&(long_min=h);var p=new google.maps.LatLng(c,h),d=new google.maps.MarkerImage(s),v=new google.maps.Marker({position:p,map:oMap,icon:d});v.list_index=a;var m=e(this);google.maps.event.addListener(v,"click",function(){u&&u!=v&&u.setIcon(s);v.setIcon(o);u=v;e.bbq.pushState({object_id:v.object_id});e("#map-description").load(l.html_src,function(){e(".row-map").removeClass("map-only");google.maps.event.trigger(oMap,"resize")})});v.categories=l.categories;v.object_id=l.object_id;r.push(v);i.push(p);l.object_id==f&&(u=v)});navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var n=self.settings.STATIC_URL+"site/img/marker_current.png",r=new google.maps.Marker({position:new google.maps.LatLng(t.coords.latitude,t.coords.longitude),map:oMap,icon:n});r.setZIndex(999);google.maps.event.addListener(r,"click",function(){e("#map-description").html("You are here!")})},function(){},{enableHighAccuracy:!0});document.location.search&&a(oMap,i);if(u){oMap.setCenter(u.getPosition());google.maps.event.trigger(u,"click")}}function u(t,n){var i=n.filter;e(r).each(function(){var e=this,t=!0,n=i.length,r,s,o;for(r=0;r<n;r++){o=i[r];s=new RegExp("\\b"+o+"\\b");if(!e.categories.match(s)){t=!1;break}}e.setVisible(t)})}function a(e,t){var n=new google.maps.LatLngBounds;for(var r=0,i=t.length;r<i;r++)n.extend(t[r]);var s=n.getNorthEast();n.extend(new google.maps.LatLng(s.lat()-.005,s.lng()-.005));var o=n.getNorthEast();n.extend(new google.maps.LatLng(o.lat()+.005,o.lng()+.005));e.fitBounds(n)}var n,r=[],i=null;e(document).ready(function(){var t=e("body");if(t.length){var n={zoom:13,mapTypeControl:!1,zoomControl:!0,streetViewControl:!0,center:new google.maps.LatLng(52.515306,13.363863),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}},r=document.getElementById("gmap");r&&(oMap=new google.maps.Map(r,n));t.bind("before_list_load",s).bind("after_list_load",o).bind("map_filter",u);t.trigger("after_list_load")}})})(jQuery);$(document).ready(function(){$("#map-toggle").click(function(){$(".row-map").toggleClass("map-only");google.maps.event.trigger(oMap,"resize");return!1});$("#cancel-map-sidebar").click(function(){$(".row-map").addClass("map-only");google.maps.event.trigger(oMap,"resize");return!1})});