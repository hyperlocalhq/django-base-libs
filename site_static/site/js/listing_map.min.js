/* jshint unused:false, eqnull:false *//* global self: false *//* global jQuery: false *//* global google: false *//* global lazyload_images: false *//* global oMap: true *//* global oCurrentLocationMarker: true */(function(e){e.fn.autoscroll=function(){e("html,body").animate({scrollLeft:this.offset().left,scrollTop:this.offset().top},500);return this}})(jQuery);var oMap,oCurrentLocationMarker;(function(e,t){function s(){n&&n.close();self.aGeopositions=[];for(var e=0,t=r.length;e<t;e++)r[e].setMap(null);r=[]}function o(){var t=500,n=500,i=-500,s=-500,o=[],u=self.settings.STATIC_URL+"site/img/marker_default.png",f=self.settings.STATIC_URL+"site/img/marker_selected.png",l=new google.maps.MarkerImage(u,null,null,null,new google.maps.Size(25,35)),c=new google.maps.MarkerImage(f,null,null,null,new google.maps.Size(25,35)),h=null,p="";if(window.location.hash){var d=window.location.hash?e.deparam.fragment(window.location.hash,!0):{};p=d.object_id}e(self.aGeopositions).each(function(u,a){var f=a.latitude,d=a.longitude;i<f&&(i=f);f<t&&(t=f);s<d&&(s=d);d<n&&(n=d);var v=new google.maps.LatLng(f,d),m=new google.maps.Marker({position:v,map:oMap,icon:l});m.list_index=u;var g=e(this);google.maps.event.addListener(m,"click",function(){h&&h!==m&&h.setIcon(l);m.setIcon(c);h=m;e.bbq.pushState({object_id:m.object_id});e("#map-description").load(a.html_src,function(){e("body").removeClass("map-only");e("#map-sidebar").removeClass("map-list").removeClass("map-filter").addClass("map-description");google.maps.event.trigger(oMap,"resize");lazyload_images()})});m.categories=a.categories;m.object_id=a.object_id;r.push(m);o.push(v);a.object_id===p&&(h=m)});navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var n=new google.maps.MarkerImage(self.settings.STATIC_URL+"site/img/marker_current.gif",null,null,null,new google.maps.Size(16,16));oCurrentLocationMarker=new google.maps.Marker({position:new google.maps.LatLng(t.coords.latitude,t.coords.longitude),map:oMap,icon:n,optimized:!1});oCurrentLocationMarker.setZIndex(999);e("#show-current-location").removeClass("hidden")},function(){},{enableHighAccuracy:!0});document.location.search&&a(oMap,o);if(h){oMap.setCenter(h.getPosition());google.maps.event.trigger(h,"click")}}function u(t,n){var i=n.filter;e(r).each(function(){var e=this,t=!0,n=i.length,r,s,o;for(r=0;r<n;r++){o=i[r];s=new RegExp("\\b"+o+"\\b");if(!e.categories.match(s)){t=!1;break}}e.setVisible(t)})}function a(e,t){var n=new google.maps.LatLngBounds;for(var r=0,i=t.length;r<i;r++)n.extend(t[r]);var s=n.getNorthEast();n.extend(new google.maps.LatLng(s.lat()-.005,s.lng()-.005));var o=n.getNorthEast();n.extend(new google.maps.LatLng(o.lat()+.005,o.lng()+.005));e.fitBounds(n)}var n,r=[],i=null;e(document).ready(function(){var t=e("body");if(t.length){var n={zoom:14,panControl:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,center:new google.maps.LatLng(52.515306,13.363863),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}},r=document.getElementById("gmap");r&&(oMap=new google.maps.Map(r,n));t.bind("before_list_load",s).bind("after_list_load",o).bind("map_filter",u);t.trigger("after_list_load")}})})(jQuery);$(window).load(function(){setTimeout(function(){$("body").removeClass("no-transition")},100)});$(document).ready(function(){$("#container .item a").click(function(){$("#map-description").load($(this).closest(".item").data("description-src"),function(){$("#map-sidebar").removeClass("map-list").addClass("map-description");lazyload_images()});return!1});$(document).on("click","#cancel-description",function(){$("#map-sidebar").removeClass("map-description").addClass("map-list");return!1});$(document).on("click","#cancel-filter",function(){$("#map-sidebar").removeClass("map-filter").addClass("map-list");return!1});$(document).on("click","#cancel-list",function(){$("body").toggleClass("map-only");setTimeout(function(){google.maps.event.trigger(oMap,"resize")},500);return!1});$("#toggle-map-filter").click(function(){$("#map-sidebar").toggleClass("map-filter").removeClass("map-list");google.maps.event.trigger(oMap,"resize");return!1});$("#toggle-sidebar").click(function(){$("body").toggleClass("map-only");setTimeout(function(){google.maps.event.trigger(oMap,"resize")},500)});$("#show-current-location").click(function(){oMap.setCenter(oCurrentLocationMarker.getPosition());return!1});var e=document.referrer;$("#cancel-map").click(function(){e||(e="../");location.href=e;return!1})});