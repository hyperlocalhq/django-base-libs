{% extends "admin/change_list.html" %}

<!-- LOADING -->
{% load staticfiles tree_admin_list admin_list i18n grp_tags %}

<!-- OBJECT-TOOLS -->
{% block object-tools %}
    {% if has_add_permission %}
        <ul class="tools">
            <li>
                <a href="add/{% if is_popup %}?_popup=1{% endif %}" class="focus">
                    {% blocktrans with cl.opts.verbose_name as name %}Add {{ name }}{% endblocktrans %}
                </a>
            </li>
        </ul>
    {% endif %}
{% endblock %}

<!-- CONTENT -->
{% block content %}
    <div id="content-main">
        
        <!-- Message about Javascript -->
		<noscript>
			{% if dragdrop_allowed %}
				<p class="errornote"><b>{% trans 'Note' %}:</b> {% trans "You will have to activate JavaScript in your browser's settings to display the hierarchical structure correctly and to be able to reorder the items." %}</p>
			{% else %}
				<p class="errornote"><b>{% trans 'Note' %}:</b> {% trans "You will have to activate JavaScript in your browser's settings to be able to display the hierarchical structure correctly." %}</p>			
			{% endif %}
		</noscript>
		

        <!-- Message about dragging and dropping -->
        {% if dragdrop_allowed %}
            <div><p class="small">{% blocktrans with cl.opts.verbose_name|escape as name %}Here you can edit the order of a {{ name }}. Drag and drop a {{ name }} to change the order or hierarchy structure.{% endblocktrans %}</p></div>
            <br clear="all" />
        {% endif %}
        
        
        <!-- Sidebar -->
        {% block filters %}
            {% if cl.has_filters or cl.search_fields or cl.date_hierarchy %}
                <div class="module changelist-filters">
                    
                    {% pagination cl %}
                    
                    {% if cl.has_filters or search_form %}
                        {% if cl.has_filters %}
                            <!-- FILTERS -->
                            <div id="filters" class="module filter span-6">
                                <div class="pulldown-container">
                                    <a href="javascript://" class="button toggle-filters">{% trans 'Filter' %}</a>
                                    <div class="filter-pulldown">
                                        {% for spec in cl.filter_specs %}{% admin_list_filter cl spec %}{% endfor %}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        <!-- SEARCH -->
                        {% if not search_form %}
                            <div id="search" class="module search span-6">
                                {% block search %}{% search_form cl %}{% endblock %}
                            </div>
                        {% endif %}
                    {% endif %}
                    <br clear="all" />
                </div>
                <!-- DATE HIERARCHY -->
                {% if cl.date_hierarchy %}
                    {% date_hierarchy cl %}
                {% endif %}
            {% endif %}
        {% endblock %}
        
        <!-- Changelist -->
        <form action="" method="post"{% if cl.formset.is_multipart %} enctype="multipart/form-data"{% endif %}>{% csrf_token %}
            <div id="changelist" class="container-full{% if cl.has_filters or cl.search_fields or cl.date_hierarchy %} filtered{% endif %}">
                <!-- POPUP -->
                {% if is_popup %}<input type="hidden" name="_popup" value="1" />{% endif %}
                
                <!-- ERRORS -->
                {% if cl.formset.errors %}
                    <p class="errornote">
                    {% blocktrans count cl.formset.errors|length as counter %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktrans %}
                    </p>
                    <ul class="errorlist">{% for error in cl.formset.non_field_errors %}<li>{{ error }}</li>{% endfor %}</ul>
                {% endif %}
        
                <!-- MANAGEMENT FORM -->
                {% if cl.formset %}
                    {{ cl.formset.management_form }}
                {% endif %}
                
                <!-- CHANGELIST-RESULTS -->
                <div class="result-list-container">
                    {% block result_list %}
                        {% tree_result_list cl %}                        
                    {% endblock %}
                </div>
            </div><br clear="all" />
            {{ media }}

            <!-- SUBMIT ROW -->
            <div id="submit" class="module footer">
                <input id="tree_data" name="tree_data" type="hidden" {% if dragdrop_allowed %}class="dragdrop_allowed" {% endif %}/>
                <ul class="submit-row">
                    {% if dragdrop_allowed %}
                        <li class="submit-button-container"><input type="submit" value="{% trans 'Save all changes' %}" class="save_all default" /></li>
                    {% endif %}  						
                    <li><input type="button" value="{% trans 'Expand all' %}" class="expand_all" /></li>
                    <li><input type="button" value="{% trans 'Collapse all' %}" class="collapse_all" /></li>
                </ul>
            </div>
        </form>
    </div>
{% endblock %}
