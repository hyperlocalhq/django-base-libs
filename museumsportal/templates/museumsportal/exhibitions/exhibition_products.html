{% extends "base.html" %}
{% load base_tags i18n image_modifications tagging_tags babel auth_extended fb_tags infoblocks favorites cms_tags %}
{% block title %}{% trans "Museum" %} – {{ object.title }} – {% endblock %}
{% block bodyclass %}museum-detail shop-product-list{% endblock %}

{% block open_graph %}
    <meta property="og:title" content="{{ object.title }}" />
    <meta property="og:type" content="article" />
    {% if object.image %}
      <meta property="og:image" content="{{ current_website_url }}{{ MEDIA_URL }}{{ object.image|modified_path:"og" }}" />
    {% else %}
      <meta property="og:image" content="{{ current_website_url }}{{ STATIC_URL }}site/img/museumsportal_opengraph.png" />
    {% endif %}
    <meta property="og:url" content="{{ object.get_url }}" />
    <meta property="og:site_name" content="Museumsportal Berlin" />
    <meta property="og:description" content="{{ object.get_rendered_description|striptags|truncatewords:20|escape }}" />
{% endblock %}

{% block content %}
  {% with object as museum %}
    <div id="museum" class="content">
      <div class="container">
        <h1><a href="{{ museum.get_url_path }}">{{ museum.title }}</a>
          {% if_has_perm "museums.change_museum" object %}
            {% if not request.is_mobile %}
              <span class="cms_edit"><a class="icon icon-pencil" data-toggle="tooltip" data-placement="bottom" data-original-title="{% trans "Edit" %}" href="{{ request.path }}change/">&nbsp;<span class="sr-only">{% trans "Edit" %}</span></a></span>
            {% endif %}
          {% end_if_has_perm %}
        </h1>
        {% if museum.subtitle %}
        <h2>{{ museum.subtitle }}</h2>
        {% endif %}
      </div>
    </div>

      <!-- ======= Products ======= -->

      {% if object_list %}
          <div id="list">
              <div class="container">
                  <header class="clearfix">
                      <h2 class="section-head pull-left" id="section-related-products">{% trans "Products" %}</h2>
                      <a class="pull-right" href="{% page_url "shop" %}">{% page_attribute "menu_title" "shop" %}</a>
                  </header>
                  <div id="container">
                      <div class="row row-md grid">
                          {% for product in object_list %}
                              <div class="item col-xs-12 col-sm-4 col-md-4 col-lg-3{% if forloop.counter == 4 %} hidden-sm hidden-md{% endif %}">
                                  <a href="{{ product.get_url_path }}">
                                      {% if product.image %}
                                          {% with product.image|file_description as file_desc %}
                                              <span class="img"><span class="photo-credits-wrapper"><img src="{{ STATIC_URL }}site/img/placeholder_editorial.gif" data-original="{{ MEDIA_URL }}{{ product.image|modified_path:"editorial" }}" alt="{% if file_desc.description %}{{ file_desc.description|remove_newlines|escape }}{% else %}{{ product.title }}{% endif %}"/>{% if file_desc.author %}<span class="photo-credits-over">{{ file_desc.author }}</span>{% endif %}</span></span>
                                          {% endwith %}
                                      {% endif %}
                                      {% if product.price %}
                                          <span class="price pull-right">{{ product.price|currencyfmt:"€" }}</span>
                                      {% endif %}
                                      <h3>
                                          {{ product.title }}
                                      </h3>
                                      {% if product.subtitle %}
                                          <h4>{{ product.subtitle }}</h4>
                                      {% endif %}
                                  </a>
                              </div>
                          {% endfor %}
                      </div>
                  </div>
              </div>
          </div>
          <div class="container">
              {% include "utils/pagination.html" %}
          </div>
      {% endif %}

  {% endwith %}
{% endblock %}
